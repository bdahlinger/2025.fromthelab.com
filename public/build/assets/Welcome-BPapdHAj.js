import{W as Tr,d as Kt,I as cs,e as Us,o as Dn,a as ho,t as Mr,x as Pr,y as Cr,b as Ho,w as Ws,c as Ys,f as Sr,T as Er,u as Ar,m as kr}from"./app-CWyExKpO.js";import{c as Be,O as Dr,e as ao,F as Xo,j as go,U as Qn,V as Le,k as Tn,H as Mn,N as Ir,C as Rr,l as Et,d as Ie,b as Zt,m as ut,E as Or,n as Xs,o as js,p as Mo,q as Lr,r as Br,s as zr,P as Hn,t as Nr,v as no,G as gt,w as Hr,a as Xt,L as Rt,g as Oe,x as Ze,B as Ro,y as jo,f as xt,u as Vs,R as Fr,z as Gr,I as Ur,J as oo,K as qs,Q as Zs,T as xs,X as Wr,Y as Yr,Z as Fn,_ as ws,$ as Xr,a0 as Gn,a1 as Un,a2 as jr,S as Vr,a3 as qr,a4 as Zr,W as $r,a5 as Qr,a6 as Kr,h as Jr,i as ei}from"./GlobalFooter-BuJI0Nr2.js";import{u as rn,_ as ti}from"./App.vue_vue_type_script_setup_true_lang-DVdm2pUE.js";import{_ as $s}from"./_plugin-vue_export-helper-DlAUqK2U.js";function oi(p,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(p,t.key,t)}}function ni(p,e,n){return e&&oi(p.prototype,e),p}/*!
 * Observer 3.12.7
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var wt,Pn,zt,ro,io,ko,Qs,fo,Vo,Ks,eo,jt,Js,er=function(){return wt||typeof window<"u"&&(wt=window.gsap)&&wt.registerPlugin&&wt},tr=1,Ao=[],Fe=[],Qt=[],qo=Date.now,Kn=function(e,n){return n},si=function(){var e=Vo.core,n=e.bridge||{},t=e._scrollers,o=e._proxies;t.push.apply(t,Fe),o.push.apply(o,Qt),Fe=t,Qt=o,Kn=function(l,f){return n[l](f)}},lo=function(e,n){return~Qt.indexOf(e)&&Qt[Qt.indexOf(e)+1][n]},Zo=function(e){return!!~Ks.indexOf(e)},Ct=function(e,n,t,o,s){return e.addEventListener(n,t,{passive:o!==!1,capture:!!s})},Pt=function(e,n,t,o){return e.removeEventListener(n,t,!!o)},un="scrollLeft",fn="scrollTop",Jn=function(){return eo&&eo.isPressed||Fe.cache++},In=function(e,n){var t=function o(s){if(s||s===0){tr&&(zt.history.scrollRestoration="manual");var l=eo&&eo.isPressed;s=o.v=Math.round(s)||(eo&&eo.iOS?1:0),e(s),o.cacheID=Fe.cache,l&&Kn("ss",s)}else(n||Fe.cache!==o.cacheID||Kn("ref"))&&(o.cacheID=Fe.cache,o.v=e());return o.v+o.offset};return t.offset=0,e&&t},Dt={s:un,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:In(function(p){return arguments.length?zt.scrollTo(p,ft.sc()):zt.pageXOffset||ro[un]||io[un]||ko[un]||0})},ft={s:fn,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:Dt,sc:In(function(p){return arguments.length?zt.scrollTo(Dt.sc(),p):zt.pageYOffset||ro[fn]||io[fn]||ko[fn]||0})},It=function(e,n){return(n&&n._ctx&&n._ctx.selector||wt.utils.toArray)(e)[0]||(typeof e=="string"&&wt.config().nullTargetWarn!==!1?console.warn("Element not found:",e):null)},co=function(e,n){var t=n.s,o=n.sc;Zo(e)&&(e=ro.scrollingElement||io);var s=Fe.indexOf(e),l=o===ft.sc?1:2;!~s&&(s=Fe.push(e)-1),Fe[s+l]||Ct(e,"scroll",Jn);var f=Fe[s+l],b=f||(Fe[s+l]=In(lo(e,t),!0)||(Zo(e)?o:In(function(R){return arguments.length?e[t]=R:e[t]})));return b.target=e,f||(b.smooth=wt.getProperty(e,"scrollBehavior")==="smooth"),b},es=function(e,n,t){var o=e,s=e,l=qo(),f=l,b=n||50,R=Math.max(500,b*3),U=function(_,M){var x=qo();M||x-l>b?(s=o,o=_,f=l,l=x):t?o+=_:o=s+(_-s)/(x-f)*(l-f)},A=function(){s=o=t?0:o,f=l=0},T=function(_){var M=f,x=s,z=qo();return(_||_===0)&&_!==o&&U(_),l===f||z-f>R?0:(o+(t?x:-x))/((t?z:l)-M)*1e3};return{update:U,reset:A,getVelocity:T}},Bo=function(e,n){return n&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},bs=function(e){var n=Math.max.apply(Math,e),t=Math.min.apply(Math,e);return Math.abs(n)>=Math.abs(t)?n:t},or=function(){Vo=wt.core.globals().ScrollTrigger,Vo&&Vo.core&&si()},nr=function(e){return wt=e||er(),!Pn&&wt&&typeof document<"u"&&document.body&&(zt=window,ro=document,io=ro.documentElement,ko=ro.body,Ks=[zt,ro,io,ko],wt.utils.clamp,Js=wt.core.context||function(){},fo="onpointerenter"in ko?"pointer":"mouse",Qs=rt.isTouch=zt.matchMedia&&zt.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in zt||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,jt=rt.eventTypes=("ontouchstart"in io?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in io?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return tr=0},500),or(),Pn=1),Pn};Dt.op=ft;Fe.cache=0;var rt=function(){function p(n){this.init(n)}var e=p.prototype;return e.init=function(t){Pn||nr(wt)||console.warn("Please gsap.registerPlugin(Observer)"),Vo||or();var o=t.tolerance,s=t.dragMinimum,l=t.type,f=t.target,b=t.lineHeight,R=t.debounce,U=t.preventDefault,A=t.onStop,T=t.onStopDelay,g=t.ignore,_=t.wheelSpeed,M=t.event,x=t.onDragStart,z=t.onDragEnd,K=t.onDrag,F=t.onPress,C=t.onRelease,V=t.onRight,$=t.onLeft,D=t.onUp,q=t.onDown,J=t.onChangeX,P=t.onChangeY,le=t.onChange,S=t.onToggleX,Z=t.onToggleY,de=t.onHover,ce=t.onHoverEnd,re=t.onMove,k=t.ignoreCheck,O=t.isNormalizer,ae=t.onGestureStart,u=t.onGestureEnd,fe=t.onWheel,he=t.onEnable,Me=t.onDisable,h=t.onClick,c=t.scrollSpeed,i=t.capture,r=t.allowClicks,w=t.lockAxis,E=t.onLockAxis;this.target=f=It(f)||io,this.vars=t,g&&(g=wt.utils.toArray(g)),o=o||1e-9,s=s||0,_=_||1,c=c||1,l=l||"wheel,touch,pointer",R=R!==!1,b||(b=parseFloat(zt.getComputedStyle(ko).lineHeight)||22);var y,L,Y,H,v,B,Q,d=this,m=0,a=0,oe=t.passive||!U&&t.passive!==!1,pe=co(f,Dt),Ge=co(f,ft),je=pe(),G=Ge(),ee=~l.indexOf("touch")&&!~l.indexOf("pointer")&&jt[0]==="pointerdown",we=Zo(f),se=f.ownerDocument||ro,ye=[0,0,0],ve=[0,0,0],Pe=0,ie=function(){return Pe=qo()},be=function(te,Ae){return(d.event=te)&&g&&~g.indexOf(te.target)||Ae&&ee&&te.pointerType!=="touch"||k&&k(te,Ae)},_e=function(){d._vx.reset(),d._vy.reset(),L.pause(),A&&A(d)},ue=function(){var te=d.deltaX=bs(ye),Ae=d.deltaY=bs(ve),N=Math.abs(te)>=o,j=Math.abs(Ae)>=o;le&&(N||j)&&le(d,te,Ae,ye,ve),N&&(V&&d.deltaX>0&&V(d),$&&d.deltaX<0&&$(d),J&&J(d),S&&d.deltaX<0!=m<0&&S(d),m=d.deltaX,ye[0]=ye[1]=ye[2]=0),j&&(q&&d.deltaY>0&&q(d),D&&d.deltaY<0&&D(d),P&&P(d),Z&&d.deltaY<0!=a<0&&Z(d),a=d.deltaY,ve[0]=ve[1]=ve[2]=0),(H||Y)&&(re&&re(d),Y&&(x&&Y===1&&x(d),K&&K(d),Y=0),H=!1),B&&!(B=!1)&&E&&E(d),v&&(fe(d),v=!1),y=0},Ce=function(te,Ae,N){ye[N]+=te,ve[N]+=Ae,d._vx.update(te),d._vy.update(Ae),R?y||(y=requestAnimationFrame(ue)):ue()},Ve=function(te,Ae){w&&!Q&&(d.axis=Q=Math.abs(te)>Math.abs(Ae)?"x":"y",B=!0),Q!=="y"&&(ye[2]+=te,d._vx.update(te,!0)),Q!=="x"&&(ve[2]+=Ae,d._vy.update(Ae,!0)),R?y||(y=requestAnimationFrame(ue)):ue()},xe=function(te){if(!be(te,1)){te=Bo(te,U);var Ae=te.clientX,N=te.clientY,j=Ae-d.x,W=N-d.y,X=d.isDragging;d.x=Ae,d.y=N,(X||(j||W)&&(Math.abs(d.startX-Ae)>=s||Math.abs(d.startY-N)>=s))&&(Y=X?2:1,X||(d.isDragging=!0),Ve(j,W))}},at=d.onPress=function(I){be(I,1)||I&&I.button||(d.axis=Q=null,L.pause(),d.isPressed=!0,I=Bo(I),m=a=0,d.startX=d.x=I.clientX,d.startY=d.y=I.clientY,d._vx.reset(),d._vy.reset(),Ct(O?f:se,jt[1],xe,oe,!0),d.deltaX=d.deltaY=0,F&&F(d))},ke=d.onRelease=function(I){if(!be(I,1)){Pt(O?f:se,jt[1],xe,!0);var te=!isNaN(d.y-d.startY),Ae=d.isDragging,N=Ae&&(Math.abs(d.x-d.startX)>3||Math.abs(d.y-d.startY)>3),j=Bo(I);!N&&te&&(d._vx.reset(),d._vy.reset(),U&&r&&wt.delayedCall(.08,function(){if(qo()-Pe>300&&!I.defaultPrevented){if(I.target.click)I.target.click();else if(se.createEvent){var W=se.createEvent("MouseEvents");W.initMouseEvent("click",!0,!0,zt,1,j.screenX,j.screenY,j.clientX,j.clientY,!1,!1,!1,!1,0,null),I.target.dispatchEvent(W)}}})),d.isDragging=d.isGesturing=d.isPressed=!1,A&&Ae&&!O&&L.restart(!0),Y&&ue(),z&&Ae&&z(d),C&&C(d,N)}},bt=function(te){return te.touches&&te.touches.length>1&&(d.isGesturing=!0)&&ae(te,d.isDragging)},nt=function(){return(d.isGesturing=!1)||u(d)},Ne=function(te){if(!be(te)){var Ae=pe(),N=Ge();Ce((Ae-je)*c,(N-G)*c,1),je=Ae,G=N,A&&L.restart(!0)}},Qe=function(te){if(!be(te)){te=Bo(te,U),fe&&(v=!0);var Ae=(te.deltaMode===1?b:te.deltaMode===2?zt.innerHeight:1)*_;Ce(te.deltaX*Ae,te.deltaY*Ae,0),A&&!O&&L.restart(!0)}},lt=function(te){if(!be(te)){var Ae=te.clientX,N=te.clientY,j=Ae-d.x,W=N-d.y;d.x=Ae,d.y=N,H=!0,A&&L.restart(!0),(j||W)&&Ve(j,W)}},Mt=function(te){d.event=te,de(d)},Ue=function(te){d.event=te,ce(d)},Wt=function(te){return be(te)||Bo(te,U)&&h(d)};L=d._dc=wt.delayedCall(T||.25,_e).pause(),d.deltaX=d.deltaY=0,d._vx=es(0,50,!0),d._vy=es(0,50,!0),d.scrollX=pe,d.scrollY=Ge,d.isDragging=d.isGesturing=d.isPressed=!1,Js(this),d.enable=function(I){return d.isEnabled||(Ct(we?se:f,"scroll",Jn),l.indexOf("scroll")>=0&&Ct(we?se:f,"scroll",Ne,oe,i),l.indexOf("wheel")>=0&&Ct(f,"wheel",Qe,oe,i),(l.indexOf("touch")>=0&&Qs||l.indexOf("pointer")>=0)&&(Ct(f,jt[0],at,oe,i),Ct(se,jt[2],ke),Ct(se,jt[3],ke),r&&Ct(f,"click",ie,!0,!0),h&&Ct(f,"click",Wt),ae&&Ct(se,"gesturestart",bt),u&&Ct(se,"gestureend",nt),de&&Ct(f,fo+"enter",Mt),ce&&Ct(f,fo+"leave",Ue),re&&Ct(f,fo+"move",lt)),d.isEnabled=!0,d.isDragging=d.isGesturing=d.isPressed=H=Y=!1,d._vx.reset(),d._vy.reset(),je=pe(),G=Ge(),I&&I.type&&at(I),he&&he(d)),d},d.disable=function(){d.isEnabled&&(Ao.filter(function(I){return I!==d&&Zo(I.target)}).length||Pt(we?se:f,"scroll",Jn),d.isPressed&&(d._vx.reset(),d._vy.reset(),Pt(O?f:se,jt[1],xe,!0)),Pt(we?se:f,"scroll",Ne,i),Pt(f,"wheel",Qe,i),Pt(f,jt[0],at,i),Pt(se,jt[2],ke),Pt(se,jt[3],ke),Pt(f,"click",ie,!0),Pt(f,"click",Wt),Pt(se,"gesturestart",bt),Pt(se,"gestureend",nt),Pt(f,fo+"enter",Mt),Pt(f,fo+"leave",Ue),Pt(f,fo+"move",lt),d.isEnabled=d.isPressed=d.isDragging=!1,Me&&Me(d))},d.kill=d.revert=function(){d.disable();var I=Ao.indexOf(d);I>=0&&Ao.splice(I,1),eo===d&&(eo=0)},Ao.push(d),O&&Zo(f)&&(eo=d),d.enable(M)},ni(p,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),p}();rt.version="3.12.7";rt.create=function(p){return new rt(p)};rt.register=nr;rt.getAll=function(){return Ao.slice()};rt.getById=function(p){return Ao.filter(function(e){return e.vars.id===p})[0]};er()&&wt.registerPlugin(rt);/*!
 * ScrollTrigger 3.12.7
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var me,So,He,tt,Bt,$e,us,Rn,nn,$o,Fo,pn,_t,Nn,ts,At,_s,vs,Eo,sr,Wn,rr,St,os,ir,ar,so,ns,fs,Do,ps,On,ss,Yn,dn=1,vt=Date.now,Xn=vt(),Ut=0,Go=0,Ts=function(e,n,t){var o=Lt(e)&&(e.substr(0,6)==="clamp("||e.indexOf("max")>-1);return t["_"+n+"Clamp"]=o,o?e.substr(6,e.length-7):e},Ms=function(e,n){return n&&(!Lt(e)||e.substr(0,6)!=="clamp(")?"clamp("+e+")":e},ri=function p(){return Go&&requestAnimationFrame(p)},Ps=function(){return Nn=1},Cs=function(){return Nn=0},qt=function(e){return e},Uo=function(e){return Math.round(e*1e5)/1e5||0},lr=function(){return typeof window<"u"},cr=function(){return me||lr()&&(me=window.gsap)&&me.registerPlugin&&me},bo=function(e){return!!~us.indexOf(e)},ur=function(e){return(e==="Height"?ps:He["inner"+e])||Bt["client"+e]||$e["client"+e]},fr=function(e){return lo(e,"getBoundingClientRect")||(bo(e)?function(){return kn.width=He.innerWidth,kn.height=ps,kn}:function(){return Jt(e)})},ii=function(e,n,t){var o=t.d,s=t.d2,l=t.a;return(l=lo(e,"getBoundingClientRect"))?function(){return l()[o]}:function(){return(n?ur(s):e["client"+s])||0}},ai=function(e,n){return!n||~Qt.indexOf(e)?fr(e):function(){return kn}},$t=function(e,n){var t=n.s,o=n.d2,s=n.d,l=n.a;return Math.max(0,(t="scroll"+o)&&(l=lo(e,t))?l()-fr(e)()[s]:bo(e)?(Bt[t]||$e[t])-ur(o):e[t]-e["offset"+o])},hn=function(e,n){for(var t=0;t<Eo.length;t+=3)(!n||~n.indexOf(Eo[t+1]))&&e(Eo[t],Eo[t+1],Eo[t+2])},Lt=function(e){return typeof e=="string"},Tt=function(e){return typeof e=="function"},Wo=function(e){return typeof e=="number"},po=function(e){return typeof e=="object"},zo=function(e,n,t){return e&&e.progress(n?0:1)&&t&&e.pause()},jn=function(e,n){if(e.enabled){var t=e._ctx?e._ctx.add(function(){return n(e)}):n(e);t&&t.totalTime&&(e.callbackAnimation=t)}},Po=Math.abs,pr="left",dr="top",ds="right",hs="bottom",yo="width",xo="height",Qo="Right",Ko="Left",Jo="Top",en="Bottom",it="padding",Ft="margin",Oo="Width",gs="Height",ct="px",Gt=function(e){return He.getComputedStyle(e)},li=function(e){var n=Gt(e).position;e.style.position=n==="absolute"||n==="fixed"?n:"relative"},Ss=function(e,n){for(var t in n)t in e||(e[t]=n[t]);return e},Jt=function(e,n){var t=n&&Gt(e)[ts]!=="matrix(1, 0, 0, 1, 0, 0)"&&me.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),o=e.getBoundingClientRect();return t&&t.progress(0).kill(),o},Ln=function(e,n){var t=n.d2;return e["offset"+t]||e["client"+t]||0},hr=function(e){var n=[],t=e.labels,o=e.duration(),s;for(s in t)n.push(t[s]/o);return n},ci=function(e){return function(n){return me.utils.snap(hr(e),n)}},ms=function(e){var n=me.utils.snap(e),t=Array.isArray(e)&&e.slice(0).sort(function(o,s){return o-s});return t?function(o,s,l){l===void 0&&(l=.001);var f;if(!s)return n(o);if(s>0){for(o-=l,f=0;f<t.length;f++)if(t[f]>=o)return t[f];return t[f-1]}else for(f=t.length,o+=l;f--;)if(t[f]<=o)return t[f];return t[0]}:function(o,s,l){l===void 0&&(l=.001);var f=n(o);return!s||Math.abs(f-o)<l||f-o<0==s<0?f:n(s<0?o-e:o+e)}},ui=function(e){return function(n,t){return ms(hr(e))(n,t.direction)}},gn=function(e,n,t,o){return t.split(",").forEach(function(s){return e(n,s,o)})},ht=function(e,n,t,o,s){return e.addEventListener(n,t,{passive:!o,capture:!!s})},dt=function(e,n,t,o){return e.removeEventListener(n,t,!!o)},mn=function(e,n,t){t=t&&t.wheelHandler,t&&(e(n,"wheel",t),e(n,"touchmove",t))},Es={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},yn={toggleActions:"play",anticipatePin:0},Bn={top:0,left:0,center:.5,bottom:1,right:1},Cn=function(e,n){if(Lt(e)){var t=e.indexOf("="),o=~t?+(e.charAt(t-1)+1)*parseFloat(e.substr(t+1)):0;~t&&(e.indexOf("%")>t&&(o*=n/100),e=e.substr(0,t-1)),e=o+(e in Bn?Bn[e]*n:~e.indexOf("%")?parseFloat(e)*n/100:parseFloat(e)||0)}return e},xn=function(e,n,t,o,s,l,f,b){var R=s.startColor,U=s.endColor,A=s.fontSize,T=s.indent,g=s.fontWeight,_=tt.createElement("div"),M=bo(t)||lo(t,"pinType")==="fixed",x=e.indexOf("scroller")!==-1,z=M?$e:t,K=e.indexOf("start")!==-1,F=K?R:U,C="border-color:"+F+";font-size:"+A+";color:"+F+";font-weight:"+g+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return C+="position:"+((x||b)&&M?"fixed;":"absolute;"),(x||b||!M)&&(C+=(o===ft?ds:hs)+":"+(l+parseFloat(T))+"px;"),f&&(C+="box-sizing:border-box;text-align:left;width:"+f.offsetWidth+"px;"),_._isStart=K,_.setAttribute("class","gsap-marker-"+e+(n?" marker-"+n:"")),_.style.cssText=C,_.innerText=n||n===0?e+"-"+n:e,z.children[0]?z.insertBefore(_,z.children[0]):z.appendChild(_),_._offset=_["offset"+o.op.d2],Sn(_,0,o,K),_},Sn=function(e,n,t,o){var s={display:"block"},l=t[o?"os2":"p2"],f=t[o?"p2":"os2"];e._isFlipped=o,s[t.a+"Percent"]=o?-100:0,s[t.a]=o?"1px":0,s["border"+l+Oo]=1,s["border"+f+Oo]=0,s[t.p]=n+"px",me.set(e,s)},ze=[],rs={},sn,As=function(){return vt()-Ut>34&&(sn||(sn=requestAnimationFrame(to)))},Co=function(){(!St||!St.isPressed||St.startX>$e.clientWidth)&&(Fe.cache++,St?sn||(sn=requestAnimationFrame(to)):to(),Ut||vo("scrollStart"),Ut=vt())},Vn=function(){ar=He.innerWidth,ir=He.innerHeight},Yo=function(e){Fe.cache++,(e===!0||!_t&&!rr&&!tt.fullscreenElement&&!tt.webkitFullscreenElement&&(!os||ar!==He.innerWidth||Math.abs(He.innerHeight-ir)>He.innerHeight*.25))&&Rn.restart(!0)},_o={},fi=[],gr=function p(){return dt(Re,"scrollEnd",p)||mo(!0)},vo=function(e){return _o[e]&&_o[e].map(function(n){return n()})||fi},Ot=[],mr=function(e){for(var n=0;n<Ot.length;n+=5)(!e||Ot[n+4]&&Ot[n+4].query===e)&&(Ot[n].style.cssText=Ot[n+1],Ot[n].getBBox&&Ot[n].setAttribute("transform",Ot[n+2]||""),Ot[n+3].uncache=1)},ys=function(e,n){var t;for(At=0;At<ze.length;At++)t=ze[At],t&&(!n||t._ctx===n)&&(e?t.kill(1):t.revert(!0,!0));On=!0,n&&mr(n),n||vo("revert")},yr=function(e,n){Fe.cache++,(n||!kt)&&Fe.forEach(function(t){return Tt(t)&&t.cacheID++&&(t.rec=0)}),Lt(e)&&(He.history.scrollRestoration=fs=e)},kt,wo=0,ks,pi=function(){if(ks!==wo){var e=ks=wo;requestAnimationFrame(function(){return e===wo&&mo(!0)})}},xr=function(){$e.appendChild(Do),ps=!St&&Do.offsetHeight||He.innerHeight,$e.removeChild(Do)},Ds=function(e){return nn(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(n){return n.style.display=e?"none":"block"})},mo=function(e,n){if(Bt=tt.documentElement,$e=tt.body,us=[He,tt,Bt,$e],Ut&&!e&&!On){ht(Re,"scrollEnd",gr);return}xr(),kt=Re.isRefreshing=!0,Fe.forEach(function(o){return Tt(o)&&++o.cacheID&&(o.rec=o())});var t=vo("refreshInit");sr&&Re.sort(),n||ys(),Fe.forEach(function(o){Tt(o)&&(o.smooth&&(o.target.style.scrollBehavior="auto"),o(0))}),ze.slice(0).forEach(function(o){return o.refresh()}),On=!1,ze.forEach(function(o){if(o._subPinOffset&&o.pin){var s=o.vars.horizontal?"offsetWidth":"offsetHeight",l=o.pin[s];o.revert(!0,1),o.adjustPinSpacing(o.pin[s]-l),o.refresh()}}),ss=1,Ds(!0),ze.forEach(function(o){var s=$t(o.scroller,o._dir),l=o.vars.end==="max"||o._endClamp&&o.end>s,f=o._startClamp&&o.start>=s;(l||f)&&o.setPositions(f?s-1:o.start,l?Math.max(f?s:o.start+1,s):o.end,!0)}),Ds(!1),ss=0,t.forEach(function(o){return o&&o.render&&o.render(-1)}),Fe.forEach(function(o){Tt(o)&&(o.smooth&&requestAnimationFrame(function(){return o.target.style.scrollBehavior="smooth"}),o.rec&&o(o.rec))}),yr(fs,1),Rn.pause(),wo++,kt=2,to(2),ze.forEach(function(o){return Tt(o.vars.onRefresh)&&o.vars.onRefresh(o)}),kt=Re.isRefreshing=!1,vo("refresh")},is=0,En=1,tn,to=function(e){if(e===2||!kt&&!On){Re.isUpdating=!0,tn&&tn.update(0);var n=ze.length,t=vt(),o=t-Xn>=50,s=n&&ze[0].scroll();if(En=is>s?-1:1,kt||(is=s),o&&(Ut&&!Nn&&t-Ut>200&&(Ut=0,vo("scrollEnd")),Fo=Xn,Xn=t),En<0){for(At=n;At-- >0;)ze[At]&&ze[At].update(0,o);En=1}else for(At=0;At<n;At++)ze[At]&&ze[At].update(0,o);Re.isUpdating=!1}sn=0},as=[pr,dr,hs,ds,Ft+en,Ft+Qo,Ft+Jo,Ft+Ko,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],An=as.concat([yo,xo,"boxSizing","max"+Oo,"max"+gs,"position",Ft,it,it+Jo,it+Qo,it+en,it+Ko]),di=function(e,n,t){Io(t);var o=e._gsap;if(o.spacerIsNative)Io(o.spacerState);else if(e._gsap.swappedIn){var s=n.parentNode;s&&(s.insertBefore(e,n),s.removeChild(n))}e._gsap.swappedIn=!1},qn=function(e,n,t,o){if(!e._gsap.swappedIn){for(var s=as.length,l=n.style,f=e.style,b;s--;)b=as[s],l[b]=t[b];l.position=t.position==="absolute"?"absolute":"relative",t.display==="inline"&&(l.display="inline-block"),f[hs]=f[ds]="auto",l.flexBasis=t.flexBasis||"auto",l.overflow="visible",l.boxSizing="border-box",l[yo]=Ln(e,Dt)+ct,l[xo]=Ln(e,ft)+ct,l[it]=f[Ft]=f[dr]=f[pr]="0",Io(o),f[yo]=f["max"+Oo]=t[yo],f[xo]=f["max"+gs]=t[xo],f[it]=t[it],e.parentNode!==n&&(e.parentNode.insertBefore(n,e),n.appendChild(e)),e._gsap.swappedIn=!0}},hi=/([A-Z])/g,Io=function(e){if(e){var n=e.t.style,t=e.length,o=0,s,l;for((e.t._gsap||me.core.getCache(e.t)).uncache=1;o<t;o+=2)l=e[o+1],s=e[o],l?n[s]=l:n[s]&&n.removeProperty(s.replace(hi,"-$1").toLowerCase())}},wn=function(e){for(var n=An.length,t=e.style,o=[],s=0;s<n;s++)o.push(An[s],t[An[s]]);return o.t=e,o},gi=function(e,n,t){for(var o=[],s=e.length,l=t?8:0,f;l<s;l+=2)f=e[l],o.push(f,f in n?n[f]:e[l+1]);return o.t=e.t,o},kn={left:0,top:0},Is=function(e,n,t,o,s,l,f,b,R,U,A,T,g,_){Tt(e)&&(e=e(b)),Lt(e)&&e.substr(0,3)==="max"&&(e=T+(e.charAt(4)==="="?Cn("0"+e.substr(3),t):0));var M=g?g.time():0,x,z,K;if(g&&g.seek(0),isNaN(e)||(e=+e),Wo(e))g&&(e=me.utils.mapRange(g.scrollTrigger.start,g.scrollTrigger.end,0,T,e)),f&&Sn(f,t,o,!0);else{Tt(n)&&(n=n(b));var F=(e||"0").split(" "),C,V,$,D;K=It(n,b)||$e,C=Jt(K)||{},(!C||!C.left&&!C.top)&&Gt(K).display==="none"&&(D=K.style.display,K.style.display="block",C=Jt(K),D?K.style.display=D:K.style.removeProperty("display")),V=Cn(F[0],C[o.d]),$=Cn(F[1]||"0",t),e=C[o.p]-R[o.p]-U+V+s-$,f&&Sn(f,$,o,t-$<20||f._isStart&&$>20),t-=t-$}if(_&&(b[_]=e||-.001,e<0&&(e=0)),l){var q=e+t,J=l._isStart;x="scroll"+o.d2,Sn(l,q,o,J&&q>20||!J&&(A?Math.max($e[x],Bt[x]):l.parentNode[x])<=q+1),A&&(R=Jt(f),A&&(l.style[o.op.p]=R[o.op.p]-o.op.m-l._offset+ct))}return g&&K&&(x=Jt(K),g.seek(T),z=Jt(K),g._caScrollDist=x[o.p]-z[o.p],e=e/g._caScrollDist*T),g&&g.seek(M),g?e:Math.round(e)},mi=/(webkit|moz|length|cssText|inset)/i,Rs=function(e,n,t,o){if(e.parentNode!==n){var s=e.style,l,f;if(n===$e){e._stOrig=s.cssText,f=Gt(e);for(l in f)!+l&&!mi.test(l)&&f[l]&&typeof s[l]=="string"&&l!=="0"&&(s[l]=f[l]);s.top=t,s.left=o}else s.cssText=e._stOrig;me.core.getCache(e).uncache=1,n.appendChild(e)}},wr=function(e,n,t){var o=n,s=o;return function(l){var f=Math.round(e());return f!==o&&f!==s&&Math.abs(f-o)>3&&Math.abs(f-s)>3&&(l=f,t&&t()),s=o,o=Math.round(l),o}},bn=function(e,n,t){var o={};o[n.p]="+="+t,me.set(e,o)},Os=function(e,n){var t=co(e,n),o="_scroll"+n.p2,s=function l(f,b,R,U,A){var T=l.tween,g=b.onComplete,_={};R=R||t();var M=wr(t,R,function(){T.kill(),l.tween=0});return A=U&&A||0,U=U||f-R,T&&T.kill(),b[o]=f,b.inherit=!1,b.modifiers=_,_[o]=function(){return M(R+U*T.ratio+A*T.ratio*T.ratio)},b.onUpdate=function(){Fe.cache++,l.tween&&to()},b.onComplete=function(){l.tween=0,g&&g.call(T)},T=l.tween=me.to(e,b),T};return e[o]=t,t.wheelHandler=function(){return s.tween&&s.tween.kill()&&(s.tween=0)},ht(e,"wheel",t.wheelHandler),Re.isTouch&&ht(e,"touchmove",t.wheelHandler),s},Re=function(){function p(n,t){So||p.register(me)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),ns(this),this.init(n,t)}var e=p.prototype;return e.init=function(t,o){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!Go){this.update=this.refresh=this.kill=qt;return}t=Ss(Lt(t)||Wo(t)||t.nodeType?{trigger:t}:t,yn);var s=t,l=s.onUpdate,f=s.toggleClass,b=s.id,R=s.onToggle,U=s.onRefresh,A=s.scrub,T=s.trigger,g=s.pin,_=s.pinSpacing,M=s.invalidateOnRefresh,x=s.anticipatePin,z=s.onScrubComplete,K=s.onSnapComplete,F=s.once,C=s.snap,V=s.pinReparent,$=s.pinSpacer,D=s.containerAnimation,q=s.fastScrollEnd,J=s.preventOverlaps,P=t.horizontal||t.containerAnimation&&t.horizontal!==!1?Dt:ft,le=!A&&A!==0,S=It(t.scroller||He),Z=me.core.getCache(S),de=bo(S),ce=("pinType"in t?t.pinType:lo(S,"pinType")||de&&"fixed")==="fixed",re=[t.onEnter,t.onLeave,t.onEnterBack,t.onLeaveBack],k=le&&t.toggleActions.split(" "),O="markers"in t?t.markers:yn.markers,ae=de?0:parseFloat(Gt(S)["border"+P.p2+Oo])||0,u=this,fe=t.onRefreshInit&&function(){return t.onRefreshInit(u)},he=ii(S,de,P),Me=ai(S,de),h=0,c=0,i=0,r=co(S,P),w,E,y,L,Y,H,v,B,Q,d,m,a,oe,pe,Ge,je,G,ee,we,se,ye,ve,Pe,ie,be,_e,ue,Ce,Ve,xe,at,ke,bt,nt,Ne,Qe,lt,Mt,Ue;if(u._startClamp=u._endClamp=!1,u._dir=P,x*=45,u.scroller=S,u.scroll=D?D.time.bind(D):r,L=r(),u.vars=t,o=o||t.animation,"refreshPriority"in t&&(sr=1,t.refreshPriority===-9999&&(tn=u)),Z.tweenScroll=Z.tweenScroll||{top:Os(S,ft),left:Os(S,Dt)},u.tweenTo=w=Z.tweenScroll[P.p],u.scrubDuration=function(N){bt=Wo(N)&&N,bt?ke?ke.duration(N):ke=me.to(o,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:bt,paused:!0,onComplete:function(){return z&&z(u)}}):(ke&&ke.progress(1).kill(),ke=0)},o&&(o.vars.lazy=!1,o._initted&&!u.isReverted||o.vars.immediateRender!==!1&&t.immediateRender!==!1&&o.duration()&&o.render(0,!0,!0),u.animation=o.pause(),o.scrollTrigger=u,u.scrubDuration(A),xe=0,b||(b=o.vars.id)),C&&((!po(C)||C.push)&&(C={snapTo:C}),"scrollBehavior"in $e.style&&me.set(de?[$e,Bt]:S,{scrollBehavior:"auto"}),Fe.forEach(function(N){return Tt(N)&&N.target===(de?tt.scrollingElement||Bt:S)&&(N.smooth=!1)}),y=Tt(C.snapTo)?C.snapTo:C.snapTo==="labels"?ci(o):C.snapTo==="labelsDirectional"?ui(o):C.directional!==!1?function(N,j){return ms(C.snapTo)(N,vt()-c<500?0:j.direction)}:me.utils.snap(C.snapTo),nt=C.duration||{min:.1,max:2},nt=po(nt)?$o(nt.min,nt.max):$o(nt,nt),Ne=me.delayedCall(C.delay||bt/2||.1,function(){var N=r(),j=vt()-c<500,W=w.tween;if((j||Math.abs(u.getVelocity())<10)&&!W&&!Nn&&h!==N){var X=(N-H)/pe,Se=o&&!le?o.totalProgress():X,ge=j?0:(Se-at)/(vt()-Fo)*1e3||0,ne=me.utils.clamp(-X,1-X,Po(ge/2)*ge/.185),Ee=X+(C.inertia===!1?0:ne),Te,De,Ye=C,mt=Ye.onStart,ot=Ye.onInterrupt,pt=Ye.onComplete;if(Te=y(Ee,u),Wo(Te)||(Te=Ee),De=Math.max(0,Math.round(H+Te*pe)),N<=v&&N>=H&&De!==N){if(W&&!W._initted&&W.data<=Po(De-N))return;C.inertia===!1&&(ne=Te-X),w(De,{duration:nt(Po(Math.max(Po(Ee-Se),Po(Te-Se))*.185/ge/.05||0)),ease:C.ease||"power3",data:Po(De-N),onInterrupt:function(){return Ne.restart(!0)&&ot&&ot(u)},onComplete:function(){u.update(),h=r(),o&&!le&&(ke?ke.resetTo("totalProgress",Te,o._tTime/o._tDur):o.progress(Te)),xe=at=o&&!le?o.totalProgress():u.progress,K&&K(u),pt&&pt(u)}},N,ne*pe,De-N-ne*pe),mt&&mt(u,w.tween)}}else u.isActive&&h!==N&&Ne.restart(!0)}).pause()),b&&(rs[b]=u),T=u.trigger=It(T||g!==!0&&g),Ue=T&&T._gsap&&T._gsap.stRevert,Ue&&(Ue=Ue(u)),g=g===!0?T:It(g),Lt(f)&&(f={targets:T,className:f}),g&&(_===!1||_===Ft||(_=!_&&g.parentNode&&g.parentNode.style&&Gt(g.parentNode).display==="flex"?!1:it),u.pin=g,E=me.core.getCache(g),E.spacer?Ge=E.pinState:($&&($=It($),$&&!$.nodeType&&($=$.current||$.nativeElement),E.spacerIsNative=!!$,$&&(E.spacerState=wn($))),E.spacer=ee=$||tt.createElement("div"),ee.classList.add("pin-spacer"),b&&ee.classList.add("pin-spacer-"+b),E.pinState=Ge=wn(g)),t.force3D!==!1&&me.set(g,{force3D:!0}),u.spacer=ee=E.spacer,Ve=Gt(g),ie=Ve[_+P.os2],se=me.getProperty(g),ye=me.quickSetter(g,P.a,ct),qn(g,ee,Ve),G=wn(g)),O){a=po(O)?Ss(O,Es):Es,d=xn("scroller-start",b,S,P,a,0),m=xn("scroller-end",b,S,P,a,0,d),we=d["offset"+P.op.d2];var Wt=It(lo(S,"content")||S);B=this.markerStart=xn("start",b,Wt,P,a,we,0,D),Q=this.markerEnd=xn("end",b,Wt,P,a,we,0,D),D&&(Mt=me.quickSetter([B,Q],P.a,ct)),!ce&&!(Qt.length&&lo(S,"fixedMarkers")===!0)&&(li(de?$e:S),me.set([d,m],{force3D:!0}),_e=me.quickSetter(d,P.a,ct),Ce=me.quickSetter(m,P.a,ct))}if(D){var I=D.vars.onUpdate,te=D.vars.onUpdateParams;D.eventCallback("onUpdate",function(){u.update(0,0,1),I&&I.apply(D,te||[])})}if(u.previous=function(){return ze[ze.indexOf(u)-1]},u.next=function(){return ze[ze.indexOf(u)+1]},u.revert=function(N,j){if(!j)return u.kill(!0);var W=N!==!1||!u.enabled,X=_t;W!==u.isReverted&&(W&&(Qe=Math.max(r(),u.scroll.rec||0),i=u.progress,lt=o&&o.progress()),B&&[B,Q,d,m].forEach(function(Se){return Se.style.display=W?"none":"block"}),W&&(_t=u,u.update(W)),g&&(!V||!u.isActive)&&(W?di(g,ee,Ge):qn(g,ee,Gt(g),be)),W||u.update(W),_t=X,u.isReverted=W)},u.refresh=function(N,j,W,X){if(!((_t||!u.enabled)&&!j)){if(g&&N&&Ut){ht(p,"scrollEnd",gr);return}!kt&&fe&&fe(u),_t=u,w.tween&&!W&&(w.tween.kill(),w.tween=0),ke&&ke.pause(),M&&o&&o.revert({kill:!1}).invalidate(),u.isReverted||u.revert(!0,!0),u._subPinOffset=!1;var Se=he(),ge=Me(),ne=D?D.duration():$t(S,P),Ee=pe<=.01,Te=0,De=X||0,Ye=po(W)?W.end:t.end,mt=t.endTrigger||T,ot=po(W)?W.start:t.start||(t.start===0||!T?0:g?"0 0":"0 100%"),pt=u.pinnedContainer=t.pinnedContainer&&It(t.pinnedContainer,u),st=T&&Math.max(0,ze.indexOf(u))||0,Ke=st,We,et,qe,Vt,Xe,Je,yt,Yt,ln,uo,Nt,Ht,cn;for(O&&po(W)&&(Ht=me.getProperty(d,P.p),cn=me.getProperty(m,P.p));Ke-- >0;)Je=ze[Ke],Je.end||Je.refresh(0,1)||(_t=u),yt=Je.pin,yt&&(yt===T||yt===g||yt===pt)&&!Je.isReverted&&(uo||(uo=[]),uo.unshift(Je),Je.revert(!0,!0)),Je!==ze[Ke]&&(st--,Ke--);for(Tt(ot)&&(ot=ot(u)),ot=Ts(ot,"start",u),H=Is(ot,T,Se,P,r(),B,d,u,ge,ae,ce,ne,D,u._startClamp&&"_startClamp")||(g?-.001:0),Tt(Ye)&&(Ye=Ye(u)),Lt(Ye)&&!Ye.indexOf("+=")&&(~Ye.indexOf(" ")?Ye=(Lt(ot)?ot.split(" ")[0]:"")+Ye:(Te=Cn(Ye.substr(2),Se),Ye=Lt(ot)?ot:(D?me.utils.mapRange(0,D.duration(),D.scrollTrigger.start,D.scrollTrigger.end,H):H)+Te,mt=T)),Ye=Ts(Ye,"end",u),v=Math.max(H,Is(Ye||(mt?"100% 0":ne),mt,Se,P,r()+Te,Q,m,u,ge,ae,ce,ne,D,u._endClamp&&"_endClamp"))||-.001,Te=0,Ke=st;Ke--;)Je=ze[Ke],yt=Je.pin,yt&&Je.start-Je._pinPush<=H&&!D&&Je.end>0&&(We=Je.end-(u._startClamp?Math.max(0,Je.start):Je.start),(yt===T&&Je.start-Je._pinPush<H||yt===pt)&&isNaN(ot)&&(Te+=We*(1-Je.progress)),yt===g&&(De+=We));if(H+=Te,v+=Te,u._startClamp&&(u._startClamp+=Te),u._endClamp&&!kt&&(u._endClamp=v||-.001,v=Math.min(v,$t(S,P))),pe=v-H||(H-=.01)&&.001,Ee&&(i=me.utils.clamp(0,1,me.utils.normalize(H,v,Qe))),u._pinPush=De,B&&Te&&(We={},We[P.a]="+="+Te,pt&&(We[P.p]="-="+r()),me.set([B,Q],We)),g&&!(ss&&u.end>=$t(S,P)))We=Gt(g),Vt=P===ft,qe=r(),ve=parseFloat(se(P.a))+De,!ne&&v>1&&(Nt=(de?tt.scrollingElement||Bt:S).style,Nt={style:Nt,value:Nt["overflow"+P.a.toUpperCase()]},de&&Gt($e)["overflow"+P.a.toUpperCase()]!=="scroll"&&(Nt.style["overflow"+P.a.toUpperCase()]="scroll")),qn(g,ee,We),G=wn(g),et=Jt(g,!0),Yt=ce&&co(S,Vt?Dt:ft)(),_?(be=[_+P.os2,pe+De+ct],be.t=ee,Ke=_===it?Ln(g,P)+pe+De:0,Ke&&(be.push(P.d,Ke+ct),ee.style.flexBasis!=="auto"&&(ee.style.flexBasis=Ke+ct)),Io(be),pt&&ze.forEach(function(Lo){Lo.pin===pt&&Lo.vars.pinSpacing!==!1&&(Lo._subPinOffset=!0)}),ce&&r(Qe)):(Ke=Ln(g,P),Ke&&ee.style.flexBasis!=="auto"&&(ee.style.flexBasis=Ke+ct)),ce&&(Xe={top:et.top+(Vt?qe-H:Yt)+ct,left:et.left+(Vt?Yt:qe-H)+ct,boxSizing:"border-box",position:"fixed"},Xe[yo]=Xe["max"+Oo]=Math.ceil(et.width)+ct,Xe[xo]=Xe["max"+gs]=Math.ceil(et.height)+ct,Xe[Ft]=Xe[Ft+Jo]=Xe[Ft+Qo]=Xe[Ft+en]=Xe[Ft+Ko]="0",Xe[it]=We[it],Xe[it+Jo]=We[it+Jo],Xe[it+Qo]=We[it+Qo],Xe[it+en]=We[it+en],Xe[it+Ko]=We[it+Ko],je=gi(Ge,Xe,V),kt&&r(0)),o?(ln=o._initted,Wn(1),o.render(o.duration(),!0,!0),Pe=se(P.a)-ve+pe+De,ue=Math.abs(pe-Pe)>1,ce&&ue&&je.splice(je.length-2,2),o.render(0,!0,!0),ln||o.invalidate(!0),o.parent||o.totalTime(o.totalTime()),Wn(0)):Pe=pe,Nt&&(Nt.value?Nt.style["overflow"+P.a.toUpperCase()]=Nt.value:Nt.style.removeProperty("overflow-"+P.a));else if(T&&r()&&!D)for(et=T.parentNode;et&&et!==$e;)et._pinOffset&&(H-=et._pinOffset,v-=et._pinOffset),et=et.parentNode;uo&&uo.forEach(function(Lo){return Lo.revert(!1,!0)}),u.start=H,u.end=v,L=Y=kt?Qe:r(),!D&&!kt&&(L<Qe&&r(Qe),u.scroll.rec=0),u.revert(!1,!0),c=vt(),Ne&&(h=-1,Ne.restart(!0)),_t=0,o&&le&&(o._initted||lt)&&o.progress()!==lt&&o.progress(lt||0,!0).render(o.time(),!0,!0),(Ee||i!==u.progress||D||M||o&&!o._initted)&&(o&&!le&&o.totalProgress(D&&H<-.001&&!i?me.utils.normalize(H,v,0):i,!0),u.progress=Ee||(L-H)/pe===i?0:i),g&&_&&(ee._pinOffset=Math.round(u.progress*Pe)),ke&&ke.invalidate(),isNaN(Ht)||(Ht-=me.getProperty(d,P.p),cn-=me.getProperty(m,P.p),bn(d,P,Ht),bn(B,P,Ht-(X||0)),bn(m,P,cn),bn(Q,P,cn-(X||0))),Ee&&!kt&&u.update(),U&&!kt&&!oe&&(oe=!0,U(u),oe=!1)}},u.getVelocity=function(){return(r()-Y)/(vt()-Fo)*1e3||0},u.endAnimation=function(){zo(u.callbackAnimation),o&&(ke?ke.progress(1):o.paused()?le||zo(o,u.direction<0,1):zo(o,o.reversed()))},u.labelToScroll=function(N){return o&&o.labels&&(H||u.refresh()||H)+o.labels[N]/o.duration()*pe||0},u.getTrailing=function(N){var j=ze.indexOf(u),W=u.direction>0?ze.slice(0,j).reverse():ze.slice(j+1);return(Lt(N)?W.filter(function(X){return X.vars.preventOverlaps===N}):W).filter(function(X){return u.direction>0?X.end<=H:X.start>=v})},u.update=function(N,j,W){if(!(D&&!W&&!N)){var X=kt===!0?Qe:u.scroll(),Se=N?0:(X-H)/pe,ge=Se<0?0:Se>1?1:Se||0,ne=u.progress,Ee,Te,De,Ye,mt,ot,pt,st;if(j&&(Y=L,L=D?r():X,C&&(at=xe,xe=o&&!le?o.totalProgress():ge)),x&&g&&!_t&&!dn&&Ut&&(!ge&&H<X+(X-Y)/(vt()-Fo)*x?ge=1e-4:ge===1&&v>X+(X-Y)/(vt()-Fo)*x&&(ge=.9999)),ge!==ne&&u.enabled){if(Ee=u.isActive=!!ge&&ge<1,Te=!!ne&&ne<1,ot=Ee!==Te,mt=ot||!!ge!=!!ne,u.direction=ge>ne?1:-1,u.progress=ge,mt&&!_t&&(De=ge&&!ne?0:ge===1?1:ne===1?2:3,le&&(Ye=!ot&&k[De+1]!=="none"&&k[De+1]||k[De],st=o&&(Ye==="complete"||Ye==="reset"||Ye in o))),J&&(ot||st)&&(st||A||!o)&&(Tt(J)?J(u):u.getTrailing(J).forEach(function(qe){return qe.endAnimation()})),le||(ke&&!_t&&!dn?(ke._dp._time-ke._start!==ke._time&&ke.render(ke._dp._time-ke._start),ke.resetTo?ke.resetTo("totalProgress",ge,o._tTime/o._tDur):(ke.vars.totalProgress=ge,ke.invalidate().restart())):o&&o.totalProgress(ge,!!(_t&&(c||N)))),g){if(N&&_&&(ee.style[_+P.os2]=ie),!ce)ye(Uo(ve+Pe*ge));else if(mt){if(pt=!N&&ge>ne&&v+1>X&&X+1>=$t(S,P),V)if(!N&&(Ee||pt)){var Ke=Jt(g,!0),We=X-H;Rs(g,$e,Ke.top+(P===ft?We:0)+ct,Ke.left+(P===ft?0:We)+ct)}else Rs(g,ee);Io(Ee||pt?je:G),ue&&ge<1&&Ee||ye(ve+(ge===1&&!pt?Pe:0))}}C&&!w.tween&&!_t&&!dn&&Ne.restart(!0),f&&(ot||F&&ge&&(ge<1||!Yn))&&nn(f.targets).forEach(function(qe){return qe.classList[Ee||F?"add":"remove"](f.className)}),l&&!le&&!N&&l(u),mt&&!_t?(le&&(st&&(Ye==="complete"?o.pause().totalProgress(1):Ye==="reset"?o.restart(!0).pause():Ye==="restart"?o.restart(!0):o[Ye]()),l&&l(u)),(ot||!Yn)&&(R&&ot&&jn(u,R),re[De]&&jn(u,re[De]),F&&(ge===1?u.kill(!1,1):re[De]=0),ot||(De=ge===1?1:3,re[De]&&jn(u,re[De]))),q&&!Ee&&Math.abs(u.getVelocity())>(Wo(q)?q:2500)&&(zo(u.callbackAnimation),ke?ke.progress(1):zo(o,Ye==="reverse"?1:!ge,1))):le&&l&&!_t&&l(u)}if(Ce){var et=D?X/D.duration()*(D._caScrollDist||0):X;_e(et+(d._isFlipped?1:0)),Ce(et)}Mt&&Mt(-X/D.duration()*(D._caScrollDist||0))}},u.enable=function(N,j){u.enabled||(u.enabled=!0,ht(S,"resize",Yo),de||ht(S,"scroll",Co),fe&&ht(p,"refreshInit",fe),N!==!1&&(u.progress=i=0,L=Y=h=r()),j!==!1&&u.refresh())},u.getTween=function(N){return N&&w?w.tween:ke},u.setPositions=function(N,j,W,X){if(D){var Se=D.scrollTrigger,ge=D.duration(),ne=Se.end-Se.start;N=Se.start+ne*N/ge,j=Se.start+ne*j/ge}u.refresh(!1,!1,{start:Ms(N,W&&!!u._startClamp),end:Ms(j,W&&!!u._endClamp)},X),u.update()},u.adjustPinSpacing=function(N){if(be&&N){var j=be.indexOf(P.d)+1;be[j]=parseFloat(be[j])+N+ct,be[1]=parseFloat(be[1])+N+ct,Io(be)}},u.disable=function(N,j){if(u.enabled&&(N!==!1&&u.revert(!0,!0),u.enabled=u.isActive=!1,j||ke&&ke.pause(),Qe=0,E&&(E.uncache=1),fe&&dt(p,"refreshInit",fe),Ne&&(Ne.pause(),w.tween&&w.tween.kill()&&(w.tween=0)),!de)){for(var W=ze.length;W--;)if(ze[W].scroller===S&&ze[W]!==u)return;dt(S,"resize",Yo),de||dt(S,"scroll",Co)}},u.kill=function(N,j){u.disable(N,j),ke&&!j&&ke.kill(),b&&delete rs[b];var W=ze.indexOf(u);W>=0&&ze.splice(W,1),W===At&&En>0&&At--,W=0,ze.forEach(function(X){return X.scroller===u.scroller&&(W=1)}),W||kt||(u.scroll.rec=0),o&&(o.scrollTrigger=null,N&&o.revert({kill:!1}),j||o.kill()),B&&[B,Q,d,m].forEach(function(X){return X.parentNode&&X.parentNode.removeChild(X)}),tn===u&&(tn=0),g&&(E&&(E.uncache=1),W=0,ze.forEach(function(X){return X.pin===g&&W++}),W||(E.spacer=0)),t.onKill&&t.onKill(u)},ze.push(u),u.enable(!1,!1),Ue&&Ue(u),o&&o.add&&!pe){var Ae=u.update;u.update=function(){u.update=Ae,Fe.cache++,H||v||u.refresh()},me.delayedCall(.01,u.update),pe=.01,H=v=0}else u.refresh();g&&pi()},p.register=function(t){return So||(me=t||cr(),lr()&&window.document&&p.enable(),So=Go),So},p.defaults=function(t){if(t)for(var o in t)yn[o]=t[o];return yn},p.disable=function(t,o){Go=0,ze.forEach(function(l){return l[o?"kill":"disable"](t)}),dt(He,"wheel",Co),dt(tt,"scroll",Co),clearInterval(pn),dt(tt,"touchcancel",qt),dt($e,"touchstart",qt),gn(dt,tt,"pointerdown,touchstart,mousedown",Ps),gn(dt,tt,"pointerup,touchend,mouseup",Cs),Rn.kill(),hn(dt);for(var s=0;s<Fe.length;s+=3)mn(dt,Fe[s],Fe[s+1]),mn(dt,Fe[s],Fe[s+2])},p.enable=function(){if(He=window,tt=document,Bt=tt.documentElement,$e=tt.body,me&&(nn=me.utils.toArray,$o=me.utils.clamp,ns=me.core.context||qt,Wn=me.core.suppressOverwrites||qt,fs=He.history.scrollRestoration||"auto",is=He.pageYOffset||0,me.core.globals("ScrollTrigger",p),$e)){Go=1,Do=document.createElement("div"),Do.style.height="100vh",Do.style.position="absolute",xr(),ri(),rt.register(me),p.isTouch=rt.isTouch,so=rt.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),os=rt.isTouch===1,ht(He,"wheel",Co),us=[He,tt,Bt,$e],me.matchMedia?(p.matchMedia=function(R){var U=me.matchMedia(),A;for(A in R)U.add(A,R[A]);return U},me.addEventListener("matchMediaInit",function(){return ys()}),me.addEventListener("matchMediaRevert",function(){return mr()}),me.addEventListener("matchMedia",function(){mo(0,1),vo("matchMedia")}),me.matchMedia().add("(orientation: portrait)",function(){return Vn(),Vn})):console.warn("Requires GSAP 3.11.0 or later"),Vn(),ht(tt,"scroll",Co);var t=$e.hasAttribute("style"),o=$e.style,s=o.borderTopStyle,l=me.core.Animation.prototype,f,b;for(l.revert||Object.defineProperty(l,"revert",{value:function(){return this.time(-.01,!0)}}),o.borderTopStyle="solid",f=Jt($e),ft.m=Math.round(f.top+ft.sc())||0,Dt.m=Math.round(f.left+Dt.sc())||0,s?o.borderTopStyle=s:o.removeProperty("border-top-style"),t||($e.setAttribute("style",""),$e.removeAttribute("style")),pn=setInterval(As,250),me.delayedCall(.5,function(){return dn=0}),ht(tt,"touchcancel",qt),ht($e,"touchstart",qt),gn(ht,tt,"pointerdown,touchstart,mousedown",Ps),gn(ht,tt,"pointerup,touchend,mouseup",Cs),ts=me.utils.checkPrefix("transform"),An.push(ts),So=vt(),Rn=me.delayedCall(.2,mo).pause(),Eo=[tt,"visibilitychange",function(){var R=He.innerWidth,U=He.innerHeight;tt.hidden?(_s=R,vs=U):(_s!==R||vs!==U)&&Yo()},tt,"DOMContentLoaded",mo,He,"load",mo,He,"resize",Yo],hn(ht),ze.forEach(function(R){return R.enable(0,1)}),b=0;b<Fe.length;b+=3)mn(dt,Fe[b],Fe[b+1]),mn(dt,Fe[b],Fe[b+2])}},p.config=function(t){"limitCallbacks"in t&&(Yn=!!t.limitCallbacks);var o=t.syncInterval;o&&clearInterval(pn)||(pn=o)&&setInterval(As,o),"ignoreMobileResize"in t&&(os=p.isTouch===1&&t.ignoreMobileResize),"autoRefreshEvents"in t&&(hn(dt)||hn(ht,t.autoRefreshEvents||"none"),rr=(t.autoRefreshEvents+"").indexOf("resize")===-1)},p.scrollerProxy=function(t,o){var s=It(t),l=Fe.indexOf(s),f=bo(s);~l&&Fe.splice(l,f?6:2),o&&(f?Qt.unshift(He,o,$e,o,Bt,o):Qt.unshift(s,o))},p.clearMatchMedia=function(t){ze.forEach(function(o){return o._ctx&&o._ctx.query===t&&o._ctx.kill(!0,!0)})},p.isInViewport=function(t,o,s){var l=(Lt(t)?It(t):t).getBoundingClientRect(),f=l[s?yo:xo]*o||0;return s?l.right-f>0&&l.left+f<He.innerWidth:l.bottom-f>0&&l.top+f<He.innerHeight},p.positionInViewport=function(t,o,s){Lt(t)&&(t=It(t));var l=t.getBoundingClientRect(),f=l[s?yo:xo],b=o==null?f/2:o in Bn?Bn[o]*f:~o.indexOf("%")?parseFloat(o)*f/100:parseFloat(o)||0;return s?(l.left+b)/He.innerWidth:(l.top+b)/He.innerHeight},p.killAll=function(t){if(ze.slice(0).forEach(function(s){return s.vars.id!=="ScrollSmoother"&&s.kill()}),t!==!0){var o=_o.killAll||[];_o={},o.forEach(function(s){return s()})}},p}();Re.version="3.12.7";Re.saveStyles=function(p){return p?nn(p).forEach(function(e){if(e&&e.style){var n=Ot.indexOf(e);n>=0&&Ot.splice(n,5),Ot.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),me.core.getCache(e),ns())}}):Ot};Re.revert=function(p,e){return ys(!p,e)};Re.create=function(p,e){return new Re(p,e)};Re.refresh=function(p){return p?Yo(!0):(So||Re.register())&&mo(!0)};Re.update=function(p){return++Fe.cache&&to(p===!0?2:0)};Re.clearScrollMemory=yr;Re.maxScroll=function(p,e){return $t(p,e?Dt:ft)};Re.getScrollFunc=function(p,e){return co(It(p),e?Dt:ft)};Re.getById=function(p){return rs[p]};Re.getAll=function(){return ze.filter(function(p){return p.vars.id!=="ScrollSmoother"})};Re.isScrolling=function(){return!!Ut};Re.snapDirectional=ms;Re.addEventListener=function(p,e){var n=_o[p]||(_o[p]=[]);~n.indexOf(e)||n.push(e)};Re.removeEventListener=function(p,e){var n=_o[p],t=n&&n.indexOf(e);t>=0&&n.splice(t,1)};Re.batch=function(p,e){var n=[],t={},o=e.interval||.016,s=e.batchMax||1e9,l=function(R,U){var A=[],T=[],g=me.delayedCall(o,function(){U(A,T),A=[],T=[]}).pause();return function(_){A.length||g.restart(!0),A.push(_.trigger),T.push(_),s<=A.length&&g.progress(1)}},f;for(f in e)t[f]=f.substr(0,2)==="on"&&Tt(e[f])&&f!=="onRefreshInit"?l(f,e[f]):e[f];return Tt(s)&&(s=s(),ht(Re,"refresh",function(){return s=e.batchMax()})),nn(p).forEach(function(b){var R={};for(f in t)R[f]=t[f];R.trigger=b,n.push(Re.create(R))}),n};var Ls=function(e,n,t,o){return n>o?e(o):n<0&&e(0),t>o?(o-n)/(t-n):t<0?n/(n-t):1},Zn=function p(e,n){n===!0?e.style.removeProperty("touch-action"):e.style.touchAction=n===!0?"auto":n?"pan-"+n+(rt.isTouch?" pinch-zoom":""):"none",e===Bt&&p($e,n)},_n={auto:1,scroll:1},yi=function(e){var n=e.event,t=e.target,o=e.axis,s=(n.changedTouches?n.changedTouches[0]:n).target,l=s._gsap||me.core.getCache(s),f=vt(),b;if(!l._isScrollT||f-l._isScrollT>2e3){for(;s&&s!==$e&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!(_n[(b=Gt(s)).overflowY]||_n[b.overflowX]));)s=s.parentNode;l._isScroll=s&&s!==t&&!bo(s)&&(_n[(b=Gt(s)).overflowY]||_n[b.overflowX]),l._isScrollT=f}(l._isScroll||o==="x")&&(n.stopPropagation(),n._gsapAllow=!0)},br=function(e,n,t,o){return rt.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:n,onWheel:o=o&&yi,onPress:o,onDrag:o,onScroll:o,onEnable:function(){return t&&ht(tt,rt.eventTypes[0],zs,!1,!0)},onDisable:function(){return dt(tt,rt.eventTypes[0],zs,!0)}})},xi=/(input|label|select|textarea)/i,Bs,zs=function(e){var n=xi.test(e.target.tagName);(n||Bs)&&(e._gsapAllow=!0,Bs=n)},wi=function(e){po(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var n=e,t=n.normalizeScrollX,o=n.momentum,s=n.allowNestedScroll,l=n.onRelease,f,b,R=It(e.target)||Bt,U=me.core.globals().ScrollSmoother,A=U&&U.get(),T=so&&(e.content&&It(e.content)||A&&e.content!==!1&&!A.smooth()&&A.content()),g=co(R,ft),_=co(R,Dt),M=1,x=(rt.isTouch&&He.visualViewport?He.visualViewport.scale*He.visualViewport.width:He.outerWidth)/He.innerWidth,z=0,K=Tt(o)?function(){return o(f)}:function(){return o||2.8},F,C,V=br(R,e.type,!0,s),$=function(){return C=!1},D=qt,q=qt,J=function(){b=$t(R,ft),q=$o(so?1:0,b),t&&(D=$o(0,$t(R,Dt))),F=wo},P=function(){T._gsap.y=Uo(parseFloat(T._gsap.y)+g.offset)+"px",T.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(T._gsap.y)+", 0, 1)",g.offset=g.cacheID=0},le=function(){if(C){requestAnimationFrame($);var O=Uo(f.deltaY/2),ae=q(g.v-O);if(T&&ae!==g.v+g.offset){g.offset=ae-g.v;var u=Uo((parseFloat(T&&T._gsap.y)||0)-g.offset);T.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+u+", 0, 1)",T._gsap.y=u+"px",g.cacheID=Fe.cache,to()}return!0}g.offset&&P(),C=!0},S,Z,de,ce,re=function(){J(),S.isActive()&&S.vars.scrollY>b&&(g()>b?S.progress(1)&&g(b):S.resetTo("scrollY",b))};return T&&me.set(T,{y:"+=0"}),e.ignoreCheck=function(k){return so&&k.type==="touchmove"&&le()||M>1.05&&k.type!=="touchstart"||f.isGesturing||k.touches&&k.touches.length>1},e.onPress=function(){C=!1;var k=M;M=Uo((He.visualViewport&&He.visualViewport.scale||1)/x),S.pause(),k!==M&&Zn(R,M>1.01?!0:t?!1:"x"),Z=_(),de=g(),J(),F=wo},e.onRelease=e.onGestureStart=function(k,O){if(g.offset&&P(),!O)ce.restart(!0);else{Fe.cache++;var ae=K(),u,fe;t&&(u=_(),fe=u+ae*.05*-k.velocityX/.227,ae*=Ls(_,u,fe,$t(R,Dt)),S.vars.scrollX=D(fe)),u=g(),fe=u+ae*.05*-k.velocityY/.227,ae*=Ls(g,u,fe,$t(R,ft)),S.vars.scrollY=q(fe),S.invalidate().duration(ae).play(.01),(so&&S.vars.scrollY>=b||u>=b-1)&&me.to({},{onUpdate:re,duration:ae})}l&&l(k)},e.onWheel=function(){S._ts&&S.pause(),vt()-z>1e3&&(F=0,z=vt())},e.onChange=function(k,O,ae,u,fe){if(wo!==F&&J(),O&&t&&_(D(u[2]===O?Z+(k.startX-k.x):_()+O-u[1])),ae){g.offset&&P();var he=fe[2]===ae,Me=he?de+k.startY-k.y:g()+ae-fe[1],h=q(Me);he&&Me!==h&&(de+=h-Me),g(h)}(ae||O)&&to()},e.onEnable=function(){Zn(R,t?!1:"x"),Re.addEventListener("refresh",re),ht(He,"resize",re),g.smooth&&(g.target.style.scrollBehavior="auto",g.smooth=_.smooth=!1),V.enable()},e.onDisable=function(){Zn(R,!0),dt(He,"resize",re),Re.removeEventListener("refresh",re),V.kill()},e.lockAxis=e.lockAxis!==!1,f=new rt(e),f.iOS=so,so&&!g()&&g(1),so&&me.ticker.add(qt),ce=f._dc,S=me.to(f,{ease:"power4",paused:!0,inherit:!1,scrollX:t?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:wr(g,g(),function(){return S.pause()})},onUpdate:to,onComplete:ce.vars.onComplete}),f};Re.sort=function(p){if(Tt(p))return ze.sort(p);var e=He.pageYOffset||0;return Re.getAll().forEach(function(n){return n._sortY=n.trigger?e+n.trigger.getBoundingClientRect().top:n.start+He.innerHeight}),ze.sort(p||function(n,t){return(n.vars.refreshPriority||0)*-1e6+(n.vars.containerAnimation?1e6:n._sortY)-((t.vars.containerAnimation?1e6:t._sortY)+(t.vars.refreshPriority||0)*-1e6)})};Re.observe=function(p){return new rt(p)};Re.normalizeScroll=function(p){if(typeof p>"u")return St;if(p===!0&&St)return St.enable();if(p===!1){St&&St.kill(),St=p;return}var e=p instanceof rt?p:wi(p);return St&&St.target===e.target&&St.kill(),bo(e.target)&&(St=e),e};Re.core={_getVelocityProp:es,_inputObserver:br,_scrollers:Fe,_proxies:Qt,bridge:{ss:function(){Ut||vo("scrollStart"),Ut=vt()},ref:function(){return _t}}};cr()&&me.registerPlugin(Re);var on=function(){var p=0,e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(U){U.preventDefault(),t(++p%e.children.length)},!1);function n(U){return e.appendChild(U.dom),U}function t(U){for(var A=0;A<e.children.length;A++)e.children[A].style.display=A===U?"block":"none";p=U}var o=(performance||Date).now(),s=o,l=0,f=n(new on.Panel("FPS","#0ff","#002")),b=n(new on.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var R=n(new on.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:e,addPanel:n,showPanel:t,begin:function(){o=(performance||Date).now()},end:function(){l++;var U=(performance||Date).now();if(b.update(U-o,200),U>=s+1e3&&(f.update(l*1e3/(U-s),100),s=U,l=0,R)){var A=performance.memory;R.update(A.usedJSHeapSize/1048576,A.jsHeapSizeLimit/1048576)}return U},update:function(){o=this.end()},domElement:e,setMode:t}};on.Panel=function(p,e,n){var t=1/0,o=0,s=Math.round,l=s(window.devicePixelRatio||1),f=80*l,b=48*l,R=3*l,U=2*l,A=3*l,T=15*l,g=74*l,_=30*l,M=document.createElement("canvas");M.width=f,M.height=b,M.style.cssText="width:80px;height:48px";var x=M.getContext("2d");return x.font="bold "+9*l+"px Helvetica,Arial,sans-serif",x.textBaseline="top",x.fillStyle=n,x.fillRect(0,0,f,b),x.fillStyle=e,x.fillText(p,R,U),x.fillRect(A,T,g,_),x.fillStyle=n,x.globalAlpha=.9,x.fillRect(A,T,g,_),{dom:M,update:function(z,K){t=Math.min(t,z),o=Math.max(o,z),x.fillStyle=n,x.globalAlpha=1,x.fillRect(0,0,f,T),x.fillStyle=e,x.fillText(s(z)+" "+p+" ("+s(t)+"-"+s(o)+")",R,U),x.drawImage(M,A+l,T,g-l,_,A,T,g-l,_),x.fillRect(A+g-l,T,l,_),x.fillStyle=n,x.globalAlpha=.9,x.fillRect(A+g-l,T,l,s((1-z/K)*_))}}};const _r={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class an{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const bi=new Dr(-1,1,1,-1,0,1);class _i extends ao{constructor(){super(),this.setAttribute("position",new Xo([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Xo([0,2,0,0,2,0],2))}}const vi=new _i;class vr{constructor(e){this._mesh=new Be(vi,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,bi)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class Ti extends an{constructor(e,n){super(),this.textureID=n!==void 0?n:"tDiffuse",e instanceof go?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Qn.clone(e.uniforms),this.material=new go({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new vr(this.material)}render(e,n,t){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=t.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class Ns extends an{constructor(e,n){super(),this.scene=e,this.camera=n,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,n,t){const o=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let l,f;this.inverse?(l=0,f=1):(l=1,f=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),s.buffers.stencil.setFunc(o.ALWAYS,l,4294967295),s.buffers.stencil.setClear(f),s.buffers.stencil.setLocked(!0),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(o.EQUAL,1,4294967295),s.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),s.buffers.stencil.setLocked(!0)}}class Mi extends an{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Pi{constructor(e,n){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),n===void 0){const t=e.getSize(new Le);this._width=t.width,this._height=t.height,n=new Tn(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Mn}),n.texture.name="EffectComposer.rt1"}else this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Ti(_r),this.copyPass.material.blending=Ir,this.clock=new Rr}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,n){this.passes.splice(n,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const n=this.passes.indexOf(e);n!==-1&&this.passes.splice(n,1)}isLastEnabledPass(e){for(let n=e+1;n<this.passes.length;n++)if(this.passes[n].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const n=this.renderer.getRenderTarget();let t=!1;for(let o=0,s=this.passes.length;o<s;o++){const l=this.passes[o];if(l.enabled!==!1){if(l.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(o),l.render(this.renderer,this.writeBuffer,this.readBuffer,e,t),l.needsSwap){if(t){const f=this.renderer.getContext(),b=this.renderer.state.buffers.stencil;b.setFunc(f.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),b.setFunc(f.EQUAL,1,4294967295)}this.swapBuffers()}Ns!==void 0&&(l instanceof Ns?t=!0:l instanceof Mi&&(t=!1))}}this.renderer.setRenderTarget(n)}reset(e){if(e===void 0){const n=this.renderer.getSize(new Le);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,n){this._width=e,this._height=n;const t=this._width*this._pixelRatio,o=this._height*this._pixelRatio;this.renderTarget1.setSize(t,o),this.renderTarget2.setSize(t,o);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(t,o)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Ci extends an{constructor(e,n,t=null,o=null,s=null){super(),this.scene=e,this.camera=n,this.overrideMaterial=t,this.clearColor=o,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Et}render(e,n,t){const o=e.autoClear;e.autoClear=!1;let s,l;this.overrideMaterial!==null&&(l=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:t),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(s),this.overrideMaterial!==null&&(this.scene.overrideMaterial=l),e.autoClear=o}}const Si={uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Et(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			float v = luminance( texel.xyz );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class To extends an{constructor(e,n,t,o){super(),this.strength=n!==void 0?n:1,this.radius=t,this.threshold=o,this.resolution=e!==void 0?new Le(e.x,e.y):new Le(256,256),this.clearColor=new Et(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),l=Math.round(this.resolution.y/2);this.renderTargetBright=new Tn(s,l,{type:Mn}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let A=0;A<this.nMips;A++){const T=new Tn(s,l,{type:Mn});T.texture.name="UnrealBloomPass.h"+A,T.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(T);const g=new Tn(s,l,{type:Mn});g.texture.name="UnrealBloomPass.v"+A,g.texture.generateMipmaps=!1,this.renderTargetsVertical.push(g),s=Math.round(s/2),l=Math.round(l/2)}const f=Si;this.highPassUniforms=Qn.clone(f.uniforms),this.highPassUniforms.luminosityThreshold.value=o,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new go({uniforms:this.highPassUniforms,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader}),this.separableBlurMaterials=[];const b=[3,5,7,9,11];s=Math.round(this.resolution.x/2),l=Math.round(this.resolution.y/2);for(let A=0;A<this.nMips;A++)this.separableBlurMaterials.push(this.getSeparableBlurMaterial(b[A])),this.separableBlurMaterials[A].uniforms.invSize.value=new Le(1/s,1/l),s=Math.round(s/2),l=Math.round(l/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=n,this.compositeMaterial.uniforms.bloomRadius.value=.1;const R=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=R,this.bloomTintColors=[new Ie(1,1,1),new Ie(1,1,1),new Ie(1,1,1),new Ie(1,1,1),new Ie(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const U=_r;this.copyUniforms=Qn.clone(U.uniforms),this.blendMaterial=new go({uniforms:this.copyUniforms,vertexShader:U.vertexShader,fragmentShader:U.fragmentShader,blending:Zt,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Et,this.oldClearAlpha=1,this.basic=new ut,this.fsQuad=new vr(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,n){let t=Math.round(e/2),o=Math.round(n/2);this.renderTargetBright.setSize(t,o);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(t,o),this.renderTargetsVertical[s].setSize(t,o),this.separableBlurMaterials[s].uniforms.invSize.value=new Le(1/t,1/o),t=Math.round(t/2),o=Math.round(o/2)}render(e,n,t,o,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const l=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=t.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=t.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let f=this.renderTargetBright;for(let b=0;b<this.nMips;b++)this.fsQuad.material=this.separableBlurMaterials[b],this.separableBlurMaterials[b].uniforms.colorTexture.value=f.texture,this.separableBlurMaterials[b].uniforms.direction.value=To.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[b]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[b].uniforms.colorTexture.value=this.renderTargetsHorizontal[b].texture,this.separableBlurMaterials[b].uniforms.direction.value=To.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[b]),e.clear(),this.fsQuad.render(e),f=this.renderTargetsVertical[b];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=l}getSeparableBlurMaterial(e){const n=[];for(let t=0;t<e;t++)n.push(.39894*Math.exp(-.5*t*t/(e*e))/e);return new go({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new Le(.5,.5)},direction:{value:new Le(.5,.5)},gaussianCoefficients:{value:n}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {
					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new go({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}To.BlurDirectionX=new Le(1,0);To.BlurDirectionY=new Le(0,1);class ls extends Or{constructor(e,n={}){const t=n.font;if(t===void 0)super();else{const o=t.generateShapes(e,n.size);n.depth===void 0&&(n.depth=50),n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),super(o,n)}this.type="TextGeometry"}}const Ei=Nr;class zn extends Xs{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,n,t,o){const s=this,l=new js(s.manager);l.setPath(s.path),l.setRequestHeader(s.requestHeader),l.setWithCredentials(s.withCredentials),l.load(e,function(f){try{n(s.parse(f))}catch(b){o?o(b):console.error(b),s.manager.itemError(e)}},t,o)}parse(e){const n=this;function t(h,c){if(h.nodeType!==1)return;const i=C(h);let r=!1,w=null;switch(h.nodeName){case"svg":c=_(h,c);break;case"style":s(h);break;case"g":c=_(h,c);break;case"path":c=_(h,c),h.hasAttribute("d")&&(w=o(h));break;case"rect":c=_(h,c),w=b(h);break;case"polygon":c=_(h,c),w=R(h);break;case"polyline":c=_(h,c),w=U(h);break;case"circle":c=_(h,c),w=A(h);break;case"ellipse":c=_(h,c),w=T(h);break;case"line":c=_(h,c),w=g(h);break;case"defs":r=!0;break;case"use":c=_(h,c);const L=(h.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),Y=h.viewportElement.getElementById(L);Y?t(Y,c):console.warn("SVGLoader: 'use node' references non-existent node id: "+L);break}w&&(c.fill!==void 0&&c.fill!=="none"&&w.color.setStyle(c.fill,Ei),$(w,fe),S.push(w),w.userData={node:h,style:c});const E=h.childNodes;for(let y=0;y<E.length;y++){const L=E[y];r&&L.nodeName!=="style"&&L.nodeName!=="defs"||t(L,c)}i&&(de.pop(),de.length>0?fe.copy(de[de.length-1]):fe.identity())}function o(h){const c=new no,i=new Le,r=new Le,w=new Le;let E=!0,y=!1;const L=h.getAttribute("d");if(L===""||L==="none")return null;const Y=L.match(/[a-df-z][^a-df-z]*/ig);for(let H=0,v=Y.length;H<v;H++){const B=Y[H],Q=B.charAt(0),d=B.slice(1).trim();E===!0&&(y=!0,E=!1);let m;switch(Q){case"M":m=x(d);for(let a=0,oe=m.length;a<oe;a+=2)i.x=m[a+0],i.y=m[a+1],r.x=i.x,r.y=i.y,a===0?c.moveTo(i.x,i.y):c.lineTo(i.x,i.y),a===0&&w.copy(i);break;case"H":m=x(d);for(let a=0,oe=m.length;a<oe;a++)i.x=m[a],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),a===0&&y===!0&&w.copy(i);break;case"V":m=x(d);for(let a=0,oe=m.length;a<oe;a++)i.y=m[a],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),a===0&&y===!0&&w.copy(i);break;case"L":m=x(d);for(let a=0,oe=m.length;a<oe;a+=2)i.x=m[a+0],i.y=m[a+1],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),a===0&&y===!0&&w.copy(i);break;case"C":m=x(d);for(let a=0,oe=m.length;a<oe;a+=6)c.bezierCurveTo(m[a+0],m[a+1],m[a+2],m[a+3],m[a+4],m[a+5]),r.x=m[a+2],r.y=m[a+3],i.x=m[a+4],i.y=m[a+5],a===0&&y===!0&&w.copy(i);break;case"S":m=x(d);for(let a=0,oe=m.length;a<oe;a+=4)c.bezierCurveTo(M(i.x,r.x),M(i.y,r.y),m[a+0],m[a+1],m[a+2],m[a+3]),r.x=m[a+0],r.y=m[a+1],i.x=m[a+2],i.y=m[a+3],a===0&&y===!0&&w.copy(i);break;case"Q":m=x(d);for(let a=0,oe=m.length;a<oe;a+=4)c.quadraticCurveTo(m[a+0],m[a+1],m[a+2],m[a+3]),r.x=m[a+0],r.y=m[a+1],i.x=m[a+2],i.y=m[a+3],a===0&&y===!0&&w.copy(i);break;case"T":m=x(d);for(let a=0,oe=m.length;a<oe;a+=2){const pe=M(i.x,r.x),Ge=M(i.y,r.y);c.quadraticCurveTo(pe,Ge,m[a+0],m[a+1]),r.x=pe,r.y=Ge,i.x=m[a+0],i.y=m[a+1],a===0&&y===!0&&w.copy(i)}break;case"A":m=x(d,[3,4],7);for(let a=0,oe=m.length;a<oe;a+=7){if(m[a+5]==i.x&&m[a+6]==i.y)continue;const pe=i.clone();i.x=m[a+5],i.y=m[a+6],r.x=i.x,r.y=i.y,l(c,m[a],m[a+1],m[a+2],m[a+3],m[a+4],pe,i),a===0&&y===!0&&w.copy(i)}break;case"m":m=x(d);for(let a=0,oe=m.length;a<oe;a+=2)i.x+=m[a+0],i.y+=m[a+1],r.x=i.x,r.y=i.y,a===0?c.moveTo(i.x,i.y):c.lineTo(i.x,i.y),a===0&&w.copy(i);break;case"h":m=x(d);for(let a=0,oe=m.length;a<oe;a++)i.x+=m[a],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),a===0&&y===!0&&w.copy(i);break;case"v":m=x(d);for(let a=0,oe=m.length;a<oe;a++)i.y+=m[a],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),a===0&&y===!0&&w.copy(i);break;case"l":m=x(d);for(let a=0,oe=m.length;a<oe;a+=2)i.x+=m[a+0],i.y+=m[a+1],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),a===0&&y===!0&&w.copy(i);break;case"c":m=x(d);for(let a=0,oe=m.length;a<oe;a+=6)c.bezierCurveTo(i.x+m[a+0],i.y+m[a+1],i.x+m[a+2],i.y+m[a+3],i.x+m[a+4],i.y+m[a+5]),r.x=i.x+m[a+2],r.y=i.y+m[a+3],i.x+=m[a+4],i.y+=m[a+5],a===0&&y===!0&&w.copy(i);break;case"s":m=x(d);for(let a=0,oe=m.length;a<oe;a+=4)c.bezierCurveTo(M(i.x,r.x),M(i.y,r.y),i.x+m[a+0],i.y+m[a+1],i.x+m[a+2],i.y+m[a+3]),r.x=i.x+m[a+0],r.y=i.y+m[a+1],i.x+=m[a+2],i.y+=m[a+3],a===0&&y===!0&&w.copy(i);break;case"q":m=x(d);for(let a=0,oe=m.length;a<oe;a+=4)c.quadraticCurveTo(i.x+m[a+0],i.y+m[a+1],i.x+m[a+2],i.y+m[a+3]),r.x=i.x+m[a+0],r.y=i.y+m[a+1],i.x+=m[a+2],i.y+=m[a+3],a===0&&y===!0&&w.copy(i);break;case"t":m=x(d);for(let a=0,oe=m.length;a<oe;a+=2){const pe=M(i.x,r.x),Ge=M(i.y,r.y);c.quadraticCurveTo(pe,Ge,i.x+m[a+0],i.y+m[a+1]),r.x=pe,r.y=Ge,i.x=i.x+m[a+0],i.y=i.y+m[a+1],a===0&&y===!0&&w.copy(i)}break;case"a":m=x(d,[3,4],7);for(let a=0,oe=m.length;a<oe;a+=7){if(m[a+5]==0&&m[a+6]==0)continue;const pe=i.clone();i.x+=m[a+5],i.y+=m[a+6],r.x=i.x,r.y=i.y,l(c,m[a],m[a+1],m[a+2],m[a+3],m[a+4],pe,i),a===0&&y===!0&&w.copy(i)}break;case"Z":case"z":c.currentPath.autoClose=!0,c.currentPath.curves.length>0&&(i.copy(w),c.currentPath.currentPoint.copy(i),E=!0);break;default:console.warn(B)}y=!1}return c}function s(h){if(!(!h.sheet||!h.sheet.cssRules||!h.sheet.cssRules.length))for(let c=0;c<h.sheet.cssRules.length;c++){const i=h.sheet.cssRules[c];if(i.type!==1)continue;const r=i.selectorText.split(/,/gm).filter(Boolean).map(w=>w.trim());for(let w=0;w<r.length;w++){const E=Object.fromEntries(Object.entries(i.style).filter(([,y])=>y!==""));Z[r[w]]=Object.assign(Z[r[w]]||{},E)}}}function l(h,c,i,r,w,E,y,L){if(c==0||i==0){h.lineTo(L.x,L.y);return}r=r*Math.PI/180,c=Math.abs(c),i=Math.abs(i);const Y=(y.x-L.x)/2,H=(y.y-L.y)/2,v=Math.cos(r)*Y+Math.sin(r)*H,B=-Math.sin(r)*Y+Math.cos(r)*H;let Q=c*c,d=i*i;const m=v*v,a=B*B,oe=m/Q+a/d;if(oe>1){const Pe=Math.sqrt(oe);c=Pe*c,i=Pe*i,Q=c*c,d=i*i}const pe=Q*a+d*m,Ge=(Q*d-pe)/pe;let je=Math.sqrt(Math.max(0,Ge));w===E&&(je=-je);const G=je*c*B/i,ee=-je*i*v/c,we=Math.cos(r)*G-Math.sin(r)*ee+(y.x+L.x)/2,se=Math.sin(r)*G+Math.cos(r)*ee+(y.y+L.y)/2,ye=f(1,0,(v-G)/c,(B-ee)/i),ve=f((v-G)/c,(B-ee)/i,(-v-G)/c,(-B-ee)/i)%(Math.PI*2);h.currentPath.absellipse(we,se,c,i,ye,ye+ve,E===0,r)}function f(h,c,i,r){const w=h*i+c*r,E=Math.sqrt(h*h+c*c)*Math.sqrt(i*i+r*r);let y=Math.acos(Math.max(-1,Math.min(1,w/E)));return h*r-c*i<0&&(y=-y),y}function b(h){const c=F(h.getAttribute("x")||0),i=F(h.getAttribute("y")||0),r=F(h.getAttribute("rx")||h.getAttribute("ry")||0),w=F(h.getAttribute("ry")||h.getAttribute("rx")||0),E=F(h.getAttribute("width")),y=F(h.getAttribute("height")),L=1-.551915024494,Y=new no;return Y.moveTo(c+r,i),Y.lineTo(c+E-r,i),(r!==0||w!==0)&&Y.bezierCurveTo(c+E-r*L,i,c+E,i+w*L,c+E,i+w),Y.lineTo(c+E,i+y-w),(r!==0||w!==0)&&Y.bezierCurveTo(c+E,i+y-w*L,c+E-r*L,i+y,c+E-r,i+y),Y.lineTo(c+r,i+y),(r!==0||w!==0)&&Y.bezierCurveTo(c+r*L,i+y,c,i+y-w*L,c,i+y-w),Y.lineTo(c,i+w),(r!==0||w!==0)&&Y.bezierCurveTo(c,i+w*L,c+r*L,i,c+r,i),Y}function R(h){function c(E,y,L){const Y=F(y),H=F(L);w===0?r.moveTo(Y,H):r.lineTo(Y,H),w++}const i=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,r=new no;let w=0;return h.getAttribute("points").replace(i,c),r.currentPath.autoClose=!0,r}function U(h){function c(E,y,L){const Y=F(y),H=F(L);w===0?r.moveTo(Y,H):r.lineTo(Y,H),w++}const i=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,r=new no;let w=0;return h.getAttribute("points").replace(i,c),r.currentPath.autoClose=!1,r}function A(h){const c=F(h.getAttribute("cx")||0),i=F(h.getAttribute("cy")||0),r=F(h.getAttribute("r")||0),w=new Hn;w.absarc(c,i,r,0,Math.PI*2);const E=new no;return E.subPaths.push(w),E}function T(h){const c=F(h.getAttribute("cx")||0),i=F(h.getAttribute("cy")||0),r=F(h.getAttribute("rx")||0),w=F(h.getAttribute("ry")||0),E=new Hn;E.absellipse(c,i,r,w,0,Math.PI*2);const y=new no;return y.subPaths.push(E),y}function g(h){const c=F(h.getAttribute("x1")||0),i=F(h.getAttribute("y1")||0),r=F(h.getAttribute("x2")||0),w=F(h.getAttribute("y2")||0),E=new no;return E.moveTo(c,i),E.lineTo(r,w),E.currentPath.autoClose=!1,E}function _(h,c){c=Object.assign({},c);let i={};if(h.hasAttribute("class")){const y=h.getAttribute("class").split(/\s/).filter(Boolean).map(L=>L.trim());for(let L=0;L<y.length;L++)i=Object.assign(i,Z["."+y[L]])}h.hasAttribute("id")&&(i=Object.assign(i,Z["#"+h.getAttribute("id")]));function r(y,L,Y){Y===void 0&&(Y=function(v){return v.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),v}),h.hasAttribute(y)&&(c[L]=Y(h.getAttribute(y))),i[y]&&(c[L]=Y(i[y])),h.style&&h.style[y]!==""&&(c[L]=Y(h.style[y]))}function w(y){return Math.max(0,Math.min(1,F(y)))}function E(y){return Math.max(0,F(y))}return r("fill","fill"),r("fill-opacity","fillOpacity",w),r("fill-rule","fillRule"),r("opacity","opacity",w),r("stroke","stroke"),r("stroke-opacity","strokeOpacity",w),r("stroke-width","strokeWidth",E),r("stroke-linejoin","strokeLineJoin"),r("stroke-linecap","strokeLineCap"),r("stroke-miterlimit","strokeMiterLimit",E),r("visibility","visibility"),c}function M(h,c){return h-(c-h)}function x(h,c,i){if(typeof h!="string")throw new TypeError("Invalid input: "+typeof h);const r={WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},w=0,E=1,y=2,L=3;let Y=w,H=!0,v="",B="";const Q=[];function d(pe,Ge,je){const G=new SyntaxError('Unexpected character "'+pe+'" at index '+Ge+".");throw G.partial=je,G}function m(){v!==""&&(B===""?Q.push(Number(v)):Q.push(Number(v)*Math.pow(10,Number(B)))),v="",B=""}let a;const oe=h.length;for(let pe=0;pe<oe;pe++){if(a=h[pe],Array.isArray(c)&&c.includes(Q.length%i)&&r.FLAGS.test(a)){Y=E,v=a,m();continue}if(Y===w){if(r.WHITESPACE.test(a))continue;if(r.DIGIT.test(a)||r.SIGN.test(a)){Y=E,v=a;continue}if(r.POINT.test(a)){Y=y,v=a;continue}r.COMMA.test(a)&&(H&&d(a,pe,Q),H=!0)}if(Y===E){if(r.DIGIT.test(a)){v+=a;continue}if(r.POINT.test(a)){v+=a,Y=y;continue}if(r.EXP.test(a)){Y=L;continue}r.SIGN.test(a)&&v.length===1&&r.SIGN.test(v[0])&&d(a,pe,Q)}if(Y===y){if(r.DIGIT.test(a)){v+=a;continue}if(r.EXP.test(a)){Y=L;continue}r.POINT.test(a)&&v[v.length-1]==="."&&d(a,pe,Q)}if(Y===L){if(r.DIGIT.test(a)){B+=a;continue}if(r.SIGN.test(a)){if(B===""){B+=a;continue}B.length===1&&r.SIGN.test(B)&&d(a,pe,Q)}}r.WHITESPACE.test(a)?(m(),Y=w,H=!1):r.COMMA.test(a)?(m(),Y=w,H=!0):r.SIGN.test(a)?(m(),Y=E,v=a):r.POINT.test(a)?(m(),Y=y,v=a):d(a,pe,Q)}return m(),Q}const z=["mm","cm","in","pt","pc","px"],K={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function F(h){let c="px";if(typeof h=="string"||h instanceof String)for(let r=0,w=z.length;r<w;r++){const E=z[r];if(h.endsWith(E)){c=E,h=h.substring(0,h.length-E.length);break}}let i;return c==="px"&&n.defaultUnit!=="px"?i=K.in[n.defaultUnit]/n.defaultDPI:(i=K[c][n.defaultUnit],i<0&&(i=K[c].in*n.defaultDPI)),i*parseFloat(h)}function C(h){if(!(h.hasAttribute("transform")||h.nodeName==="use"&&(h.hasAttribute("x")||h.hasAttribute("y"))))return null;const c=V(h);return de.length>0&&c.premultiply(de[de.length-1]),fe.copy(c),de.push(c),c}function V(h){const c=new Mo,i=ce;if(h.nodeName==="use"&&(h.hasAttribute("x")||h.hasAttribute("y"))){const r=F(h.getAttribute("x")),w=F(h.getAttribute("y"));c.translate(r,w)}if(h.hasAttribute("transform")){const r=h.getAttribute("transform").split(")");for(let w=r.length-1;w>=0;w--){const E=r[w].trim();if(E==="")continue;const y=E.indexOf("("),L=E.length;if(y>0&&y<L){const Y=E.slice(0,y),H=x(E.slice(y+1));switch(i.identity(),Y){case"translate":if(H.length>=1){const v=H[0];let B=0;H.length>=2&&(B=H[1]),i.translate(v,B)}break;case"rotate":if(H.length>=1){let v=0,B=0,Q=0;v=H[0]*Math.PI/180,H.length>=3&&(B=H[1],Q=H[2]),re.makeTranslation(-B,-Q),k.makeRotation(v),O.multiplyMatrices(k,re),re.makeTranslation(B,Q),i.multiplyMatrices(re,O)}break;case"scale":if(H.length>=1){const v=H[0];let B=v;H.length>=2&&(B=H[1]),i.scale(v,B)}break;case"skewX":H.length===1&&i.set(1,Math.tan(H[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":H.length===1&&i.set(1,0,0,Math.tan(H[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":H.length===6&&i.set(H[0],H[2],H[4],H[1],H[3],H[5],0,0,1);break}}c.premultiply(i)}}return c}function $(h,c){function i(y){u.set(y.x,y.y,1).applyMatrix3(c),y.set(u.x,u.y)}function r(y){const L=y.xRadius,Y=y.yRadius,H=Math.cos(y.aRotation),v=Math.sin(y.aRotation),B=new Ie(L*H,L*v,0),Q=new Ie(-Y*v,Y*H,0),d=B.applyMatrix3(c),m=Q.applyMatrix3(c),a=ce.set(d.x,m.x,0,d.y,m.y,0,0,0,1),oe=re.copy(a).invert(),je=k.copy(oe).transpose().multiply(oe).elements,G=le(je[0],je[1],je[4]),ee=Math.sqrt(G.rt1),we=Math.sqrt(G.rt2);if(y.xRadius=1/ee,y.yRadius=1/we,y.aRotation=Math.atan2(G.sn,G.cs),!((y.aEndAngle-y.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const ye=re.set(ee,0,0,0,we,0,0,0,1),ve=k.set(G.cs,G.sn,0,-G.sn,G.cs,0,0,0,1),Pe=ye.multiply(ve).multiply(a),ie=be=>{const{x:_e,y:ue}=new Ie(Math.cos(be),Math.sin(be),0).applyMatrix3(Pe);return Math.atan2(ue,_e)};y.aStartAngle=ie(y.aStartAngle),y.aEndAngle=ie(y.aEndAngle),D(c)&&(y.aClockwise=!y.aClockwise)}}function w(y){const L=J(c),Y=P(c);y.xRadius*=L,y.yRadius*=Y;const H=L>Number.EPSILON?Math.atan2(c.elements[1],c.elements[0]):Math.atan2(-c.elements[3],c.elements[4]);y.aRotation+=H,D(c)&&(y.aStartAngle*=-1,y.aEndAngle*=-1,y.aClockwise=!y.aClockwise)}const E=h.subPaths;for(let y=0,L=E.length;y<L;y++){const H=E[y].curves;for(let v=0;v<H.length;v++){const B=H[v];B.isLineCurve?(i(B.v1),i(B.v2)):B.isCubicBezierCurve?(i(B.v0),i(B.v1),i(B.v2),i(B.v3)):B.isQuadraticBezierCurve?(i(B.v0),i(B.v1),i(B.v2)):B.isEllipseCurve&&(ae.set(B.aX,B.aY),i(ae),B.aX=ae.x,B.aY=ae.y,q(c)?r(B):w(B))}}}function D(h){const c=h.elements;return c[0]*c[4]-c[1]*c[3]<0}function q(h){const c=h.elements,i=c[0]*c[3]+c[1]*c[4];if(i===0)return!1;const r=J(h),w=P(h);return Math.abs(i/(r*w))>Number.EPSILON}function J(h){const c=h.elements;return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function P(h){const c=h.elements;return Math.sqrt(c[3]*c[3]+c[4]*c[4])}function le(h,c,i){let r,w,E,y,L;const Y=h+i,H=h-i,v=Math.sqrt(H*H+4*c*c);return Y>0?(r=.5*(Y+v),L=1/r,w=h*L*i-c*L*c):Y<0?w=.5*(Y-v):(r=.5*v,w=-.5*v),H>0?E=H+v:E=H-v,Math.abs(E)>2*Math.abs(c)?(L=-2*c/E,y=1/Math.sqrt(1+L*L),E=L*y):Math.abs(c)===0?(E=1,y=0):(L=-.5*E/c,E=1/Math.sqrt(1+L*L),y=L*E),H>0&&(L=E,E=-y,y=L),{rt1:r,rt2:w,cs:E,sn:y}}const S=[],Z={},de=[],ce=new Mo,re=new Mo,k=new Mo,O=new Mo,ae=new Le,u=new Ie,fe=new Mo,he=new DOMParser().parseFromString(e,"image/svg+xml");return t(he.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:S,xml:he.documentElement}}static createShapes(e){const t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},o={loc:t.ORIGIN,t:0};function s(M,x,z,K){const F=M.x,C=x.x,V=z.x,$=K.x,D=M.y,q=x.y,J=z.y,P=K.y,le=($-V)*(D-J)-(P-J)*(F-V),S=(C-F)*(D-J)-(q-D)*(F-V),Z=(P-J)*(C-F)-($-V)*(q-D),de=le/Z,ce=S/Z;if(Z===0&&le!==0||de<=0||de>=1||ce<0||ce>1)return null;if(le===0&&Z===0){for(let re=0;re<2;re++)if(l(re===0?z:K,M,x),o.loc==t.ORIGIN){const k=re===0?z:K;return{x:k.x,y:k.y,t:o.t}}else if(o.loc==t.BETWEEN){const k=+(F+o.t*(C-F)).toPrecision(10),O=+(D+o.t*(q-D)).toPrecision(10);return{x:k,y:O,t:o.t}}return null}else{for(let O=0;O<2;O++)if(l(O===0?z:K,M,x),o.loc==t.ORIGIN){const ae=O===0?z:K;return{x:ae.x,y:ae.y,t:o.t}}const re=+(F+de*(C-F)).toPrecision(10),k=+(D+de*(q-D)).toPrecision(10);return{x:re,y:k,t:de}}}function l(M,x,z){const K=z.x-x.x,F=z.y-x.y,C=M.x-x.x,V=M.y-x.y,$=K*V-C*F;if(M.x===x.x&&M.y===x.y){o.loc=t.ORIGIN,o.t=0;return}if(M.x===z.x&&M.y===z.y){o.loc=t.DESTINATION,o.t=1;return}if($<-Number.EPSILON){o.loc=t.LEFT;return}if($>Number.EPSILON){o.loc=t.RIGHT;return}if(K*C<0||F*V<0){o.loc=t.BEHIND;return}if(Math.sqrt(K*K+F*F)<Math.sqrt(C*C+V*V)){o.loc=t.BEYOND;return}let D;K!==0?D=C/K:D=V/F,o.loc=t.BETWEEN,o.t=D}function f(M,x){const z=[],K=[];for(let F=1;F<M.length;F++){const C=M[F-1],V=M[F];for(let $=1;$<x.length;$++){const D=x[$-1],q=x[$],J=s(C,V,D,q);J!==null&&z.find(P=>P.t<=J.t+Number.EPSILON&&P.t>=J.t-Number.EPSILON)===void 0&&(z.push(J),K.push(new Le(J.x,J.y)))}}return K}function b(M,x,z){const K=new Le;x.getCenter(K);const F=[];return z.forEach(C=>{C.boundingBox.containsPoint(K)&&f(M,C.points).forEach($=>{F.push({identifier:C.identifier,isCW:C.isCW,point:$})})}),F.sort((C,V)=>C.point.x-V.point.x),F}function R(M,x,z,K,F){(F==null||F==="")&&(F="nonzero");const C=new Le;M.boundingBox.getCenter(C);const V=[new Le(z,C.y),new Le(K,C.y)],$=b(V,M.boundingBox,x);$.sort((S,Z)=>S.point.x-Z.point.x);const D=[],q=[];$.forEach(S=>{S.identifier===M.identifier?D.push(S):q.push(S)});const J=D[0].point.x,P=[];let le=0;for(;le<q.length&&q[le].point.x<J;)P.length>0&&P[P.length-1]===q[le].identifier?P.pop():P.push(q[le].identifier),le++;if(P.push(M.identifier),F==="evenodd"){const S=P.length%2===0,Z=P[P.length-2];return{identifier:M.identifier,isHole:S,for:Z}}else if(F==="nonzero"){let S=!0,Z=null,de=null;for(let ce=0;ce<P.length;ce++){const re=P[ce];S?(de=x[re].isCW,S=!1,Z=re):de!==x[re].isCW&&(de=x[re].isCW,S=!0)}return{identifier:M.identifier,isHole:S,for:Z}}else console.warn('fill-rule: "'+F+'" is currently not implemented.')}let U=999999999,A=-999999999,T=e.subPaths.map(M=>{const x=M.getPoints();let z=-999999999,K=999999999,F=-999999999,C=999999999;for(let V=0;V<x.length;V++){const $=x[V];$.y>z&&(z=$.y),$.y<K&&(K=$.y),$.x>F&&(F=$.x),$.x<C&&(C=$.x)}return A<=F&&(A=F+1),U>=C&&(U=C-1),{curves:M.curves,points:x,isCW:Br.isClockWise(x),identifier:-1,boundingBox:new Lr(new Le(C,K),new Le(F,z))}});T=T.filter(M=>M.points.length>1);for(let M=0;M<T.length;M++)T[M].identifier=M;const g=T.map(M=>R(M,T,U,A,e.userData?e.userData.style.fillRule:void 0)),_=[];return T.forEach(M=>{if(!g[M.identifier].isHole){const z=new zr;z.curves=M.curves,g.filter(F=>F.isHole&&F.for===M.identifier).forEach(F=>{const C=T[F.identifier],V=new Hn;V.curves=C.curves,z.holes.push(V)}),_.push(z)}}),_}static getStrokeStyle(e,n,t,o,s){return e=e!==void 0?e:1,n=n!==void 0?n:"#000",t=t!==void 0?t:"miter",o=o!==void 0?o:"butt",s=s!==void 0?s:4,{strokeColor:n,strokeWidth:e,strokeLineJoin:t,strokeLineCap:o,strokeMiterLimit:s}}static pointsToStroke(e,n,t,o){const s=[],l=[],f=[];if(zn.pointsToStrokeWithBuffers(e,n,t,o,s,l,f)===0)return null;const b=new ao;return b.setAttribute("position",new Xo(s,3)),b.setAttribute("normal",new Xo(l,3)),b.setAttribute("uv",new Xo(f,2)),b}static pointsToStrokeWithBuffers(e,n,t,o,s,l,f,b){const R=new Le,U=new Le,A=new Le,T=new Le,g=new Le,_=new Le,M=new Le,x=new Le,z=new Le,K=new Le,F=new Le,C=new Le,V=new Le,$=new Le,D=new Le,q=new Le,J=new Le;t=t!==void 0?t:12,o=o!==void 0?o:.001,b=b!==void 0?b:0,e=H(e);const P=e.length;if(P<2)return 0;const le=e[0].equals(e[P-1]);let S,Z=e[0],de;const ce=n.strokeWidth/2,re=1/(P-1);let k=0,O,ae,u,fe,he=!1,Me=0,h=b*3,c=b*2;i(e[0],e[1],R).multiplyScalar(ce),x.copy(e[0]).sub(R),z.copy(e[0]).add(R),K.copy(x),F.copy(z);for(let v=1;v<P;v++){S=e[v],v===P-1?le?de=e[1]:de=void 0:de=e[v+1];const B=R;if(i(Z,S,B),A.copy(B).multiplyScalar(ce),C.copy(S).sub(A),V.copy(S).add(A),O=k+re,ae=!1,de!==void 0){i(S,de,U),A.copy(U).multiplyScalar(ce),$.copy(S).sub(A),D.copy(S).add(A),u=!0,A.subVectors(de,Z),B.dot(A)<0&&(u=!1),v===1&&(he=u),A.subVectors(de,S),A.normalize();const Q=Math.abs(B.dot(A));if(Q>Number.EPSILON){const d=ce/Q;A.multiplyScalar(-d),T.subVectors(S,Z),g.copy(T).setLength(d).add(A),q.copy(g).negate();const m=g.length(),a=T.length();T.divideScalar(a),_.subVectors(de,S);const oe=_.length();switch(_.divideScalar(oe),T.dot(q)<a&&_.dot(q)<oe&&(ae=!0),J.copy(g).add(S),q.add(S),fe=!1,ae?u?(D.copy(q),V.copy(q)):($.copy(q),C.copy(q)):E(),n.strokeLineJoin){case"bevel":y(u,ae,O);break;case"round":L(u,ae),u?w(S,C,$,O,0):w(S,D,V,O,1);break;case"miter":case"miter-clip":default:const pe=ce*n.strokeMiterLimit/m;if(pe<1)if(n.strokeLineJoin!=="miter-clip"){y(u,ae,O);break}else L(u,ae),u?(_.subVectors(J,C).multiplyScalar(pe).add(C),M.subVectors(J,$).multiplyScalar(pe).add($),r(C,O,0),r(_,O,0),r(S,O,.5),r(S,O,.5),r(_,O,0),r(M,O,0),r(S,O,.5),r(M,O,0),r($,O,0)):(_.subVectors(J,V).multiplyScalar(pe).add(V),M.subVectors(J,D).multiplyScalar(pe).add(D),r(V,O,1),r(_,O,1),r(S,O,.5),r(S,O,.5),r(_,O,1),r(M,O,1),r(S,O,.5),r(M,O,1),r(D,O,1));else ae?(u?(r(z,k,1),r(x,k,0),r(J,O,0),r(z,k,1),r(J,O,0),r(q,O,1)):(r(z,k,1),r(x,k,0),r(J,O,1),r(x,k,0),r(q,O,0),r(J,O,1)),u?$.copy(J):D.copy(J)):u?(r(C,O,0),r(J,O,0),r(S,O,.5),r(S,O,.5),r(J,O,0),r($,O,0)):(r(V,O,1),r(J,O,1),r(S,O,.5),r(S,O,.5),r(J,O,1),r(D,O,1)),fe=!0;break}}else E()}else E();!le&&v===P-1&&Y(e[0],K,F,u,!0,k),k=O,Z=S,x.copy($),z.copy(D)}if(!le)Y(S,C,V,u,!1,O);else if(ae&&s){let v=J,B=q;he!==u&&(v=q,B=J),u?(fe||he)&&(B.toArray(s,0*3),B.toArray(s,3*3),fe&&v.toArray(s,1*3)):(fe||!he)&&(B.toArray(s,1*3),B.toArray(s,3*3),fe&&v.toArray(s,0*3))}return Me;function i(v,B,Q){return Q.subVectors(B,v),Q.set(-Q.y,Q.x).normalize()}function r(v,B,Q){s&&(s[h]=v.x,s[h+1]=v.y,s[h+2]=0,l&&(l[h]=0,l[h+1]=0,l[h+2]=1),h+=3,f&&(f[c]=B,f[c+1]=Q,c+=2)),Me+=3}function w(v,B,Q,d,m){R.copy(B).sub(v).normalize(),U.copy(Q).sub(v).normalize();let a=Math.PI;const oe=R.dot(U);Math.abs(oe)<1&&(a=Math.abs(Math.acos(oe))),a/=t,A.copy(B);for(let pe=0,Ge=t-1;pe<Ge;pe++)T.copy(A).rotateAround(v,a),r(A,d,m),r(T,d,m),r(v,d,.5),A.copy(T);r(T,d,m),r(Q,d,m),r(v,d,.5)}function E(){r(z,k,1),r(x,k,0),r(C,O,0),r(z,k,1),r(C,O,0),r(V,O,1)}function y(v,B,Q){B?v?(r(z,k,1),r(x,k,0),r(C,O,0),r(z,k,1),r(C,O,0),r(q,O,1),r(C,Q,0),r($,Q,0),r(q,Q,.5)):(r(z,k,1),r(x,k,0),r(V,O,1),r(x,k,0),r(q,O,0),r(V,O,1),r(V,Q,1),r(q,Q,0),r(D,Q,1)):v?(r(C,Q,0),r($,Q,0),r(S,Q,.5)):(r(V,Q,1),r(D,Q,0),r(S,Q,.5))}function L(v,B){B&&(v?(r(z,k,1),r(x,k,0),r(C,O,0),r(z,k,1),r(C,O,0),r(q,O,1),r(C,k,0),r(S,O,.5),r(q,O,1),r(S,O,.5),r($,k,0),r(q,O,1)):(r(z,k,1),r(x,k,0),r(V,O,1),r(x,k,0),r(q,O,0),r(V,O,1),r(V,k,1),r(q,O,0),r(S,O,.5),r(S,O,.5),r(q,O,0),r(D,k,1)))}function Y(v,B,Q,d,m,a){switch(n.strokeLineCap){case"round":m?w(v,Q,B,a,.5):w(v,B,Q,a,.5);break;case"square":if(m)R.subVectors(B,v),U.set(R.y,-R.x),A.addVectors(R,U).add(v),T.subVectors(U,R).add(v),d?(A.toArray(s,1*3),T.toArray(s,0*3),T.toArray(s,3*3)):(A.toArray(s,1*3),f[3*2+1]===1?T.toArray(s,3*3):A.toArray(s,3*3),T.toArray(s,0*3));else{R.subVectors(Q,v),U.set(R.y,-R.x),A.addVectors(R,U).add(v),T.subVectors(U,R).add(v);const oe=s.length;d?(A.toArray(s,oe-1*3),T.toArray(s,oe-2*3),T.toArray(s,oe-4*3)):(T.toArray(s,oe-2*3),A.toArray(s,oe-1*3),T.toArray(s,oe-4*3))}break}}function H(v){let B=!1;for(let d=1,m=v.length-1;d<m;d++)if(v[d].distanceTo(v[d+1])<o){B=!0;break}if(!B)return v;const Q=[];Q.push(v[0]);for(let d=1,m=v.length-1;d<m;d++)v[d].distanceTo(v[d+1])>=o&&Q.push(v[d]);return Q.push(v[v.length-1]),Q}}}function Ai(p,e,n,t){const{CUBE_SIZE:o,FIRST_CUBE_Z:s}=n,l=8,f=24,b=.075,R=200;let U,A=[],T=[],g=[],_=[];const M=(C,V,$,D)=>{const q=new Ro(C,C,C),J=new jo(q),P=[new Rt({color:16711680,transparent:!0,opacity:D.opacity,blending:Zt}),new Rt({color:65280,transparent:!0,opacity:D.opacity,blending:Zt}),new Rt({color:255,transparent:!0,opacity:D.opacity,blending:Zt}),new Rt({color:65535,transparent:!0,opacity:D.opacity,blending:Zt}),new Rt({color:16711935,transparent:!0,opacity:D.opacity,blending:Zt}),new Rt({color:16776960,transparent:!0,opacity:D.opacity,blending:Zt})],le=new gt,S=J.getAttribute("position").array,Z=[];for(let re=0;re<S.length/3;re+=2)Z.push(re,re+1);const de=Array(6).fill(null).map(()=>new ao),ce=Array(6).fill(null).map(()=>[]);for(let re=0;re<Z.length/2;re++){const k=re%6;ce[k].push(Z[re*2],Z[re*2+1])}return de.forEach((re,k)=>{re.setIndex(ce[k]),re.setAttribute("position",J.getAttribute("position"));const O=new xt(re,P[k]);le.add(O)}),le.position.z=V,le.rotation.z=$,le};if((()=>{const $=.9/(f-1);for(let Z=0;Z<f;Z++)T[Z]=new Rt({transparent:!0,opacity:1-Z*$});if(U=new gt,!U){console.error("introGroup failed to initialize");return}for(let Z=0;Z<f;Z++){const de=o-Z*l,ce=M(de,0,0,T[Z]),re=ce.children.map(k=>k.material);_.push(re.map(k=>({material:k,originalColor:k.color.clone()}))),U.add(ce)}U.position.z=s,p.add(U),A.push(U),g=T.map(Z=>Z.opacity);const D=Oe.timeline({repeat:-1});D.to(U.rotation,{x:Ze.degToRad(360),duration:12,ease:"none"},0),D.to(U.rotation,{y:Ze.degToRad(360),duration:10,ease:"none"},0),D.to(U.rotation,{z:Ze.degToRad(360),duration:14,ease:"none"},0);let q=-1,J=0;const P=b*1e3,le=f*P,S=Z=>{const de=Z%le/P,ce=Math.floor(de)%f;q!==-1&&Z-J>=P&&(_[q].forEach(O=>{O.material.opacity=g[q],O.material.color.copy(O.originalColor)}),q=-1),q===-1&&ce!==q&&(q=ce,J=Z,_[q].forEach(k=>{k.material.opacity=1,k.material.color.set(1,1,1)})),requestAnimationFrame(S)};requestAnimationFrame(S)})(),e.value){const C=z(e.value);p.add(C)}else console.warn('Font not available; "SCROLL TO CONTINUE" message skipped.');return{introCubes:A};function z(C){const V=new gt,$=K(C);$.position.set(0,-36,0),V.add($),F(q=>{V.add(q),Oe.fromTo($.material,{opacity:.3},{opacity:1,duration:3,ease:"linear",repeat:-1,yoyo:!0});const J=q.children.find(P=>P instanceof Be&&P!==q.children[0]);if(J){const P=J.position.y;Oe.to(J.position,{y:P+3,duration:1,ease:"easeOut",onComplete:()=>{J.position.y=P},repeat:-1})}}),V.position.x=0,V.position.y=-240;const D=s-f*l;return V.position.z=D+R,V}function K(C){const V=new ls("SCROLL TO CONTINUE",{font:C,size:8,depth:0,curveSegments:12,bevelEnabled:!1});V.computeBoundingBox(),V.center();const $=new ut({color:16777215,transparent:!0,opacity:1});return new Be(V,$)}function F(C){new zn().load("/3D/mouse.svg",$=>{const D=$.paths;let q=null,J=null,P=new gt;if(D.forEach((le,S)=>{zn.createShapes(le).forEach(de=>{const ce=new Hr(de);ce.computeBoundingBox();const re=new ut({color:16777215,transparent:!0,opacity:1,side:Xt}),k=new Be(ce,re);k.scale.set(.05,.05,1),S===0?q=k:S===1&&(J=k)})}),q&&J){P.add(q),P.add(J);const S=(q.geometry.boundingBox.max.x-q.geometry.boundingBox.min.x)*q.scale.x/2;P.position.x=-S,P.rotation.x=Math.PI,C(P)}})}}function ki(p,e,n,t,o,s,l,f){const b=rn(),R=Vs(),{CUBE_SIZE:U,CUBE_SPACING:A,FIRST_CUBE_Z:T}=e,g=T-(n.length+1)*A,_=65535,M=16711935,x=Ze.degToRad(15),z=1e3,K=.5,F=65280,C=80,V=1,$=15,D=.1,q="ENTER TO LEARN MORE",J=R.isMobile?1:.5,P=40,le=.125,S=100,Z=8,de=R.isMobile?1.5:2,ce=R.isMobile?2:3.5,re=1;let k=[];k.length=0;let O=!1,ae=!1,u=new Fr,fe=new Le,he=null,Me=null,h=null,c=!1,i=null;const r=new Map,w=new Map,E=new Map,y=(G,ee,we,se,ye,ve,Pe)=>{const ie=new gt;ie.position.z=we,ie.rotation.z=se,ie.userData.isActive=!1,ie.userData.cubeIndex=Pe;const be=new Ro(ee,ee,ee),_e=new jo(be),ue=new Rt({color:new Et(_),transparent:!0,opacity:0}),Ce=new xt(_e,ue);Ce.geometry.computeBoundingSphere(),ie.add(Ce);let Ve="right";const xe=ee/2,at=Ne=>{const Mt=new xs(40,24),Ue=new jo(Mt),Wt=new Rt({color:new Et(_),transparent:!0,opacity:0,visible:!0}),I=new xt(Ue,Wt);I.userData.isPortal=!0,I.userData.isAnimating=!1,I.geometry.computeBoundingSphere();const te=new oo(80,80),Ae=new ut({visible:!1,side:Xt}),N=new Be(te,Ae);N.userData.isPortalHitbox=!0,N.userData.portal=I,N.geometry.computeBoundingSphere();const j=new gt,W=new oo(V,$),X=65/2;for(let qe=0;qe<C;qe++){const Vt=new ut({color:new Et(M),transparent:!0,opacity:0,visible:!1,side:Xt}),Xe=new Be(W,Vt),Je=qe/C*Math.PI*2;Xe.position.set(Math.cos(Je)*X,Math.sin(Je)*X,0),Xe.rotation.z=Je+Math.PI/2,Xe.userData.baseOpacity=.01,Xe.userData.index=qe,Xe.geometry.computeBoundingSphere(),j.add(Xe)}const Se=2,ge=25;for(let qe=1;qe<ge;qe++){const Vt=new xs(40,24),Xe=new jo(Vt),Je=Ze.lerp(1,.1,qe/(ge-1)),yt=new Rt({color:new Et(_),transparent:!0,opacity:0}),Yt=new xt(Xe,yt);Yt.userData.isPortal=!0,Yt.userData.maxOpacity=Je,Yt.position.z=-qe*Se,Yt.geometry.computeBoundingSphere(),I.add(Yt)}if(I.userData.maxOpacity=1,f.value){const qe=new ls(q,{font:f.value,size:3,depth:0,curveSegments:12,bevelEnabled:!1});qe.computeBoundingBox(),qe.center();const Vt=new ut({color:16777215,transparent:!0,opacity:0,side:Xt}),Xe=new Be(qe,Vt);Xe.visible=!1,Xe.userData.isVisible=!1,Xe.userData.isExploreText=!0,Xe.userData.skipTextMeshes=!0;const Je=45;Xe.position.set(0,Je,0),I.add(Xe),I.userData.exploreText=Xe;const yt=qe.boundingBox,Yt=yt.max.x-yt.min.x+10,ln=yt.max.y-yt.min.y+10,uo=new oo(Yt,ln),Nt=new ut({transparent:!0,opacity:0,side:Xt,visible:!1}),Ht=new Be(uo,Nt);Ht.position.set(0,Je,0),Ht.userData.isExploreTextHitbox=!0,Ht.userData.portal=I,Ht.geometry.computeBoundingSphere(),I.add(Ht),I.userData.exploreTextHitbox=Ht}else console.warn("Font not loaded yet; 'EXPLORE' text skipped for this portal.");const ne=new gt,Ee=new oo(12,R.isMobile?1:.5),Te=new ut({color:16777215,transparent:!0,opacity:0,side:Xt}),De=new Be(Ee,Te);De.rotation.z=Math.PI/4;const Ye=new Be(Ee,Te);Ye.rotation.z=-Math.PI/4,ne.add(De,Ye);const mt=new oo(30,30),ot=new ut({opacity:0,transparent:!0,side:Xt,visible:!0}),pt=new Be(mt,ot);pt.userData.isCloseHitbox=!0,pt.geometry.computeBoundingSphere(),pt.renderOrder=2,ne.add(pt);const st=42,Ke=42,We=-10;ne.visible=!1;let et;switch(Ve){case"left":I.position.set(-xe,0,0),I.rotation.y=Math.PI/2,N.position.set(-xe,0,0),N.rotation.y=Math.PI/2,se>=Ze.degToRad(120)?(I.rotation.z=Math.PI,ne.position.set(-xe+We,-42,st),et=new Ie(-xe+We,-42,st)):(ne.position.set(-xe+We,Ke,-42),et=new Ie(-xe+We,Ke,-42)),ne.rotation.y=Math.PI/2,j.children.forEach(qe=>qe.position.x+=D);break;case"top":I.position.set(0,-xe,0),I.rotation.x=-Math.PI/2,I.rotation.z=-Math.PI/2,N.position.set(0,-xe,0),N.rotation.x=Math.PI/2,se>=Ze.degToRad(100)?se>=Ze.degToRad(180)?(I.rotation.z=Math.PI/2,ne.position.set(-42,-xe+We,-42),et=new Ie(-42,-xe+We,-42)):(ne.position.set(Ke,-xe+We,st),et=new Ie(Ke,-xe+We,st)):(ne.position.set(Ke,-xe+We,st),et=new Ie(Ke,-xe+We,st)),ne.rotation.x=-Math.PI/2,j.children.forEach(qe=>qe.position.y+=D);break;case"right":I.position.set(xe,0,0),I.rotation.y=-Math.PI/2,N.position.set(xe,0,0),N.rotation.y=-Math.PI/2,se>=Ze.degToRad(120)?(I.rotation.z=Math.PI,ne.position.set(xe+We,-42,-42),et=new Ie(xe+We,-42,-42)):(ne.position.set(xe+We,Ke,st),et=new Ie(xe+We,Ke,st)),ne.rotation.y=-Math.PI/2,j.children.forEach(qe=>qe.position.x+=D);break;case"bottom":I.position.set(0,xe,0),I.rotation.x=Math.PI/2,I.rotation.z=-Math.PI/2,N.position.set(0,xe,0),N.rotation.x=Math.PI/2,se>=Ze.degToRad(100)?(ne.position.set(st,xe-We,-42),et=new Ie(st,xe-We,-42)):(ne.position.set(Ke,xe-We,-42),et=new Ie(Ke,xe-We,-42)),ne.rotation.x=Math.PI/2,j.children.forEach(qe=>qe.position.y+=D);break}ie.userData.initialCloseGroupPosition=et,ne.updateMatrixWorld(!0),I.add(j),ie.add(I),ie.add(N),ie.add(ne),ie.userData.closeButton=ne,I.updateMatrixWorld(!0),j.updateMatrixWorld(!0),ne.updateMatrixWorld(!0),r.set(ie,[]),w.set(ie,0),E.set(ie,0)},ke=Ne=>{(Ne instanceof xt||Ne instanceof Be)&&Ne.geometry&&Ne.geometry.computeBoundingSphere(),ie.add(Ne)};if(ye&&s.showKeyarts){switch(["left","top","right","bottom"].includes(ve)?ve:"left"){case"left":Ve="right";break;case"top":Ve="bottom";break;case"right":Ve="left";break;case"bottom":Ve="top";break}const Qe=l.get(ye);if(Qe){const lt=new oo(ee-1,ee-1),Mt=new ut({map:Qe,transparent:!0,opacity:0,blending:Zt,side:Xt}),Ue=new Be(lt,Mt);switch(Ue.userData.isLoaded=!0,ve){case"left":Ue.position.set(-xe,0,0),se>=Ze.degToRad(120)?(Ue.rotation.y=Math.PI/2,Ue.rotation.z=-Math.PI):Ue.rotation.y=Math.PI/2;break;case"top":Ue.position.set(0,-xe,0),Ue.rotation.x=-Math.PI/2,Ue.rotation.z=-Math.PI/2;break;case"right":Ue.position.set(xe,0,0),se>=Ze.degToRad(120)?(Ue.rotation.y=-Math.PI/2,Ue.rotation.z=-Math.PI):Ue.rotation.y=-Math.PI/2;break;case"bottom":Ue.position.set(0,xe,0),se>=Ze.degToRad(180)?se>=Ze.degToRad(220)?(Ue.rotation.x=Math.PI/2,Ue.rotation.z=Math.PI/2):(Ue.rotation.x=-Math.PI/2,Ue.rotation.z=Math.PI/2):(Ue.rotation.x=Math.PI/2,Ue.rotation.z=-Math.PI/2);break}Ue.geometry.computeBoundingSphere(),ke(Ue),at()}else console.warn(`Keyart texture not preloaded for ${G.title}: ${ye}`),at()}else at();ie.userData.portalLocation=Ve;{const Ne=(te,Ae,N,j)=>{const W=new oo(ee-1,ee-1),X={map:te,transparent:!0,opacity:0,blending:Zt,side:Xt,depthWrite:!1};j&&(X.color=j);const Se=new ut(X),ge=new Be(W,Se);ge.position.copy(Ae),N.x&&(ge.rotation.x=N.x),N.y&&(ge.rotation.y=N.y),ge.userData.isGridPlane=!0,ge.geometry.computeBoundingSphere(),ke(ge)},Qe=l.get(t),lt=l.get(o),Mt=["left","top","right","bottom"],Wt=[ye&&s.showKeyarts?ve||"left":null,Ve].filter(Boolean),I=Mt.filter(te=>!Wt.includes(te));if(Qe)switch(Ne(Qe,new Ie(0,0,-ee/2-1),{y:0}),Ne(Qe,new Ie(0,0,ee/2+1),{y:0},new Et(16744448)),I[0]){case"left":Ne(Qe,new Ie(-xe,0,0),{y:-Math.PI/2},new Et(255));break;case"top":Ne(Qe,new Ie(0,xe,0),{x:Math.PI/2},new Et(255));break;case"right":Ne(Qe,new Ie(xe,0,0),{y:Math.PI/2},new Et(255));break;case"bottom":Ne(Qe,new Ie(0,-xe,0),{x:-Math.PI/2},new Et(255));break}else console.warn(`Grid texture not preloaded: ${t}`);if(lt)switch(I[1]){case"left":Ne(lt,new Ie(-xe,0,0),{y:-Math.PI/2});break;case"top":Ne(lt,new Ie(0,xe,0),{x:Math.PI/2});break;case"right":Ne(lt,new Ie(xe,0,0),{y:Math.PI/2});break;case"bottom":Ne(lt,new Ie(0,-xe,0),{x:-Math.PI/2});break}else console.warn(`Grid texture not preloaded: ${o}`)}ie.children.forEach(Ne=>{Ne.updateMatrixWorld(!0),Ne instanceof gt&&Ne.children.forEach(Qe=>{Qe.updateMatrixWorld(!0)})}),ie.updateMatrixWorld(!0);const bt=new qs().setFromObject(ie),nt=new Zs;return bt.getBoundingSphere(nt),ie.boundingSphere=nt,ie},L=new Gr,Y=(G,ee,we,se,ye)=>{if(!f.value){console.warn("Font not available; skipping text creation for:",G);const bt=new ao,nt=new ut({visible:!1});return new Be(bt,nt)}const ve=new ls(G,{font:f.value,size:ye,depth:0,curveSegments:12,bevelEnabled:!1});ve.computeBoundingBox(),ve.center();const Pe=new ut({color:16777215,transparent:!0,opacity:0,side:Xt}),ie=new Be(ve,Pe);ie.position.set(ee,we,se);const be=ve.boundingBox,_e=be.max.x-be.min.x,ue=be.max.y-be.min.y,Ce=_e+8,Ve=ue+4,xe=new oo(Ce,Ve),at=new ut({color:0,transparent:!0,opacity:0,side:Xt}),ke=new Be(xe,at);return ke.position.set(ee,we,se-1),p.add(ke),p.add(ie),ie.userData.backgroundPlane=ke,ie},H=()=>{const G=Array.isArray(n)?n:[];Array.isArray(n)||console.warn("useProjectCubes: projects is not an array, defaulting to empty array",n);let ee=0;G.forEach((we,se)=>{const ye=T-(se+1)*A,ve=(se+1)*x,Pe=y(we,U,ye,ve,we.keyart,we.keyartLocation,ee);p.add(Pe),k.push(Pe),ee++,Y(we.title,0,we.size-15,T+90-(se+1)*A,we.size)})},v=()=>O?Promise.resolve({projectCubes:k,updateCubeColors:a,maxZ:g}):(H(),O=!0,Promise.resolve({projectCubes:k,updateCubeColors:a,maxZ:g})),B=G=>{if(G.userData.isAnimating)return;G.userData.isAnimating=!0;const ee=G.children.find(Pe=>Pe instanceof gt);if(!ee)return;const we=ee.children,se=we.length,ye=Oe.timeline({repeat:-1,defaults:{ease:"none"}}),ve={value:0};ye.to(ve,{value:1,duration:1.5,onUpdate:()=>{we.forEach(ie=>{const be=ie.material;if(be.visible){const _e=(ie.userData.index/se+ve.value)%1,Ce=(Math.sin(_e*Math.PI*2)+1)/2;be.opacity=.01+(1-.01)*Math.pow(Ce,4)}})}}),G.userData.animationTimeline=ye},Q=G=>{if(!G.userData.isAnimating)return;G.userData.isAnimating=!1;const ee=G.children.find(we=>we instanceof gt);ee&&(G.userData.animationTimeline&&(G.userData.animationTimeline.kill(),delete G.userData.animationTimeline),ee.children.forEach(we=>{const se=we.material;se.opacity=0}))},d=(G,ee)=>{let we;const se=(E.get(G)||0)+1;E.set(G,se),se%Z===0?we=new Ur(de,ce,12,1):we=new Ro(J,J,J);const ye=new ut({color:16777215,transparent:!0,opacity:0}),ve=new Be(we,ye);ve.position.set(0,0,0);const Pe=ee.position.clone(),ie=Pe.clone().normalize(),be=Pe.length()+S;if(se%Z===0){const ue=ve.position.clone().add(ie);ve.lookAt(ue),ve.rotateX(Math.PI/2)}G.add(ve),Oe.to(ye,{opacity:.5,duration:re,ease:"power2.in",overwrite:"auto"});const _e=r.get(G)||[];_e.push({mesh:ve,direction:ie,distanceTraveled:0,totalDistance:be}),r.set(G,_e)},m=G=>{(r.get(G)||[]).forEach(we=>{G.remove(we.mesh),we.mesh.geometry.dispose(),we.mesh.material.dispose()}),r.set(G,[])},a=G=>{L.setFromProjectionMatrix(G.projectionMatrix.clone().multiply(G.matrixWorldInverse));const ee=G.position.z;let we=[];p.traverse(se=>{var ye;return se instanceof Be&&((ye=se.geometry)==null?void 0:ye.type)==="TextGeometry"&&!se.userData.skipTextMeshes&&we.push(se)}),ae||(ae=!0),k.forEach((se,ye)=>{const ve=se.boundingSphere;if(ve){const _e=ve.clone();if(_e.radius*=1.5,!L.intersectsSphere(_e))return}else console.warn(`Cube ${ye} has no boundingSphere`);const Pe=se.position.z,ie=Math.abs(ee-Pe);let be=0;ie<=z&&(be=1-ie/z),se.userData.isActive=be>=K,se.children.forEach(_e=>{if(_e instanceof xt&&!_e.userData.isPortal&&!_e.userData.isPortalHitbox){const ue=_e.material;if(ie<=z){const Ce=Ze.lerp((_>>16&255)/255,(M>>16&255)/255,be),Ve=Ze.lerp((_>>8&255)/255,(M>>8&255)/255,be),xe=Ze.lerp((_&255)/255,(M&255)/255,be);ue.color.set(Ce,Ve,xe),ue.opacity=Math.min(1,be*2)}else ue.opacity=0}else if(_e instanceof xt&&_e.userData.isPortal)_e.children.forEach(ue=>{if(ue instanceof Be&&ue.userData.isExploreText){const Ce=ue.material;if(ie<=z){const Ve=1-ie/z;Ce.opacity=Math.min(1,Ve*2),ue.visible=!0}else Ce.opacity=0,ue.visible=!1}}),ae&&(be>.1?_e.children.forEach(ue=>{ue instanceof gt&&ue.children.forEach(Ce=>{Ce instanceof Be&&(Ce.material.visible=!0,!_e.userData.animationStarted&&s.showPortalPulses&&(B(_e),_e.userData.animationStarted=!0))})}):be<=.1&&_e.userData.animationStarted&&(_e.children.forEach(ue=>{ue instanceof gt&&ue.children.forEach(Ce=>{Ce instanceof Be&&(Ce.material.visible=!1)})}),Q(_e),delete _e.userData.animationStarted));else if(_e instanceof Be&&!_e.userData.isPortalHitbox&&!_e.userData.isCloseHitbox){const ue=_e.material;if(_e.userData.isLoaded||_e.userData.isGridPlane)if(ie<=z){const Ce=1-ie/z;ue.opacity=Math.min(.8,Ce*2),_e.visible=!0}else ue.opacity=0,_e.visible=!1}else if(_e instanceof gt&&_e.userData.closeButton){const ue=Math.abs(ee-_e.position.z);_e.children.forEach(Ce=>{if(Ce instanceof Be&&!Ce.userData.isCloseHitbox){const Ve=Ce.material;if(ue<=z){const xe=1-ue/z;Ve.opacity=Math.min(1,xe*2)}else Ve.opacity=0}})}})}),we.forEach(se=>{if(!L.intersectsObject(se))return;const ye=se.material,ve=se.userData.backgroundPlane,Pe=ve==null?void 0:ve.material,ie=se.position.z,be=Math.abs(ee-ie+120);if(c){ye.opacity=0,Pe&&(Pe.opacity=0);return}if(be<=z){const _e=1-be/z,ue=Math.min(1,_e*2);ye.opacity=ue,Pe&&(Pe.opacity=ue*.8)}else ye.opacity=0,Pe&&(Pe.opacity=0)})},oe=(G,ee)=>{const we=performance.now()/1e3,se=G.position.z;k.forEach(ye=>{const ve=ye.position.z;if(Math.abs(se-ve+90)<=z&&!c){const ie=w.get(ye)||0;if(we-ie>=le){const ue=ye.children.find(Ce=>Ce instanceof xt&&Ce.userData.isPortal);ue&&(d(ye,ue),w.set(ye,we))}const _e=(r.get(ye)||[]).filter(ue=>{if(ue.distanceTraveled+=P*ee,ue.mesh.position.copy(ue.direction.clone().multiplyScalar(ue.distanceTraveled)),(ue.totalDistance-ue.distanceTraveled)/P<=re&&!ue.isFadingOut){ue.isFadingOut=!0;const xe=ue.mesh.material;Oe.to(xe,{opacity:0,duration:re,ease:"power2.out",overwrite:"auto"})}return ue.distanceTraveled>=ue.totalDistance?(ye.remove(ue.mesh),ue.mesh.geometry.dispose(),ue.mesh.material.dispose(),!1):!0});r.set(ye,_e)}else m(ye)})},pe=G=>{const ee=[G,...G.children.filter(ye=>ye instanceof xt&&ye.userData.isPortal)],we=2,se=.1;ee.forEach((ye,ve)=>{const Pe=ye.material;Pe.opacity=ye.userData.maxOpacity;const ie=Oe.timeline({repeat:-1,delay:ve*se});ie.to(Pe,{opacity:0,duration:we/2,ease:"power2.inOut"}).to(Pe,{opacity:ye.userData.maxOpacity,duration:we/2,ease:"power2.inOut"}),ye.userData.marqueeTimeline=ie})},Ge=G=>{[G,...G.children.filter(we=>we instanceof xt&&we.userData.isPortal)].forEach(we=>{if(we.userData.marqueeTimeline){we.userData.marqueeTimeline.kill(),delete we.userData.marqueeTimeline;const se=we.material;se.opacity=we.userData.maxOpacity}})};return{getInitializedData:v,updateCubeColors:a,setupInteractivity:(G,ee,we,se,ye)=>{i=se;let ve=null,Pe=null,ie=null,be=!1,_e=!1,ue=!1,Ce=!1,Ve=[],xe=!1;p.traverse(I=>{var te;I instanceof Be&&((te=I.geometry)==null?void 0:te.type)==="TextGeometry"&&!I.userData.skipTextMeshes&&Ve.push(I)});const at=I=>{c&&(ve=I.touches[0].clientY,Pe=Pe??window.scrollY,be=!0)},ke=I=>{if(!c||!ie||!ve||Ce)return;const Ae=I.touches[0].clientY-ve;b.isMobile&&Ae<-50&&!_e&&(I.cancelable&&I.preventDefault(),Ne(),ve=null)},bt=I=>{ve=null,be=!1,ue=!0,Oe.delayedCall(.5,()=>{ue=!1})},nt=I=>{if(be||_e||ue||Ce){I.preventDefault(),I.stopPropagation(),Pe!==null&&(window.scrollTo(0,Pe),Oe.to(window,{scrollTo:{y:Pe},duration:0}));return}if(!c||!ie||!Me||!h)return;if(b.isMobile){I.preventDefault(),I.stopPropagation();return}let te=0;if(I instanceof WheelEvent?te=I.deltaY:te=window.scrollY-(Pe||0),I.preventDefault(),I.stopPropagation(),te>0){window.scrollTo(0,Pe);return}te<0&&Ne()},Ne=()=>{const I=ie,te=h?h.clone():new Ie(0,0,g),Ae=(Me==null?void 0:Me.z)??G.position.z,N=I==null?void 0:I.parent,j=I?k.indexOf(N):-1;Ce=!0,I&&Ge(I);const W=G.userData.lockedLookAt?G.userData.lockedLookAt.clone():G.getWorldDirection(new Ie).multiplyScalar(1e3).add(G.position),X={progress:0};Oe.to(G.position,{x:(Me==null?void 0:Me.x)??G.position.x,y:(Me==null?void 0:Me.y)??G.position.y,z:Ae,duration:2,ease:"power3.inOut",overwrite:"auto",onStart:()=>{const Se=Ve[j];if(j!==-1&&Se){const ge=Ve[j];if(ge){const ne=ge.material,Ee=ge.userData.backgroundPlane,Te=Math.abs(G.position.z-ge.position.z+120),De=Te<=z?Math.min(1,(1-Te/z)*2):0;Oe.to(ne,{opacity:De,duration:.5,ease:"power2.in"}),Ee&&Oe.to(Ee.material,{opacity:De*.8,duration:.5,ease:"power2.in"})}}if(N!=null&&N.userData.closeButton){const ge=N.userData.closeButton.position;Oe.to(N.userData.closeButton.rotation,{z:0,duration:.3,ease:"power2.inOut"}),Oe.to(N.userData.closeButton.position,{x:ge.x+2,duration:.3,ease:"power2.inOut"});const ne=N.userData.closeButton.children.filter(Ee=>Ee instanceof Be).map(Ee=>Ee.material);Oe.to(ne,{opacity:0,duration:.5,onUpdate:()=>{},onComplete:()=>{N.userData.closeButton.updateMatrixWorld(!0),N.userData.closeButton.visible=!1,N.userData.lockedPosition=null,xe=!1}}),I&&Qe(I,!1)}},onUpdate:()=>{const Se=X.progress,ge=Ze.lerp(W.x,te.x,Se),ne=Ze.lerp(W.y,te.y,Se),Ee=Ze.lerp(W.z,te.z,Se);G.lookAt(ge,ne,Ee),G.updateMatrixWorld(!0)},onComplete:()=>{G.lookAt(te),c=!1,ie=null,document.body.classList.remove("no-scrollbar"),b.isMobile&&(document.body.style.overflow=""),i&&i(!1),I&&Ge(I),Pe=null,Me=null,h=null,G.userData.lockedLookAt=null,Ce=!1,k.forEach(Se=>{Math.abs(G.position.z-Se.position.z+90)<=z&&w.set(Se,0)})}}),Oe.to(X,{progress:1,duration:2,ease:"power3.inOut",overwrite:"auto"})},Qe=(I,te=!0)=>{const Ae=[I,...I.children.filter(j=>j instanceof xt&&j.userData.isPortal)],N=te?25:2;Ae.forEach((j,W)=>{let X=-W*N;(I.position.y>0&&I.rotation.x===-Math.PI/2||I.position.y<0&&I.rotation.x===Math.PI/2)&&(X=W*N);const Se=te?j.userData.maxOpacity:0;Oe.to(j.position,{z:X,duration:1,ease:"power3.out",delay:.5,onComplete:()=>{te&&W===0&&pe(I)}}),Oe.to(j.material,{opacity:Se,duration:1,ease:"power3.out",delay:.5})})},lt=I=>{var N;fe.x=I.clientX/window.innerWidth*2-1,fe.y=-(I.clientY/window.innerHeight)*2+1,u.setFromCamera(fe,G),G.userData.lockedLookAt&&(G.lookAt(G.userData.lockedLookAt),G.updateMatrixWorld(!0)),k.forEach(j=>{j.userData.lockedPosition&&(j.position.equals(j.userData.lockedPosition)||j.position.copy(j.userData.lockedPosition)),j.updateMatrixWorld(!0),j.children.forEach(W=>W.updateMatrixWorld(!0))});const te=k.flatMap(j=>{const W=[];return!c&&j.userData.isActive&&j.children.forEach(X=>{X instanceof Be&&(X.userData.isPortalHitbox||X.userData.isExploreTextHitbox)&&W.push(X)}),c&&ie&&j===ie.parent&&j.children.forEach(X=>{X instanceof Be&&X.userData.isPortalHitbox&&W.push(X),X instanceof xt&&X.userData.isPortal&&X.children.forEach(Se=>{Se instanceof Be&&Se.userData.isExploreTextHitbox&&W.push(Se)}),X instanceof gt&&X===j.userData.closeButton&&X.children.forEach(Se=>{Se instanceof Be&&Se.userData.isCloseHitbox&&W.push(Se)})}),W}),Ae=u.intersectObjects(te);if(Ae.length>0){const j=Ae[0].object;if(j.userData.isPortalHitbox||j.userData.isExploreTextHitbox){const W=j.userData.portal;he!==W&&(he&&[he,...he.children.filter(ge=>ge instanceof xt&&ge.userData.isPortal)].forEach(ge=>{const ne=ge.material;Oe.to(ne.color,{r:(_>>16&255)/255,g:(_>>8&255)/255,b:(_&255)/255,duration:.5})}),he=W,[he,...he.children.filter(Se=>Se instanceof xt&&Se.userData.isPortal)].forEach(Se=>{const ge=Se.material;Oe.to(ge.color,{r:(F>>16&255)/255,g:(F>>8&255)/255,b:(F&255)/255,duration:.5})})),ee.style.cursor="pointer"}else if(j.userData.isCloseHitbox&&c){if(!xe){xe=!0;const W=j.parent;W.children.filter(Se=>Se instanceof Be&&!Se.userData.isCloseHitbox);const X=W.position;Oe.to(W.rotation,{z:Math.PI/2,duration:.3,ease:"power2.inOut"}),Oe.to(W.position,{x:X.x-2,duration:.3,ease:"power2.inOut"})}ee.style.cursor="pointer"}else ee.style.cursor="auto"}else{if(he&&([he,...he.children.filter(W=>W instanceof xt&&W.userData.isPortal)].forEach(W=>{const X=W.material;Oe.to(X.color,{r:(_>>16&255)/255,g:(_>>8&255)/255,b:(_&255)/255,duration:.5})}),he=null),c&&ie&&xe){const j=(N=ie.parent)==null?void 0:N.userData.closeButton,W=j.position;j&&(xe=!1,Oe.to(j.rotation,{z:0,duration:.3,ease:"power2.inOut"}),Oe.to(j.position,{x:W.x+2,duration:.3,ease:"power2.inOut"}))}ee.style.cursor="auto"}},Mt=I=>{if(console.log("isScrollTriggerActive()",ye()),Ce)return;fe.x=I.clientX/window.innerWidth*2-1,fe.y=-(I.clientY/window.innerHeight)*2+1,u.setFromCamera(fe,G);const te=k.flatMap(ne=>{const Ee=[];return c&&ie&&ne===ie.parent&&ne.children.forEach(Te=>{Te instanceof gt&&Te===ne.userData.closeButton&&Te.children.forEach(De=>{De instanceof Be&&De.userData.isCloseHitbox&&Ee.push(De)})}),Ee}),Ae=k.flatMap(ne=>{const Ee=[];return!c&&ne.userData.isActive&&ne.children.forEach(Te=>{Te instanceof Be&&(Te.userData.isPortalHitbox||Te.userData.isExploreTextHitbox)&&Ee.push(Te)}),c&&ie&&ne===ie.parent&&ne.children.forEach(Te=>{Te instanceof Be&&Te.userData.isPortalHitbox&&Ee.push(Te),Te instanceof xt&&Te.userData.isPortal&&Te.children.forEach(De=>{De instanceof Be&&De.userData.isExploreTextHitbox&&Ee.push(De)})}),Ee});let N=u.intersectObjects(te);for(const ne of N)if(ne.object.userData.isCloseHitbox){Ne();return}if(N=u.intersectObjects(Ae),N.length===0)return;const W=N[0].object.userData.portal,X=W.parent,Se=k.indexOf(X),ge=n[Se];if(c&&W===ie){let ne=new Ie;const Ee=e.CUBE_SIZE/2;W.position.x===Ee?ne.set(-1,0,0):W.position.x===-Ee?ne.set(1,0,0):W.position.y===Ee?ne.set(0,-1,0):W.position.y===-Ee&&ne.set(0,1,0),ne.applyQuaternion(X.getWorldQuaternion(new Wr)).normalize();const De=G.position.clone().clone().add(ne.clone().multiplyScalar(-675)),Ye=ne.clone().multiplyScalar(-1e3),mt=De.clone().add(Ye);Ce=!0,Oe.to(G.position,{x:De.x,y:De.y,z:De.z,duration:1,ease:"power2.in",onUpdate:()=>G.lookAt(mt),onStart:()=>{Oe.to(we.domElement,{opacity:0,duration:1,ease:"power2.in",overwrite:"auto"})},onComplete:()=>{ge!=null&&ge.slug&&(R.setScrollPosition(window.scrollY),Tr.visit(route("project.show",{project:ge.slug}),{preserveScroll:!1})),Ce=!1}})}else if(!c){Me||(Me=G.position.clone(),h=new Ie(0,0,g)),i&&se(!0,Me,h);const ne=W.getWorldPosition(new Ie);_e=!0,Ce=!0,Pe=window.scrollY,Oe.to(G.position,{x:0,y:0,z:X.getWorldPosition(new Ie).z,duration:2,ease:"power3.out",overwrite:"all",onStart:()=>{c=!0,ie=W,document.body.classList.add("no-scrollbar"),b.isMobile&&(document.body.style.overflow="hidden"),Qe(W,!0),X.userData.lockedPosition=X.position.clone(),m(X);const Ee=Ve[Se];if(Ee){const Te=Ee.material,De=Ee.userData.backgroundPlane;Oe.to(Te,{opacity:0,duration:.5,ease:"power2.out"}),De&&Oe.to(De.material,{opacity:0,duration:.5,ease:"power2.out"})}},onComplete:()=>{if(X.userData.closeButton){X.userData.initialCloseGroupPosition&&X.userData.closeButton.position.copy(X.userData.initialCloseGroupPosition),X.userData.closeButton.visible=!0,X.userData.closeButton.updateMatrixWorld(!0),X.updateMatrixWorld(!0),X.userData.closeButton.updateMatrixWorld(!0);const Ee=X.userData.closeButton.children.filter(Te=>Te instanceof Be&&!Te.userData.isCloseHitbox).map(Te=>Te.material);Ee.length>0&&Oe.to(Ee,{opacity:1,duration:.5,onComplete:()=>{X.userData.closeButton.updateMatrixWorld(!0)}})}else console.warn("Close button not found in cube.userData")}}),Oe.to({},{duration:2,ease:"power2.out",overwrite:"all",onUpdate:function(){const Ee=this.progress(),Te=G.getWorldDirection(new Ie).multiplyScalar(1e3).add(G.position),De=Ze.lerp(Te.x,ne.x,Ee),Ye=Ze.lerp(Te.y,ne.y,Ee),mt=Ze.lerp(Te.z,ne.z,Ee);G.lookAt(De,Ye,mt)},onComplete:()=>{G.lookAt(ne.x,ne.y,ne.z),G.updateMatrixWorld(!0),_e=!1,Ce=!1,G.userData.lockedLookAt=ne.clone()}})}};ee.addEventListener("mousemove",lt),ee.addEventListener("click",Mt),ee.addEventListener("touchstart",at,{passive:!1}),ee.addEventListener("touchmove",ke,{passive:!1}),ee.addEventListener("touchend",bt,{passive:!0}),window.addEventListener("wheel",nt,{passive:!1}),window.addEventListener("scroll",nt,{passive:!1});const Ue=()=>{r.forEach((I,te)=>{I.forEach(Ae=>{te.remove(Ae.mesh),Ae.mesh.geometry.dispose(),Ae.mesh.material.dispose()})}),r.clear(),w.clear(),E.clear()},Wt=()=>{ee.removeEventListener("mousemove",lt),ee.removeEventListener("click",Mt),ee.removeEventListener("touchstart",at),ee.removeEventListener("touchmove",ke),ee.removeEventListener("touchend",bt),window.removeEventListener("wheel",nt),window.removeEventListener("scroll",nt),ie&&Ge(ie),b.isMobile&&(document.body.style.overflow="")};return()=>{Wt(),Ue()}},updateClickHereParticles:oe}}function Di(p,e,n,t){const o=rn(),s=100,l=100,f=300,b=3355443,R=o.isMobile?24:32,U=-600,A=-500,T=1e3,g=o.isMobile?5:10,_=.05,M=1,x=o.isMobile?6:4,z=o.isMobile?4:6,K=100,F=-450,C=60,V=n-T,$=Math.abs(A-V),D=Math.ceil($/s),q=()=>{const u=new gt;let fe=null,he=null;const Me=[],h=[],c=[],i=[],r=[];{const w=new Ro(s,s,s),E=new jo(w),y=R*D,L=new Yr;L.copy(E),L.instanceCount=y;const Y=new Rt({color:b,transparent:!0,fog:!0,vertexColors:!0}),H=new Float32Array(y*3),v=new Float32Array(y*3),B=new Float32Array(y*3),Q=R*s,d=-Q/2+s/2,m=A;for(let be=0;be<R;be++){const _e=J(be);for(let ue=0;ue<D;ue++){const Ce=be*D+ue,Ve=d+be*s,xe=m-ue*s,at=Ze.randFloat(l,f),ke=at/s,bt=U+at/2;H[Ce*3]=Ve,H[Ce*3+1]=bt,H[Ce*3+2]=xe,v[Ce*3]=1,v[Ce*3+1]=ke,v[Ce*3+2]=1,B[Ce*3]=_e,B[Ce*3+1]=_e,B[Ce*3+2]=_e}}L.setAttribute("instancePosition",new Fn(H,3)),L.setAttribute("instanceScale",new Fn(v,3)),L.setAttribute("color",new Fn(B,3)),Y.onBeforeCompile=be=>{be.vertexShader=`
                    attribute vec3 instancePosition;
                    attribute vec3 instanceScale;
                    ${be.vertexShader}
                `.replace("#include <begin_vertex>",`#include <begin_vertex>
                    transformed *= instanceScale;
                    transformed += instancePosition;`)},fe=new xt(L,Y);const a=-Q/2,oe=Q/2,pe=U,Ge=U+f,je=V,G=A;L.boundingBox=new qs(new Ie(a,pe,je),new Ie(oe,Ge,G));const ee=(a+oe)/2,we=(pe+Ge)/2,se=(je+G)/2,ye=oe-a,ve=Ge-pe,Pe=G-je,ie=Math.sqrt(ye*ye+ve*ve+Pe*Pe)/2;L.boundingSphere=new Zs(new Ie(ee,we,se),ie),u.add(fe)}{he=new gt;const w=R*s/(z-1),E=-(R*s)/2;for(let L=0;L<z;L++){let H=E+L*w,v=A;const B=[new Ie(H,F,v)];let Q=0;for(;v>V;){const d=v===A?Ze.randFloat(300,800):Math.min(Ze.randFloat(300,800),Math.abs(v-V));if(v-=d,B.push(new Ie(H,F,v)),Q+=d,v<=V){B[B.length-1].z=V;break}const m=Math.random()<.5?-1:1,a=Ze.randFloat(100,300);H+=m*a,B.push(new Ie(H,F,v)),Q+=a}h.push({points:B,totalLength:Q})}const y=new Ro(x,x,x);for(let L=0;L<z;L++){const Y=h[L],H=Y.totalLength,v=H/C;for(let B=0;B<C;B++){const Q=new ut({color:16711680,fog:!0}),d=new Be(y,Q),m=B*v;let a=m;for(let oe=0;oe<Y.points.length-1;oe++){const pe=Y.points[oe],Ge=Y.points[oe+1],je=pe.distanceTo(Ge);if(a<=je){const G=a/je;d.position.lerpVectors(pe,Ge,G);break}a-=je}Me.push(d),c.push(m),i.push(L),r.push(1),he.add(d)}for(let B=0;B<C;B++){const Q=new ut({color:16777215,fog:!0}),d=new Be(y,Q),m=H-(B*v+v/2);let a=H-m;const oe=[...Y.points].reverse();for(let pe=0;pe<oe.length-1;pe++){const Ge=oe[pe],je=oe[pe+1],G=Ge.distanceTo(je);if(a<=G){const ee=a/G;d.position.lerpVectors(Ge,je,ee);break}a-=G}Me.push(d),c.push(m),i.push(L),r.push(-1),he.add(d)}}e.add(he)}return e.add(u),{cityGroup:u,instancedLines:fe,particleGroup:he,particles:Me,paths:h,particleDistances:c,particlePaths:i,particleDirections:r}},J=u=>{if(u<g){const fe=(M-_)/(g-1);return _+u*fe}else if(u>=R-g){const fe=R-1-u,he=(M-_)/(g-1);return _+fe*he}return M},{cityGroup:P,instancedLines:le,particleGroup:S,particles:Z,paths:de,particleDistances:ce,particlePaths:re,particleDirections:k}=q();return{cityGroup:P,buildingLines:le?[le]:[],updateParticles:u=>{const fe=K*u;for(let he=0;he<Z.length;he++){const Me=k[he],h=re[he],c=de[h],i=c.totalLength;ce[he]+=fe*Me,Me===1?(ce[he]=ce[he]%i,ce[he]<0&&(ce[he]+=i)):ce[he]=(ce[he]+i)%i;const r=ce[he],w=Me===1?c.points:[...c.points].reverse();let E=Me===1?r:i-r;for(let y=0;y<w.length-1;y++){const L=w[y],Y=w[y+1],H=L.distanceTo(Y);if(E<=H){const v=E/H;Z[he].position.lerpVectors(L,Y,v);break}E-=H}}},dispose:()=>{le&&(P.remove(le),le.geometry.dispose(),le.material.dispose()),S&&(e.remove(S),S.children.forEach(u=>{u.geometry.dispose(),u.material.dispose()})),e.remove(P)}}}Oe.registerPlugin(Re);function Ii(p,e,n,t,o,s,l={},f,b){const R=rn(),{CUBE_SPACING:U,FIRST_CUBE_Z:A}=s,T=(t==null?void 0:t.length)||0,g=A-(T+1)*U;let _=!1,M=!1;const x=R.isMobile?(Math.abs(g)+(T-1)*U)*.7:Math.abs(g)+(T-1)*U;let z=Oe.timeline();Re.config({ignoreMobileResize:!0});{let C=0;const V=16;z=Oe.timeline({scrollTrigger:{trigger:n.value,start:"top top",end:`+=${x}`,scrub:l.scrub,pin:!0,onUpdate:$=>{const D=performance.now();if(D-C>=V){if(!_){const q=$.progress,J=Ze.lerp(0,g,q);e.position.set(0,0,J),e.lookAt(0,0,g)}o(e),C=D}b&&b.update()},onRefresh:()=>{e.updateProjectionMatrix()}}}),z.fromTo(e.position,{z:0},{z:g,duration:1,ease:"none"},0)}return{setReverting:C=>{_=C},timeline:z,isScrollTriggerActive:()=>M}}function Ri(p,e,n){const t=rn(),o=t.isMobile?25:20,s=t.isMobile?1e3:2e3,l=4e3,f=-1e3,b=n-1e3,R=1e3,U=n,A=150,T=-500,g=n,_=new ao,M=new Float32Array(s*3),x=new Float32Array(s),z=new Float32Array(s);let K=0;for(;K<s;){const D=(Math.random()-.5)*l,q=(Math.random()-.5)*l,J=f+Math.random()*(b-f),P=J>U&&Math.abs(D)<R&&Math.abs(q)<R,le=Math.abs(D)<A&&Math.abs(q)<A&&J>g&&J<T;if(!P&&!le){const S=K*3;M[S]=D,M[S+1]=q,M[S+2]=J;const Z=.1+Math.random()*(.7-.1);x[K]=Z,z[K]=Z,K++}}_.setAttribute("position",new ws(M,3)),_.setAttribute("opacity",new ws(z,1));const F=new go({uniforms:{color:{value:new Et(1,1,1)},size:{value:o}},vertexShader:`
            attribute float opacity;
            varying float vOpacity;
            uniform float size;
            void main() {
                vOpacity = opacity;
                vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
                gl_PointSize = size * (300.0 / -mvPosition.z); // Size attenuation
                gl_Position = projectionMatrix * mvPosition;
            }
        `,fragmentShader:`
            uniform vec3 color;
            varying float vOpacity;
            void main() {
                float dist = distance(gl_PointCoord, vec2(0.5, 0.5)) * 2.0;
                float alpha = vOpacity * (1.0 - dist);
                if (alpha <= 0.0) discard;
                gl_FragColor = vec4(color, alpha);
            }
        `,transparent:!0,fog:!1,depthWrite:!1}),C=new Xr(_,F);p.add(C);const V=_.attributes.opacity;for(let D=0;D<s;D++)Oe.to({opacity:x[D]},{opacity:.05,duration:1+Math.random(),yoyo:!0,repeat:-1,ease:"sine.inOut",delay:Math.random()*2,onUpdate:function(){z[D]=this.targets()[0].opacity,V.needsUpdate=!0}});return{dispose:()=>{Oe.killTweensOf(z),p.remove(C),_.dispose(),F.dispose()}}}function Oi(p,e){const t=e-1500,o=100,s=2,l=64,f=1e3,b=l*3,R=[4,4.5,5],U=6;let A,T,g,_,M,x;const z=[],K=[[],[],[]],F=[[],[],[]],C=[[],[],[]];let V=[0,0,0];const $=()=>{const P=0-t,le=[];for(let ae=0;ae<o;ae++){const u=ae/(o-1),fe=0-u*P,he=u*5*2*Math.PI,Me=90*(.8+.2*Math.sin(he*2)),h=new Ie(Me*Math.cos(he),Me*Math.sin(he),fe);(isNaN(h.x)||isNaN(h.y)||isNaN(h.z))&&console.error("NaN in chaserPath points",{t:u,z:fe,projectMaxZ:e}),le.push(h)}A=new Gn(le);const S=new ao().setFromPoints(A.getPoints(200));_=new Un(S,new Rt({color:16711935,linewidth:2,visible:!1})),p.add(_);const Z=[];for(let ae=0;ae<o;ae++){const u=ae/(o-1),fe=0-u*P,he=u*3*2*Math.PI,Me=60*(.8+.2*Math.sin(he*4)),h=new Ie(Me*Math.cos(he),Me*Math.sin(he),fe);(isNaN(h.x)||isNaN(h.y)||isNaN(h.z))&&console.error("NaN in chaserPath2 points",{t:u,z:fe,projectMaxZ:e}),Z.push(h)}T=new Gn(Z);const de=new ao().setFromPoints(T.getPoints(200));M=new Un(de,new Rt({color:65535,linewidth:2,visible:!1})),p.add(M);const ce=[];for(let ae=0;ae<o;ae++){const u=ae/(o-1),fe=0-u*P,he=u*7*2*Math.PI,Me=100,h=90,c=.1*Math.sin(he),i=new Ie(Me*(1+c)*Math.cos(he),h*(1-c)*Math.sin(he),fe);(isNaN(i.x)||isNaN(i.y)||isNaN(i.z))&&console.error("NaN in chaserPath3 points",{t:u,z:fe,projectMaxZ:e}),ce.push(i)}g=new Gn(ce);const re=new ao().setFromPoints(g.getPoints(200));x=new Un(re,new Rt({color:16776960,linewidth:2,visible:!1})),p.add(x);const k=[16711680,65280,255],O=new Ro(s,s,s);O.attributes.color&&delete O.attributes.color;for(let ae=0;ae<3;ae++){const u=new gt;u.opacity=1,u.renderOrder=1,z[ae]=u,p.add(u);for(let fe=0;fe<b;fe++){const he=new ut({color:k[ae],transparent:!0,opacity:0,blending:jr,fog:!0,depthWrite:!1}),Me=new Be(O,he);Me.renderOrder=1,Me.visible=!1,u.add(Me),K[ae][fe]=Me,F[ae][fe]=0,C[ae][fe]=!1}}},D=P=>{const le=[A,T,g][P],S=le.getLength(),Z=C[P].filter(ce=>ce).length;if(b-Z>=l){let ce=0;for(let re=0;re<l;re++){const k=C[P].findIndex(h=>!h);if(k===-1){console.warn(`No available chasers for path ${P}, emitted ${ce}/${l}`);break}const O=ce/(l-1),ae=.05+(1-.05)*Math.pow(O,3),u=new ut({color:[16711680,65280,255][P],transparent:!0,opacity:ae,blending:Zt,fog:!0,depthWrite:!1});K[P][k].material=u,K[P][k].visible=!0;const fe=ce*U;F[P][k]=fe,C[P][k]=!0;const he=fe/S,Me=le.getPointAt(he);K[P][k].position.copy(Me),ce++}}},q=P=>{const le=performance.now()/1e3,S=[A,T,g];for(let Z=0;Z<3;Z++){le-V[Z]>=R[Z]&&(D(Z),V[Z]=le);const de=S[Z],ce=de.getLength(),re=f*P;for(let k=0;k<b;k++)if(C[Z][k]){F[Z][k]+=re;const O=F[Z][k]/ce;if(O>=1)K[Z][k].visible=!1,C[Z][k]=!1,F[Z][k]=0;else{const ae=de.getPointAt(O);K[Z][k].position.copy(ae)}}}};return $(),{chaserPath:A,chaserPath2:T,chaserPath3:g,updateChasers:q,dispose:()=>{p.remove(_),p.remove(M),p.remove(x),_.geometry.dispose(),_.material.dispose(),M.geometry.dispose(),M.material.dispose(),x.geometry.dispose(),x.material.dispose(),z.forEach(P=>{P.children.forEach(le=>{le.geometry.dispose(),le.material.dispose()}),p.remove(P)})}}}class Li extends Xs{constructor(e){super(e)}load(e,n,t,o){const s=this,l=new js(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(f){const b=s.parse(JSON.parse(f));n&&n(b)},t,o)}parse(e){return new Bi(e)}}class Bi{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,n=100){const t=[],o=zi(e,n,this.data);for(let s=0,l=o.length;s<l;s++)t.push(...o[s].toShapes());return t}}function zi(p,e,n){const t=Array.from(p),o=e/n.resolution,s=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*o,l=[];let f=0,b=0;for(let R=0;R<t.length;R++){const U=t[R];if(U===`
`)f=0,b-=s;else{const A=Ni(U,o,f,b,n);f+=A.offsetX,l.push(A.path)}}return l}function Ni(p,e,n,t,o){const s=o.glyphs[p]||o.glyphs["?"];if(!s){console.error('THREE.Font: character "'+p+'" does not exists in font family '+o.familyName+".");return}const l=new no;let f,b,R,U,A,T,g,_;if(s.o){const M=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let x=0,z=M.length;x<z;)switch(M[x++]){case"m":f=M[x++]*e+n,b=M[x++]*e+t,l.moveTo(f,b);break;case"l":f=M[x++]*e+n,b=M[x++]*e+t,l.lineTo(f,b);break;case"q":R=M[x++]*e+n,U=M[x++]*e+t,A=M[x++]*e+n,T=M[x++]*e+t,l.quadraticCurveTo(A,T,R,U);break;case"b":R=M[x++]*e+n,U=M[x++]*e+t,A=M[x++]*e+n,T=M[x++]*e+t,g=M[x++]*e+n,_=M[x++]*e+t,l.bezierCurveTo(A,T,g,_,R,U);break}}return{offsetX:s.ha*e,path:l}}function Hi(p="/fonts/Poppins_Regular.json"){const e=Kt(null),n=Kt(0),t=Kt(!1),o=()=>new Promise((l,f)=>{new Li().load(p,R=>{e.value=R,n.value=100,t.value=!0,l(R)},R=>{R.lengthComputable&&(n.value=R.loaded/R.total*100)},R=>{n.value=100,t.value=!0,f(R)})});return{font:e,loadingProgress:n,isLoaded:t,initialize:()=>o()}}const Fi={class:"preloader"},Gi={class:"progress-label"},Ui=cs({__name:"Preloader",props:{progress:{}},setup(p){return(e,n)=>(Dn(),Us("div",Fi,[ho("div",Gi,Mr(Math.round(e.progress))+"%",1)]))}}),Wi=$s(Ui,[["__scopeId","data-v-e5eadefa"]]),Hs=250,vn=500,No=-500,$n=-520,Fs=-720,Gs=4e3,Yi=cs({__name:"HallwayEngine",props:{projects:{},projectGridFile:{},projectGridFile2:{},initialSlug:{}},setup(p){Oe.registerPlugin(Re);const e=p,n=Vs();n.projects=e.projects;const t=rn(),o={showChasers:!0,showStarfield:!0,showCars:!0,showBuildings:!0,showPortalPulses:!0,showKeyarts:!0,showProjectGrids:!0,showProjectTitles:!0,showIntroCubes:!0,showScrollTrigger:!0,showStats:!0},s=Kt(null),l=Kt(null),f=Kt(!1),b=Kt(0),R=Kt(!1),U=Kt(!0),A=new Map;let T,g,_,M,x,z,K,F=null,C=null,V=null,$=null,D=null,q=[],J=null,P=null,le=0,S=null,Z,de=null,ce=null,re=null;const k=Hi("/fonts/Poppins_Regular.json"),O=()=>{const h=s.value?s.value.getBoundingClientRect().width:window.innerWidth,c=window.innerHeight,i=t.isMobile?.75:1,r=t.isMobile?Math.min(window.devicePixelRatio,1.5):window.devicePixelRatio;_.setSize(h*i,c*i),_.setPixelRatio(r),M.setSize(h*i,c*i),g.aspect=h/c,g.updateProjectionMatrix(),_.domElement.style.width=`${h}px`,_.domElement.style.height=`${c}px`},ae=h=>A.has(h)?Promise.resolve(A.get(h)):new Promise((c,i)=>{new Kr().load(h,w=>{w.encoding=void 0,A.set(h,w),c(w)},void 0,w=>i(w))}),u=async()=>{T=new Vr,T.background=new Et(0),T.fog=new qr(0,700,Gs),g=new Zr(t.isMobile?95:75,window.innerWidth/window.innerHeight,1,Gs+6e3),g.position.set(0,0,0),g.lookAt(0,0,1e3),_=new $r({antialias:!0}),t.isMobile?_.setPixelRatio(Math.min(window.devicePixelRatio,1.5)):_.setPixelRatio(window.devicePixelRatio),_.toneMapping=Qr,_.toneMappingExposure=1,_.outputEncoding=void 0,M=new Pi(_);const h=new Ci(T,g);if(M.addPass(h),t.isMobile?x=new To(new Le(window.innerWidth,window.innerHeight),1,.1,0):x=new To(new Le(window.innerWidth,window.innerHeight),1.6,.2,0),x.renderToScreen=!0,M.addPass(x),s.value)s.value.appendChild(_.domElement),_.domElement.style.opacity="0";else return;z=new on,z.dom.style.position="fixed",z.dom.style.top="0px",z.dom.style.left="0px",z.dom.style.zIndex="1000",document.body.appendChild(z.dom);const i=e.projects.filter(E=>E.keyart).length+2+1;let r=0;const w=()=>{r++;const E=r/i*100,y=k.loadingProgress.value;b.value=(E+y/i)/(1+1/i),r===i&&k.isLoaded.value&&(f.value=!0)};await k.initialize().then(()=>{w()}).catch(E=>{console.error("Font initialization failed:",E),w()}),await ae(e.projectGridFile).then(()=>w()).catch(()=>w()),await ae(e.projectGridFile2).then(()=>w()).catch(()=>w());for(const E of e.projects)E.keyart?await ae(E.keyart).then(()=>w()).catch(()=>w()):w();S=ki(T,{CUBE_SIZE:Hs,CUBE_SPACING:vn,FIRST_CUBE_Z:No},e.projects,e.projectGridFile,e.projectGridFile2,o,A,k.font);try{if(await S.getInitializedData().then(({maxZ:E,updateCubeColors:y,projectCubes:L})=>{if(Z=E,Z===void 0||isNaN(Z))throw new Error("Invalid maxZ from projectCubesInstance");const{introCubes:Y}=Ai(T,k.font,{CUBE_SIZE:Hs,FIRST_CUBE_Z:No},o);q=[...Y,...L],J=y}),o.showCars){const{cityGroup:E,updateParticles:y,dispose:L}=Di(T,T,Z,o);K=y,D=L}if(o.showStarfield){const{dispose:E}=Ri(T,g,Z);F=E}if(o.showChasers){const{dispose:E,updateChasers:y}=Oi(T,Z);V=E,$=y}O()}catch(E){console.error("Error initializing project cubes:",E),Z=No-(e.projects.length+1)*vn}},fe=(h=0)=>{if(P=requestAnimationFrame(fe),_&&M){const c=(h-le)/1e3;le=h,K(c),$&&$(c),S!=null&&S.updateClickHereParticles&&S.updateClickHereParticles(g,c);const i=4e3,r=1e3,w=Math.abs(g.position.z-Z);g.far=Math.max(i+r,w),g.updateProjectionMatrix();const E=Fs-$n;let y=0;g.position.z>=$n?y=0:g.position.z<=Fs?y=1:y=(g.position.z-$n)/E,t.isMobile?x.strength=Ze.lerp(1.3,0,y):x.strength=Ze.lerp(1.6,.125,y),M.render()}z.update()},he=()=>{console.log("handleResize()"),O(),Re.refresh()},Me=()=>{if(t.isMobile){const h=t.orientation;console.log("Resize: orientation",h,"lastOrientation",ce),h!==ce&&(ce=h,re&&clearTimeout(re),re=setTimeout(()=>{he(),re=null},500))}else he()};return Pr(()=>{u().then(()=>{if(f.value){P=requestAnimationFrame(fe);let h=null;const c=S.getInitializedData().then(({projectCubes:r})=>{r.forEach(E=>{E.userData.isActive=!0});const w=No-(e.projects.length-1)*vn;if(g.position.set(0,0,5e3),g.lookAt(0,0,w),g.updateProjectionMatrix(),J(g),M.render(),Re.getAll().forEach(E=>E.kill()),q.length&&J){const E=Ii(T,g,l,q,J,{CUBE_SPACING:vn,FIRST_CUBE_Z:No},{scrub:t.isMobile?.5:1},o,z);h=E.setReverting,de=E.isScrollTriggerActive}_&&C===null&&(C=S.setupInteractivity(g,_.domElement,_,E=>{h&&h(E)},de)),window.scrollTo({top:0,behavior:"auto"})}),i=()=>{c.then(()=>{U.value=!1,g.position.set(0,0,5e3),g.updateProjectionMatrix(),Oe.to(_.domElement,{opacity:1,duration:.5,ease:"power4.out"});const r={z:5e3};Oe.to(r,{z:0,duration:2,ease:"power4.out",onUpdate:()=>{g.position.z=r.z,g.updateProjectionMatrix()},onComplete:()=>{g.position.z=0,R.value=!0}})})};Oe.delayedCall(.5,i)}}).catch(h=>{console.error("Initialization failed:",h)}),window.addEventListener("resize",Me)}),Cr(()=>{P!==null&&cancelAnimationFrame(P),C&&C(),window.removeEventListener("resize",Me),Re.getAll().forEach(h=>h.kill()),_.dispose(),M.dispose(),T.clear(),document.body.removeChild(z.dom),F&&F(),V&&V(),D&&D()}),(h,c)=>(Dn(),Us("section",{ref_key:"wrapper",ref:l,class:"wrapper"},[Ho(Er,{name:"fade"},{default:Ws(()=>[U.value?(Dn(),Ys(Wi,{key:0,progress:b.value},null,8,["progress"])):Sr("",!0)]),_:1}),ho("div",{ref_key:"tunnelWrapper",ref:s,class:"tunnel-wrapper"},null,512)],512))}}),Xi=$s(Yi,[["__scopeId","data-v-fef8b5ea"]]),ji={class:"relative bg-gray-50 text-black/50 dark:bg-black dark:text-white/50"},Vi={class:"absolute z-10 flex flex-col items-center justify-center top-32 left-1/2 transform -translate-x-1/2"},qi={class:"overflow-hidden"},Ji=cs({__name:"Welcome",props:{projects:{},projectGridFile:{},projectGridFile2:{}},setup(p){return(e,n)=>(Dn(),Ys(ti,null,{default:Ws(()=>[Ho(Ar(kr),{title:"Welcome"}),ho("div",ji,[ho("nav",Vi,[Ho(Jr)]),ho("div",qi,[Ho(Xi,{projects:e.projects,"project-grid-file":e.projectGridFile,"project-grid-file-2":e.projectGridFile2},null,8,["projects","project-grid-file","project-grid-file-2"])]),n[0]||(n[0]=ho("div",{class:"flex justify-center items-center"},null,-1)),n[1]||(n[1]=ho("div",{class:"flex justify-center items-center"},null,-1)),Ho(ei)])]),_:1}))}});export{Ji as default};
