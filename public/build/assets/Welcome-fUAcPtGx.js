import{W as Ir,d as eo,I as ps,e as ao,o as qt,a as Dt,t as Zs,x as Rr,y as Or,b as Wo,w as $s,c as Qs,f as Lr,T as zr,j as vs,u as Br,m as Nr,F as _s,h as Ts,n as Ms,g as Hr}from"./app-DshTtOvH.js";import{c as Ne,O as Fr,f as uo,F as Zo,k as wo,U as ts,V as Le,l as Sn,H as En,N as Gr,C as Ur,m as Ct,e as We,b as $t,n as rt,E as Wr,o as Ks,p as Js,q as Ao,r as Yr,s as Xr,t as jr,P as Wn,v as Vr,w as ro,G as Nt,x as qr,a as Ut,L as Rt,g as ze,y as Ve,B as No,z as $o,h as pt,u as er,R as Zr,I as $r,J as Qr,K as so,Q as tr,T as or,X as Ps,Y as Kr,Z as Jr,_ as Yn,$ as Cs,a0 as ei,a1 as Xn,a2 as jn,a3 as ti,S as oi,a4 as ni,a5 as si,W as ri,a6 as ii,a7 as ai,d as dn,i as li,j as ci}from"./GlobalFooter-DdVdrvF3.js";import{u as un,_ as ui}from"./App.vue_vue_type_script_setup_true_lang-DccEIqsl.js";import{_ as nr}from"./_plugin-vue_export-helper-DlAUqK2U.js";function fi(p,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(p,t.key,t)}}function pi(p,e,n){return e&&fi(p.prototype,e),p}/*!
 * Observer 3.12.7
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var gt,An,Ft,lo,co,Lo,sr,yo,Qo,rr,oo,Vt,ir,ar=function(){return gt||typeof window<"u"&&(gt=window.gsap)&&gt.registerPlugin&&gt},lr=1,Oo=[],Fe=[],Kt=[],Ko=Date.now,os=function(e,n){return n},di=function(){var e=Qo.core,n=e.bridge||{},t=e._scrollers,o=e._proxies;t.push.apply(t,Fe),o.push.apply(o,Kt),Fe=t,Kt=o,os=function(a,u){return n[a](u)}},fo=function(e,n){return~Kt.indexOf(e)&&Kt[Kt.indexOf(e)+1][n]},Jo=function(e){return!!~rr.indexOf(e)},Mt=function(e,n,t,o,s){return e.addEventListener(n,t,{passive:o!==!1,capture:!!s})},Tt=function(e,n,t,o){return e.removeEventListener(n,t,!!o)},hn="scrollLeft",gn="scrollTop",ns=function(){return oo&&oo.isPressed||Fe.cache++},zn=function(e,n){var t=function o(s){if(s||s===0){lr&&(Ft.history.scrollRestoration="manual");var a=oo&&oo.isPressed;s=o.v=Math.round(s)||(oo&&oo.iOS?1:0),e(s),o.cacheID=Fe.cache,a&&os("ss",s)}else(n||Fe.cache!==o.cacheID||os("ref"))&&(o.cacheID=Fe.cache,o.v=e());return o.v+o.offset};return t.offset=0,e&&t},At={s:hn,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:zn(function(p){return arguments.length?Ft.scrollTo(p,ft.sc()):Ft.pageXOffset||lo[hn]||co[hn]||Lo[hn]||0})},ft={s:gn,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:At,sc:zn(function(p){return arguments.length?Ft.scrollTo(At.sc(),p):Ft.pageYOffset||lo[gn]||co[gn]||Lo[gn]||0})},It=function(e,n){return(n&&n._ctx&&n._ctx.selector||gt.utils.toArray)(e)[0]||(typeof e=="string"&&gt.config().nullTargetWarn!==!1?console.warn("Element not found:",e):null)},po=function(e,n){var t=n.s,o=n.sc;Jo(e)&&(e=lo.scrollingElement||co);var s=Fe.indexOf(e),a=o===ft.sc?1:2;!~s&&(s=Fe.push(e)-1),Fe[s+a]||Mt(e,"scroll",ns);var u=Fe[s+a],w=u||(Fe[s+a]=zn(fo(e,t),!0)||(Jo(e)?o:zn(function(R){return arguments.length?e[t]=R:e[t]})));return w.target=e,u||(w.smooth=gt.getProperty(e,"scrollBehavior")==="smooth"),w},ss=function(e,n,t){var o=e,s=e,a=Ko(),u=a,w=n||50,R=Math.max(500,w*3),U=function(v,M){var x=Ko();M||x-a>w?(s=o,o=v,u=a,a=x):t?o+=v:o=s+(v-s)/(x-u)*(a-u)},A=function(){s=o=t?0:o,u=a=0},T=function(v){var M=u,x=s,H=Ko();return(v||v===0)&&v!==o&&U(v),a===u||H-u>R?0:(o+(t?x:-x))/((t?H:a)-M)*1e3};return{update:U,reset:A,getVelocity:T}},Fo=function(e,n){return n&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},Ss=function(e){var n=Math.max.apply(Math,e),t=Math.min.apply(Math,e);return Math.abs(n)>=Math.abs(t)?n:t},cr=function(){Qo=gt.core.globals().ScrollTrigger,Qo&&Qo.core&&di()},ur=function(e){return gt=e||ar(),!An&&gt&&typeof document<"u"&&document.body&&(Ft=window,lo=document,co=lo.documentElement,Lo=lo.body,rr=[Ft,lo,co,Lo],gt.utils.clamp,ir=gt.core.context||function(){},yo="onpointerenter"in Lo?"pointer":"mouse",sr=st.isTouch=Ft.matchMedia&&Ft.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in Ft||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,Vt=st.eventTypes=("ontouchstart"in co?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in co?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return lr=0},500),cr(),An=1),An};At.op=ft;Fe.cache=0;var st=function(){function p(n){this.init(n)}var e=p.prototype;return e.init=function(t){An||ur(gt)||console.warn("Please gsap.registerPlugin(Observer)"),Qo||cr();var o=t.tolerance,s=t.dragMinimum,a=t.type,u=t.target,w=t.lineHeight,R=t.debounce,U=t.preventDefault,A=t.onStop,T=t.onStopDelay,g=t.ignore,v=t.wheelSpeed,M=t.event,x=t.onDragStart,H=t.onDragEnd,Q=t.onDrag,F=t.onPress,C=t.onRelease,X=t.onRight,q=t.onLeft,I=t.onUp,j=t.onDown,K=t.onChangeX,P=t.onChangeY,ae=t.onChange,S=t.onToggleX,V=t.onToggleY,fe=t.onHover,le=t.onHoverEnd,oe=t.onMove,D=t.ignoreCheck,O=t.isNormalizer,re=t.onGestureStart,f=t.onGestureEnd,ce=t.onWheel,pe=t.onEnable,Te=t.onDisable,h=t.onClick,c=t.scrollSpeed,i=t.capture,r=t.allowClicks,b=t.lockAxis,E=t.onLockAxis;this.target=u=It(u)||co,this.vars=t,g&&(g=gt.utils.toArray(g)),o=o||1e-9,s=s||0,v=v||1,c=c||1,a=a||"wheel,touch,pointer",R=R!==!1,w||(w=parseFloat(Ft.getComputedStyle(Lo).lineHeight)||22);var y,L,Y,B,_,z,$,d=this,m=0,l=0,te=t.passive||!U&&t.passive!==!1,ue=po(u,At),Ue=po(u,ft),Xe=ue(),G=Ue(),ee=~a.indexOf("touch")&&!~a.indexOf("pointer")&&Vt[0]==="pointerdown",ye=Jo(u),ne=u.ownerDocument||lo,ge=[0,0,0],be=[0,0,0],Ce=0,se=function(){return Ce=Ko()},xe=function(J,Se){return(d.event=J)&&g&&~g.indexOf(J.target)||Se&&ee&&J.pointerType!=="touch"||D&&D(J,Se)},_e=function(){d._vx.reset(),d._vy.reset(),L.pause(),A&&A(d)},de=function(){var J=d.deltaX=Ss(ge),Se=d.deltaY=Ss(be),N=Math.abs(J)>=o,Z=Math.abs(Se)>=o;ae&&(N||Z)&&ae(d,J,Se,ge,be),N&&(X&&d.deltaX>0&&X(d),q&&d.deltaX<0&&q(d),K&&K(d),S&&d.deltaX<0!=m<0&&S(d),m=d.deltaX,ge[0]=ge[1]=ge[2]=0),Z&&(j&&d.deltaY>0&&j(d),I&&d.deltaY<0&&I(d),P&&P(d),V&&d.deltaY<0!=l<0&&V(d),l=d.deltaY,be[0]=be[1]=be[2]=0),(B||Y)&&(oe&&oe(d),Y&&(x&&Y===1&&x(d),Q&&Q(d),Y=0),B=!1),z&&!(z=!1)&&E&&E(d),_&&(ce(d),_=!1),y=0},Ae=function(J,Se,N){ge[N]+=J,be[N]+=Se,d._vx.update(J),d._vy.update(Se),R?y||(y=requestAnimationFrame(de)):de()},Ze=function(J,Se){b&&!$&&(d.axis=$=Math.abs(J)>Math.abs(Se)?"x":"y",z=!0),$!=="y"&&(ge[2]+=J,d._vx.update(J,!0)),$!=="x"&&(be[2]+=Se,d._vy.update(Se,!0)),R?y||(y=requestAnimationFrame(de)):de()},Re=function(J){if(!xe(J,1)){J=Fo(J,U);var Se=J.clientX,N=J.clientY,Z=Se-d.x,W=N-d.y,ie=d.isDragging;d.x=Se,d.y=N,(ie||(Z||W)&&(Math.abs(d.startX-Se)>=s||Math.abs(d.startY-N)>=s))&&(Y=ie?2:1,ie||(d.isDragging=!0),Ze(Z,W))}},at=d.onPress=function(k){xe(k,1)||k&&k.button||(d.axis=$=null,L.pause(),d.isPressed=!0,k=Fo(k),m=l=0,d.startX=d.x=k.clientX,d.startY=d.y=k.clientY,d._vx.reset(),d._vy.reset(),Mt(O?u:ne,Vt[1],Re,te,!0),d.deltaX=d.deltaY=0,F&&F(d))},Ie=d.onRelease=function(k){if(!xe(k,1)){Tt(O?u:ne,Vt[1],Re,!0);var J=!isNaN(d.y-d.startY),Se=d.isDragging,N=Se&&(Math.abs(d.x-d.startX)>3||Math.abs(d.y-d.startY)>3),Z=Fo(k);!N&&J&&(d._vx.reset(),d._vy.reset(),U&&r&&gt.delayedCall(.08,function(){if(Ko()-Ce>300&&!k.defaultPrevented){if(k.target.click)k.target.click();else if(ne.createEvent){var W=ne.createEvent("MouseEvents");W.initMouseEvent("click",!0,!0,Ft,1,Z.screenX,Z.screenY,Z.clientX,Z.clientY,!1,!1,!1,!1,0,null),k.target.dispatchEvent(W)}}})),d.isDragging=d.isGesturing=d.isPressed=!1,A&&Se&&!O&&L.restart(!0),Y&&de(),H&&Se&&H(d),C&&C(d,N)}},mt=function(J){return J.touches&&J.touches.length>1&&(d.isGesturing=!0)&&re(J,d.isDragging)},ot=function(){return(d.isGesturing=!1)||f(d)},ke=function(J){if(!xe(J)){var Se=ue(),N=Ue();Ae((Se-Xe)*c,(N-G)*c,1),Xe=Se,G=N,A&&L.restart(!0)}},qe=function(J){if(!xe(J)){J=Fo(J,U),ce&&(_=!0);var Se=(J.deltaMode===1?w:J.deltaMode===2?Ft.innerHeight:1)*v;Ae(J.deltaX*Se,J.deltaY*Se,0),A&&!O&&L.restart(!0)}},tt=function(J){if(!xe(J)){var Se=J.clientX,N=J.clientY,Z=Se-d.x,W=N-d.y;d.x=Se,d.y=N,B=!0,A&&L.restart(!0),(Z||W)&&Ze(Z,W)}},vt=function(J){d.event=J,fe(d)},Ge=function(J){d.event=J,le(d)},jt=function(J){return xe(J)||Fo(J,U)&&h(d)};L=d._dc=gt.delayedCall(T||.25,_e).pause(),d.deltaX=d.deltaY=0,d._vx=ss(0,50,!0),d._vy=ss(0,50,!0),d.scrollX=ue,d.scrollY=Ue,d.isDragging=d.isGesturing=d.isPressed=!1,ir(this),d.enable=function(k){return d.isEnabled||(Mt(ye?ne:u,"scroll",ns),a.indexOf("scroll")>=0&&Mt(ye?ne:u,"scroll",ke,te,i),a.indexOf("wheel")>=0&&Mt(u,"wheel",qe,te,i),(a.indexOf("touch")>=0&&sr||a.indexOf("pointer")>=0)&&(Mt(u,Vt[0],at,te,i),Mt(ne,Vt[2],Ie),Mt(ne,Vt[3],Ie),r&&Mt(u,"click",se,!0,!0),h&&Mt(u,"click",jt),re&&Mt(ne,"gesturestart",mt),f&&Mt(ne,"gestureend",ot),fe&&Mt(u,yo+"enter",vt),le&&Mt(u,yo+"leave",Ge),oe&&Mt(u,yo+"move",tt)),d.isEnabled=!0,d.isDragging=d.isGesturing=d.isPressed=B=Y=!1,d._vx.reset(),d._vy.reset(),Xe=ue(),G=Ue(),k&&k.type&&at(k),pe&&pe(d)),d},d.disable=function(){d.isEnabled&&(Oo.filter(function(k){return k!==d&&Jo(k.target)}).length||Tt(ye?ne:u,"scroll",ns),d.isPressed&&(d._vx.reset(),d._vy.reset(),Tt(O?u:ne,Vt[1],Re,!0)),Tt(ye?ne:u,"scroll",ke,i),Tt(u,"wheel",qe,i),Tt(u,Vt[0],at,i),Tt(ne,Vt[2],Ie),Tt(ne,Vt[3],Ie),Tt(u,"click",se,!0),Tt(u,"click",jt),Tt(ne,"gesturestart",mt),Tt(ne,"gestureend",ot),Tt(u,yo+"enter",vt),Tt(u,yo+"leave",Ge),Tt(u,yo+"move",tt),d.isEnabled=d.isPressed=d.isDragging=!1,Te&&Te(d))},d.kill=d.revert=function(){d.disable();var k=Oo.indexOf(d);k>=0&&Oo.splice(k,1),oo===d&&(oo=0)},Oo.push(d),O&&Jo(u)&&(oo=d),d.enable(M)},pi(p,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),p}();st.version="3.12.7";st.create=function(p){return new st(p)};st.register=ur;st.getAll=function(){return Oo.slice()};st.getById=function(p){return Oo.filter(function(e){return e.vars.id===p})[0]};ar()&&gt.registerPlugin(st);/*!
 * ScrollTrigger 3.12.7
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var me,Io,He,et,Ht,je,ds,Bn,ln,en,Yo,mn,xt,Un,rs,St,Es,As,Ro,fr,Vn,pr,Pt,is,dr,hr,io,as,hs,zo,gs,Nn,ls,qn,yn=1,wt=Date.now,Zn=wt(),Xt=0,Xo=0,ks=function(e,n,t){var o=Bt(e)&&(e.substr(0,6)==="clamp("||e.indexOf("max")>-1);return t["_"+n+"Clamp"]=o,o?e.substr(6,e.length-7):e},Ds=function(e,n){return n&&(!Bt(e)||e.substr(0,6)!=="clamp(")?"clamp("+e+")":e},hi=function p(){return Xo&&requestAnimationFrame(p)},Is=function(){return Un=1},Rs=function(){return Un=0},Zt=function(e){return e},jo=function(e){return Math.round(e*1e5)/1e5||0},gr=function(){return typeof window<"u"},mr=function(){return me||gr()&&(me=window.gsap)&&me.registerPlugin&&me},Mo=function(e){return!!~ds.indexOf(e)},yr=function(e){return(e==="Height"?gs:He["inner"+e])||Ht["client"+e]||je["client"+e]},xr=function(e){return fo(e,"getBoundingClientRect")||(Mo(e)?function(){return On.width=He.innerWidth,On.height=gs,On}:function(){return to(e)})},gi=function(e,n,t){var o=t.d,s=t.d2,a=t.a;return(a=fo(e,"getBoundingClientRect"))?function(){return a()[o]}:function(){return(n?yr(s):e["client"+s])||0}},mi=function(e,n){return!n||~Kt.indexOf(e)?xr(e):function(){return On}},Qt=function(e,n){var t=n.s,o=n.d2,s=n.d,a=n.a;return Math.max(0,(t="scroll"+o)&&(a=fo(e,t))?a()-xr(e)()[s]:Mo(e)?(Ht[t]||je[t])-yr(o):e[t]-e["offset"+o])},xn=function(e,n){for(var t=0;t<Ro.length;t+=3)(!n||~n.indexOf(Ro[t+1]))&&e(Ro[t],Ro[t+1],Ro[t+2])},Bt=function(e){return typeof e=="string"},bt=function(e){return typeof e=="function"},Vo=function(e){return typeof e=="number"},xo=function(e){return typeof e=="object"},Go=function(e,n,t){return e&&e.progress(n?0:1)&&t&&e.pause()},$n=function(e,n){if(e.enabled){var t=e._ctx?e._ctx.add(function(){return n(e)}):n(e);t&&t.totalTime&&(e.callbackAnimation=t)}},ko=Math.abs,wr="left",br="top",ms="right",ys="bottom",vo="width",_o="height",tn="Right",on="Left",nn="Top",sn="Bottom",it="padding",Wt="margin",Ho="Width",xs="Height",ut="px",Yt=function(e){return He.getComputedStyle(e)},yi=function(e){var n=Yt(e).position;e.style.position=n==="absolute"||n==="fixed"?n:"relative"},Os=function(e,n){for(var t in n)t in e||(e[t]=n[t]);return e},to=function(e,n){var t=n&&Yt(e)[rs]!=="matrix(1, 0, 0, 1, 0, 0)"&&me.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),o=e.getBoundingClientRect();return t&&t.progress(0).kill(),o},Hn=function(e,n){var t=n.d2;return e["offset"+t]||e["client"+t]||0},vr=function(e){var n=[],t=e.labels,o=e.duration(),s;for(s in t)n.push(t[s]/o);return n},xi=function(e){return function(n){return me.utils.snap(vr(e),n)}},ws=function(e){var n=me.utils.snap(e),t=Array.isArray(e)&&e.slice(0).sort(function(o,s){return o-s});return t?function(o,s,a){a===void 0&&(a=.001);var u;if(!s)return n(o);if(s>0){for(o-=a,u=0;u<t.length;u++)if(t[u]>=o)return t[u];return t[u-1]}else for(u=t.length,o+=a;u--;)if(t[u]<=o)return t[u];return t[0]}:function(o,s,a){a===void 0&&(a=.001);var u=n(o);return!s||Math.abs(u-o)<a||u-o<0==s<0?u:n(s<0?o-e:o+e)}},wi=function(e){return function(n,t){return ws(vr(e))(n,t.direction)}},wn=function(e,n,t,o){return t.split(",").forEach(function(s){return e(n,s,o)})},ht=function(e,n,t,o,s){return e.addEventListener(n,t,{passive:!o,capture:!!s})},dt=function(e,n,t,o){return e.removeEventListener(n,t,!!o)},bn=function(e,n,t){t=t&&t.wheelHandler,t&&(e(n,"wheel",t),e(n,"touchmove",t))},Ls={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},vn={toggleActions:"play",anticipatePin:0},Fn={top:0,left:0,center:.5,bottom:1,right:1},kn=function(e,n){if(Bt(e)){var t=e.indexOf("="),o=~t?+(e.charAt(t-1)+1)*parseFloat(e.substr(t+1)):0;~t&&(e.indexOf("%")>t&&(o*=n/100),e=e.substr(0,t-1)),e=o+(e in Fn?Fn[e]*n:~e.indexOf("%")?parseFloat(e)*n/100:parseFloat(e)||0)}return e},_n=function(e,n,t,o,s,a,u,w){var R=s.startColor,U=s.endColor,A=s.fontSize,T=s.indent,g=s.fontWeight,v=et.createElement("div"),M=Mo(t)||fo(t,"pinType")==="fixed",x=e.indexOf("scroller")!==-1,H=M?je:t,Q=e.indexOf("start")!==-1,F=Q?R:U,C="border-color:"+F+";font-size:"+A+";color:"+F+";font-weight:"+g+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return C+="position:"+((x||w)&&M?"fixed;":"absolute;"),(x||w||!M)&&(C+=(o===ft?ms:ys)+":"+(a+parseFloat(T))+"px;"),u&&(C+="box-sizing:border-box;text-align:left;width:"+u.offsetWidth+"px;"),v._isStart=Q,v.setAttribute("class","gsap-marker-"+e+(n?" marker-"+n:"")),v.style.cssText=C,v.innerText=n||n===0?e+"-"+n:e,H.children[0]?H.insertBefore(v,H.children[0]):H.appendChild(v),v._offset=v["offset"+o.op.d2],Dn(v,0,o,Q),v},Dn=function(e,n,t,o){var s={display:"block"},a=t[o?"os2":"p2"],u=t[o?"p2":"os2"];e._isFlipped=o,s[t.a+"Percent"]=o?-100:0,s[t.a]=o?"1px":0,s["border"+a+Ho]=1,s["border"+u+Ho]=0,s[t.p]=n+"px",me.set(e,s)},Be=[],cs={},cn,zs=function(){return wt()-Xt>34&&(cn||(cn=requestAnimationFrame(no)))},Do=function(){(!Pt||!Pt.isPressed||Pt.startX>je.clientWidth)&&(Fe.cache++,Pt?cn||(cn=requestAnimationFrame(no)):no(),Xt||Co("scrollStart"),Xt=wt())},Qn=function(){hr=He.innerWidth,dr=He.innerHeight},qo=function(e){Fe.cache++,(e===!0||!xt&&!pr&&!et.fullscreenElement&&!et.webkitFullscreenElement&&(!is||hr!==He.innerWidth||Math.abs(He.innerHeight-dr)>He.innerHeight*.25))&&Bn.restart(!0)},Po={},bi=[],_r=function p(){return dt(Oe,"scrollEnd",p)||bo(!0)},Co=function(e){return Po[e]&&Po[e].map(function(n){return n()})||bi},zt=[],Tr=function(e){for(var n=0;n<zt.length;n+=5)(!e||zt[n+4]&&zt[n+4].query===e)&&(zt[n].style.cssText=zt[n+1],zt[n].getBBox&&zt[n].setAttribute("transform",zt[n+2]||""),zt[n+3].uncache=1)},bs=function(e,n){var t;for(St=0;St<Be.length;St++)t=Be[St],t&&(!n||t._ctx===n)&&(e?t.kill(1):t.revert(!0,!0));Nn=!0,n&&Tr(n),n||Co("revert")},Mr=function(e,n){Fe.cache++,(n||!Et)&&Fe.forEach(function(t){return bt(t)&&t.cacheID++&&(t.rec=0)}),Bt(e)&&(He.history.scrollRestoration=hs=e)},Et,To=0,Bs,vi=function(){if(Bs!==To){var e=Bs=To;requestAnimationFrame(function(){return e===To&&bo(!0)})}},Pr=function(){je.appendChild(zo),gs=!Pt&&zo.offsetHeight||He.innerHeight,je.removeChild(zo)},Ns=function(e){return ln(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(n){return n.style.display=e?"none":"block"})},bo=function(e,n){if(Ht=et.documentElement,je=et.body,ds=[He,et,Ht,je],Xt&&!e&&!Nn){ht(Oe,"scrollEnd",_r);return}Pr(),Et=Oe.isRefreshing=!0,Fe.forEach(function(o){return bt(o)&&++o.cacheID&&(o.rec=o())});var t=Co("refreshInit");fr&&Oe.sort(),n||bs(),Fe.forEach(function(o){bt(o)&&(o.smooth&&(o.target.style.scrollBehavior="auto"),o(0))}),Be.slice(0).forEach(function(o){return o.refresh()}),Nn=!1,Be.forEach(function(o){if(o._subPinOffset&&o.pin){var s=o.vars.horizontal?"offsetWidth":"offsetHeight",a=o.pin[s];o.revert(!0,1),o.adjustPinSpacing(o.pin[s]-a),o.refresh()}}),ls=1,Ns(!0),Be.forEach(function(o){var s=Qt(o.scroller,o._dir),a=o.vars.end==="max"||o._endClamp&&o.end>s,u=o._startClamp&&o.start>=s;(a||u)&&o.setPositions(u?s-1:o.start,a?Math.max(u?s:o.start+1,s):o.end,!0)}),Ns(!1),ls=0,t.forEach(function(o){return o&&o.render&&o.render(-1)}),Fe.forEach(function(o){bt(o)&&(o.smooth&&requestAnimationFrame(function(){return o.target.style.scrollBehavior="smooth"}),o.rec&&o(o.rec))}),Mr(hs,1),Bn.pause(),To++,Et=2,no(2),Be.forEach(function(o){return bt(o.vars.onRefresh)&&o.vars.onRefresh(o)}),Et=Oe.isRefreshing=!1,Co("refresh")},us=0,In=1,rn,no=function(e){if(e===2||!Et&&!Nn){Oe.isUpdating=!0,rn&&rn.update(0);var n=Be.length,t=wt(),o=t-Zn>=50,s=n&&Be[0].scroll();if(In=us>s?-1:1,Et||(us=s),o&&(Xt&&!Un&&t-Xt>200&&(Xt=0,Co("scrollEnd")),Yo=Zn,Zn=t),In<0){for(St=n;St-- >0;)Be[St]&&Be[St].update(0,o);In=1}else for(St=0;St<n;St++)Be[St]&&Be[St].update(0,o);Oe.isUpdating=!1}cn=0},fs=[wr,br,ys,ms,Wt+sn,Wt+tn,Wt+nn,Wt+on,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],Rn=fs.concat([vo,_o,"boxSizing","max"+Ho,"max"+xs,"position",Wt,it,it+nn,it+tn,it+sn,it+on]),_i=function(e,n,t){Bo(t);var o=e._gsap;if(o.spacerIsNative)Bo(o.spacerState);else if(e._gsap.swappedIn){var s=n.parentNode;s&&(s.insertBefore(e,n),s.removeChild(n))}e._gsap.swappedIn=!1},Kn=function(e,n,t,o){if(!e._gsap.swappedIn){for(var s=fs.length,a=n.style,u=e.style,w;s--;)w=fs[s],a[w]=t[w];a.position=t.position==="absolute"?"absolute":"relative",t.display==="inline"&&(a.display="inline-block"),u[ys]=u[ms]="auto",a.flexBasis=t.flexBasis||"auto",a.overflow="visible",a.boxSizing="border-box",a[vo]=Hn(e,At)+ut,a[_o]=Hn(e,ft)+ut,a[it]=u[Wt]=u[br]=u[wr]="0",Bo(o),u[vo]=u["max"+Ho]=t[vo],u[_o]=u["max"+xs]=t[_o],u[it]=t[it],e.parentNode!==n&&(e.parentNode.insertBefore(n,e),n.appendChild(e)),e._gsap.swappedIn=!0}},Ti=/([A-Z])/g,Bo=function(e){if(e){var n=e.t.style,t=e.length,o=0,s,a;for((e.t._gsap||me.core.getCache(e.t)).uncache=1;o<t;o+=2)a=e[o+1],s=e[o],a?n[s]=a:n[s]&&n.removeProperty(s.replace(Ti,"-$1").toLowerCase())}},Tn=function(e){for(var n=Rn.length,t=e.style,o=[],s=0;s<n;s++)o.push(Rn[s],t[Rn[s]]);return o.t=e,o},Mi=function(e,n,t){for(var o=[],s=e.length,a=t?8:0,u;a<s;a+=2)u=e[a],o.push(u,u in n?n[u]:e[a+1]);return o.t=e.t,o},On={left:0,top:0},Hs=function(e,n,t,o,s,a,u,w,R,U,A,T,g,v){bt(e)&&(e=e(w)),Bt(e)&&e.substr(0,3)==="max"&&(e=T+(e.charAt(4)==="="?kn("0"+e.substr(3),t):0));var M=g?g.time():0,x,H,Q;if(g&&g.seek(0),isNaN(e)||(e=+e),Vo(e))g&&(e=me.utils.mapRange(g.scrollTrigger.start,g.scrollTrigger.end,0,T,e)),u&&Dn(u,t,o,!0);else{bt(n)&&(n=n(w));var F=(e||"0").split(" "),C,X,q,I;Q=It(n,w)||je,C=to(Q)||{},(!C||!C.left&&!C.top)&&Yt(Q).display==="none"&&(I=Q.style.display,Q.style.display="block",C=to(Q),I?Q.style.display=I:Q.style.removeProperty("display")),X=kn(F[0],C[o.d]),q=kn(F[1]||"0",t),e=C[o.p]-R[o.p]-U+X+s-q,u&&Dn(u,q,o,t-q<20||u._isStart&&q>20),t-=t-q}if(v&&(w[v]=e||-.001,e<0&&(e=0)),a){var j=e+t,K=a._isStart;x="scroll"+o.d2,Dn(a,j,o,K&&j>20||!K&&(A?Math.max(je[x],Ht[x]):a.parentNode[x])<=j+1),A&&(R=to(u),A&&(a.style[o.op.p]=R[o.op.p]-o.op.m-a._offset+ut))}return g&&Q&&(x=to(Q),g.seek(T),H=to(Q),g._caScrollDist=x[o.p]-H[o.p],e=e/g._caScrollDist*T),g&&g.seek(M),g?e:Math.round(e)},Pi=/(webkit|moz|length|cssText|inset)/i,Fs=function(e,n,t,o){if(e.parentNode!==n){var s=e.style,a,u;if(n===je){e._stOrig=s.cssText,u=Yt(e);for(a in u)!+a&&!Pi.test(a)&&u[a]&&typeof s[a]=="string"&&a!=="0"&&(s[a]=u[a]);s.top=t,s.left=o}else s.cssText=e._stOrig;me.core.getCache(e).uncache=1,n.appendChild(e)}},Cr=function(e,n,t){var o=n,s=o;return function(a){var u=Math.round(e());return u!==o&&u!==s&&Math.abs(u-o)>3&&Math.abs(u-s)>3&&(a=u,t&&t()),s=o,o=Math.round(a),o}},Mn=function(e,n,t){var o={};o[n.p]="+="+t,me.set(e,o)},Gs=function(e,n){var t=po(e,n),o="_scroll"+n.p2,s=function a(u,w,R,U,A){var T=a.tween,g=w.onComplete,v={};R=R||t();var M=Cr(t,R,function(){T.kill(),a.tween=0});return A=U&&A||0,U=U||u-R,T&&T.kill(),w[o]=u,w.inherit=!1,w.modifiers=v,v[o]=function(){return M(R+U*T.ratio+A*T.ratio*T.ratio)},w.onUpdate=function(){Fe.cache++,a.tween&&no()},w.onComplete=function(){a.tween=0,g&&g.call(T)},T=a.tween=me.to(e,w),T};return e[o]=t,t.wheelHandler=function(){return s.tween&&s.tween.kill()&&(s.tween=0)},ht(e,"wheel",t.wheelHandler),Oe.isTouch&&ht(e,"touchmove",t.wheelHandler),s},Oe=function(){function p(n,t){Io||p.register(me)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),as(this),this.init(n,t)}var e=p.prototype;return e.init=function(t,o){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!Xo){this.update=this.refresh=this.kill=Zt;return}t=Os(Bt(t)||Vo(t)||t.nodeType?{trigger:t}:t,vn);var s=t,a=s.onUpdate,u=s.toggleClass,w=s.id,R=s.onToggle,U=s.onRefresh,A=s.scrub,T=s.trigger,g=s.pin,v=s.pinSpacing,M=s.invalidateOnRefresh,x=s.anticipatePin,H=s.onScrubComplete,Q=s.onSnapComplete,F=s.once,C=s.snap,X=s.pinReparent,q=s.pinSpacer,I=s.containerAnimation,j=s.fastScrollEnd,K=s.preventOverlaps,P=t.horizontal||t.containerAnimation&&t.horizontal!==!1?At:ft,ae=!A&&A!==0,S=It(t.scroller||He),V=me.core.getCache(S),fe=Mo(S),le=("pinType"in t?t.pinType:fo(S,"pinType")||fe&&"fixed")==="fixed",oe=[t.onEnter,t.onLeave,t.onEnterBack,t.onLeaveBack],D=ae&&t.toggleActions.split(" "),O="markers"in t?t.markers:vn.markers,re=fe?0:parseFloat(Yt(S)["border"+P.p2+Ho])||0,f=this,ce=t.onRefreshInit&&function(){return t.onRefreshInit(f)},pe=gi(S,fe,P),Te=mi(S,fe),h=0,c=0,i=0,r=po(S,P),b,E,y,L,Y,B,_,z,$,d,m,l,te,ue,Ue,Xe,G,ee,ye,ne,ge,be,Ce,se,xe,_e,de,Ae,Ze,Re,at,Ie,mt,ot,ke,qe,tt,vt,Ge;if(f._startClamp=f._endClamp=!1,f._dir=P,x*=45,f.scroller=S,f.scroll=I?I.time.bind(I):r,L=r(),f.vars=t,o=o||t.animation,"refreshPriority"in t&&(fr=1,t.refreshPriority===-9999&&(rn=f)),V.tweenScroll=V.tweenScroll||{top:Gs(S,ft),left:Gs(S,At)},f.tweenTo=b=V.tweenScroll[P.p],f.scrubDuration=function(N){mt=Vo(N)&&N,mt?Ie?Ie.duration(N):Ie=me.to(o,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:mt,paused:!0,onComplete:function(){return H&&H(f)}}):(Ie&&Ie.progress(1).kill(),Ie=0)},o&&(o.vars.lazy=!1,o._initted&&!f.isReverted||o.vars.immediateRender!==!1&&t.immediateRender!==!1&&o.duration()&&o.render(0,!0,!0),f.animation=o.pause(),o.scrollTrigger=f,f.scrubDuration(A),Re=0,w||(w=o.vars.id)),C&&((!xo(C)||C.push)&&(C={snapTo:C}),"scrollBehavior"in je.style&&me.set(fe?[je,Ht]:S,{scrollBehavior:"auto"}),Fe.forEach(function(N){return bt(N)&&N.target===(fe?et.scrollingElement||Ht:S)&&(N.smooth=!1)}),y=bt(C.snapTo)?C.snapTo:C.snapTo==="labels"?xi(o):C.snapTo==="labelsDirectional"?wi(o):C.directional!==!1?function(N,Z){return ws(C.snapTo)(N,wt()-c<500?0:Z.direction)}:me.utils.snap(C.snapTo),ot=C.duration||{min:.1,max:2},ot=xo(ot)?en(ot.min,ot.max):en(ot,ot),ke=me.delayedCall(C.delay||mt/2||.1,function(){var N=r(),Z=wt()-c<500,W=b.tween;if((Z||Math.abs(f.getVelocity())<10)&&!W&&!Un&&h!==N){var ie=(N-B)/ue,we=o&&!ae?o.totalProgress():ie,he=Z?0:(we-at)/(wt()-Yo)*1e3||0,ve=me.utils.clamp(-ie,1-ie,ko(he/2)*he/.185),De=ie+(C.inertia===!1?0:ve),Pe,Me,Ee=C,$e=Ee.onStart,Je=Ee.onInterrupt,yt=Ee.onComplete;if(Pe=y(De,f),Vo(Pe)||(Pe=De),Me=Math.max(0,Math.round(B+Pe*ue)),N<=_&&N>=B&&Me!==N){if(W&&!W._initted&&W.data<=ko(Me-N))return;C.inertia===!1&&(ve=Pe-ie),b(Me,{duration:ot(ko(Math.max(ko(De-we),ko(Pe-we))*.185/he/.05||0)),ease:C.ease||"power3",data:ko(Me-N),onInterrupt:function(){return ke.restart(!0)&&Je&&Je(f)},onComplete:function(){f.update(),h=r(),o&&!ae&&(Ie?Ie.resetTo("totalProgress",Pe,o._tTime/o._tDur):o.progress(Pe)),Re=at=o&&!ae?o.totalProgress():f.progress,Q&&Q(f),yt&&yt(f)}},N,ve*ue,Me-N-ve*ue),$e&&$e(f,b.tween)}}else f.isActive&&h!==N&&ke.restart(!0)}).pause()),w&&(cs[w]=f),T=f.trigger=It(T||g!==!0&&g),Ge=T&&T._gsap&&T._gsap.stRevert,Ge&&(Ge=Ge(f)),g=g===!0?T:It(g),Bt(u)&&(u={targets:T,className:u}),g&&(v===!1||v===Wt||(v=!v&&g.parentNode&&g.parentNode.style&&Yt(g.parentNode).display==="flex"?!1:it),f.pin=g,E=me.core.getCache(g),E.spacer?Ue=E.pinState:(q&&(q=It(q),q&&!q.nodeType&&(q=q.current||q.nativeElement),E.spacerIsNative=!!q,q&&(E.spacerState=Tn(q))),E.spacer=ee=q||et.createElement("div"),ee.classList.add("pin-spacer"),w&&ee.classList.add("pin-spacer-"+w),E.pinState=Ue=Tn(g)),t.force3D!==!1&&me.set(g,{force3D:!0}),f.spacer=ee=E.spacer,Ze=Yt(g),se=Ze[v+P.os2],ne=me.getProperty(g),ge=me.quickSetter(g,P.a,ut),Kn(g,ee,Ze),G=Tn(g)),O){l=xo(O)?Os(O,Ls):Ls,d=_n("scroller-start",w,S,P,l,0),m=_n("scroller-end",w,S,P,l,0,d),ye=d["offset"+P.op.d2];var jt=It(fo(S,"content")||S);z=this.markerStart=_n("start",w,jt,P,l,ye,0,I),$=this.markerEnd=_n("end",w,jt,P,l,ye,0,I),I&&(vt=me.quickSetter([z,$],P.a,ut)),!le&&!(Kt.length&&fo(S,"fixedMarkers")===!0)&&(yi(fe?je:S),me.set([d,m],{force3D:!0}),_e=me.quickSetter(d,P.a,ut),Ae=me.quickSetter(m,P.a,ut))}if(I){var k=I.vars.onUpdate,J=I.vars.onUpdateParams;I.eventCallback("onUpdate",function(){f.update(0,0,1),k&&k.apply(I,J||[])})}if(f.previous=function(){return Be[Be.indexOf(f)-1]},f.next=function(){return Be[Be.indexOf(f)+1]},f.revert=function(N,Z){if(!Z)return f.kill(!0);var W=N!==!1||!f.enabled,ie=xt;W!==f.isReverted&&(W&&(qe=Math.max(r(),f.scroll.rec||0),i=f.progress,tt=o&&o.progress()),z&&[z,$,d,m].forEach(function(we){return we.style.display=W?"none":"block"}),W&&(xt=f,f.update(W)),g&&(!X||!f.isActive)&&(W?_i(g,ee,Ue):Kn(g,ee,Yt(g),xe)),W||f.update(W),xt=ie,f.isReverted=W)},f.refresh=function(N,Z,W,ie){if(!((xt||!f.enabled)&&!Z)){if(g&&N&&Xt){ht(p,"scrollEnd",_r);return}!Et&&ce&&ce(f),xt=f,b.tween&&!W&&(b.tween.kill(),b.tween=0),Ie&&Ie.pause(),M&&o&&o.revert({kill:!1}).invalidate(),f.isReverted||f.revert(!0,!0),f._subPinOffset=!1;var we=pe(),he=Te(),ve=I?I.duration():Qt(S,P),De=ue<=.01,Pe=0,Me=ie||0,Ee=xo(W)?W.end:t.end,$e=t.endTrigger||T,Je=xo(W)?W.start:t.start||(t.start===0||!T?0:g?"0 0":"0 100%"),yt=f.pinnedContainer=t.pinnedContainer&&It(t.pinnedContainer,f),Ot=T&&Math.max(0,Be.indexOf(f))||0,lt=Ot,ct,nt,Qe,Lt,Ke,Ye,_t,kt,pn,ho,Gt,go,Eo;for(O&&xo(W)&&(go=me.getProperty(d,P.p),Eo=me.getProperty(m,P.p));lt-- >0;)Ye=Be[lt],Ye.end||Ye.refresh(0,1)||(xt=f),_t=Ye.pin,_t&&(_t===T||_t===g||_t===yt)&&!Ye.isReverted&&(ho||(ho=[]),ho.unshift(Ye),Ye.revert(!0,!0)),Ye!==Be[lt]&&(Ot--,lt--);for(bt(Je)&&(Je=Je(f)),Je=ks(Je,"start",f),B=Hs(Je,T,we,P,r(),z,d,f,he,re,le,ve,I,f._startClamp&&"_startClamp")||(g?-.001:0),bt(Ee)&&(Ee=Ee(f)),Bt(Ee)&&!Ee.indexOf("+=")&&(~Ee.indexOf(" ")?Ee=(Bt(Je)?Je.split(" ")[0]:"")+Ee:(Pe=kn(Ee.substr(2),we),Ee=Bt(Je)?Je:(I?me.utils.mapRange(0,I.duration(),I.scrollTrigger.start,I.scrollTrigger.end,B):B)+Pe,$e=T)),Ee=ks(Ee,"end",f),_=Math.max(B,Hs(Ee||($e?"100% 0":ve),$e,we,P,r()+Pe,$,m,f,he,re,le,ve,I,f._endClamp&&"_endClamp"))||-.001,Pe=0,lt=Ot;lt--;)Ye=Be[lt],_t=Ye.pin,_t&&Ye.start-Ye._pinPush<=B&&!I&&Ye.end>0&&(ct=Ye.end-(f._startClamp?Math.max(0,Ye.start):Ye.start),(_t===T&&Ye.start-Ye._pinPush<B||_t===yt)&&isNaN(Je)&&(Pe+=ct*(1-Ye.progress)),_t===g&&(Me+=ct));if(B+=Pe,_+=Pe,f._startClamp&&(f._startClamp+=Pe),f._endClamp&&!Et&&(f._endClamp=_||-.001,_=Math.min(_,Qt(S,P))),ue=_-B||(B-=.01)&&.001,De&&(i=me.utils.clamp(0,1,me.utils.normalize(B,_,qe))),f._pinPush=Me,z&&Pe&&(ct={},ct[P.a]="+="+Pe,yt&&(ct[P.p]="-="+r()),me.set([z,$],ct)),g&&!(ls&&f.end>=Qt(S,P)))ct=Yt(g),Lt=P===ft,Qe=r(),be=parseFloat(ne(P.a))+Me,!ve&&_>1&&(Gt=(fe?et.scrollingElement||Ht:S).style,Gt={style:Gt,value:Gt["overflow"+P.a.toUpperCase()]},fe&&Yt(je)["overflow"+P.a.toUpperCase()]!=="scroll"&&(Gt.style["overflow"+P.a.toUpperCase()]="scroll")),Kn(g,ee,ct),G=Tn(g),nt=to(g,!0),kt=le&&po(S,Lt?At:ft)(),v?(xe=[v+P.os2,ue+Me+ut],xe.t=ee,lt=v===it?Hn(g,P)+ue+Me:0,lt&&(xe.push(P.d,lt+ut),ee.style.flexBasis!=="auto"&&(ee.style.flexBasis=lt+ut)),Bo(xe),yt&&Be.forEach(function(Jt){Jt.pin===yt&&Jt.vars.pinSpacing!==!1&&(Jt._subPinOffset=!0)}),le&&r(qe)):(lt=Hn(g,P),lt&&ee.style.flexBasis!=="auto"&&(ee.style.flexBasis=lt+ut)),le&&(Ke={top:nt.top+(Lt?Qe-B:kt)+ut,left:nt.left+(Lt?kt:Qe-B)+ut,boxSizing:"border-box",position:"fixed"},Ke[vo]=Ke["max"+Ho]=Math.ceil(nt.width)+ut,Ke[_o]=Ke["max"+xs]=Math.ceil(nt.height)+ut,Ke[Wt]=Ke[Wt+nn]=Ke[Wt+tn]=Ke[Wt+sn]=Ke[Wt+on]="0",Ke[it]=ct[it],Ke[it+nn]=ct[it+nn],Ke[it+tn]=ct[it+tn],Ke[it+sn]=ct[it+sn],Ke[it+on]=ct[it+on],Xe=Mi(Ue,Ke,X),Et&&r(0)),o?(pn=o._initted,Vn(1),o.render(o.duration(),!0,!0),Ce=ne(P.a)-be+ue+Me,de=Math.abs(ue-Ce)>1,le&&de&&Xe.splice(Xe.length-2,2),o.render(0,!0,!0),pn||o.invalidate(!0),o.parent||o.totalTime(o.totalTime()),Vn(0)):Ce=ue,Gt&&(Gt.value?Gt.style["overflow"+P.a.toUpperCase()]=Gt.value:Gt.style.removeProperty("overflow-"+P.a));else if(T&&r()&&!I)for(nt=T.parentNode;nt&&nt!==je;)nt._pinOffset&&(B-=nt._pinOffset,_-=nt._pinOffset),nt=nt.parentNode;ho&&ho.forEach(function(Jt){return Jt.revert(!1,!0)}),f.start=B,f.end=_,L=Y=Et?qe:r(),!I&&!Et&&(L<qe&&r(qe),f.scroll.rec=0),f.revert(!1,!0),c=wt(),ke&&(h=-1,ke.restart(!0)),xt=0,o&&ae&&(o._initted||tt)&&o.progress()!==tt&&o.progress(tt||0,!0).render(o.time(),!0,!0),(De||i!==f.progress||I||M||o&&!o._initted)&&(o&&!ae&&o.totalProgress(I&&B<-.001&&!i?me.utils.normalize(B,_,0):i,!0),f.progress=De||(L-B)/ue===i?0:i),g&&v&&(ee._pinOffset=Math.round(f.progress*Ce)),Ie&&Ie.invalidate(),isNaN(go)||(go-=me.getProperty(d,P.p),Eo-=me.getProperty(m,P.p),Mn(d,P,go),Mn(z,P,go-(ie||0)),Mn(m,P,Eo),Mn($,P,Eo-(ie||0))),De&&!Et&&f.update(),U&&!Et&&!te&&(te=!0,U(f),te=!1)}},f.getVelocity=function(){return(r()-Y)/(wt()-Yo)*1e3||0},f.endAnimation=function(){Go(f.callbackAnimation),o&&(Ie?Ie.progress(1):o.paused()?ae||Go(o,f.direction<0,1):Go(o,o.reversed()))},f.labelToScroll=function(N){return o&&o.labels&&(B||f.refresh()||B)+o.labels[N]/o.duration()*ue||0},f.getTrailing=function(N){var Z=Be.indexOf(f),W=f.direction>0?Be.slice(0,Z).reverse():Be.slice(Z+1);return(Bt(N)?W.filter(function(ie){return ie.vars.preventOverlaps===N}):W).filter(function(ie){return f.direction>0?ie.end<=B:ie.start>=_})},f.update=function(N,Z,W){if(!(I&&!W&&!N)){var ie=Et===!0?qe:f.scroll(),we=N?0:(ie-B)/ue,he=we<0?0:we>1?1:we||0,ve=f.progress,De,Pe,Me,Ee,$e,Je,yt,Ot;if(Z&&(Y=L,L=I?r():ie,C&&(at=Re,Re=o&&!ae?o.totalProgress():he)),x&&g&&!xt&&!yn&&Xt&&(!he&&B<ie+(ie-Y)/(wt()-Yo)*x?he=1e-4:he===1&&_>ie+(ie-Y)/(wt()-Yo)*x&&(he=.9999)),he!==ve&&f.enabled){if(De=f.isActive=!!he&&he<1,Pe=!!ve&&ve<1,Je=De!==Pe,$e=Je||!!he!=!!ve,f.direction=he>ve?1:-1,f.progress=he,$e&&!xt&&(Me=he&&!ve?0:he===1?1:ve===1?2:3,ae&&(Ee=!Je&&D[Me+1]!=="none"&&D[Me+1]||D[Me],Ot=o&&(Ee==="complete"||Ee==="reset"||Ee in o))),K&&(Je||Ot)&&(Ot||A||!o)&&(bt(K)?K(f):f.getTrailing(K).forEach(function(Qe){return Qe.endAnimation()})),ae||(Ie&&!xt&&!yn?(Ie._dp._time-Ie._start!==Ie._time&&Ie.render(Ie._dp._time-Ie._start),Ie.resetTo?Ie.resetTo("totalProgress",he,o._tTime/o._tDur):(Ie.vars.totalProgress=he,Ie.invalidate().restart())):o&&o.totalProgress(he,!!(xt&&(c||N)))),g){if(N&&v&&(ee.style[v+P.os2]=se),!le)ge(jo(be+Ce*he));else if($e){if(yt=!N&&he>ve&&_+1>ie&&ie+1>=Qt(S,P),X)if(!N&&(De||yt)){var lt=to(g,!0),ct=ie-B;Fs(g,je,lt.top+(P===ft?ct:0)+ut,lt.left+(P===ft?0:ct)+ut)}else Fs(g,ee);Bo(De||yt?Xe:G),de&&he<1&&De||ge(be+(he===1&&!yt?Ce:0))}}C&&!b.tween&&!xt&&!yn&&ke.restart(!0),u&&(Je||F&&he&&(he<1||!qn))&&ln(u.targets).forEach(function(Qe){return Qe.classList[De||F?"add":"remove"](u.className)}),a&&!ae&&!N&&a(f),$e&&!xt?(ae&&(Ot&&(Ee==="complete"?o.pause().totalProgress(1):Ee==="reset"?o.restart(!0).pause():Ee==="restart"?o.restart(!0):o[Ee]()),a&&a(f)),(Je||!qn)&&(R&&Je&&$n(f,R),oe[Me]&&$n(f,oe[Me]),F&&(he===1?f.kill(!1,1):oe[Me]=0),Je||(Me=he===1?1:3,oe[Me]&&$n(f,oe[Me]))),j&&!De&&Math.abs(f.getVelocity())>(Vo(j)?j:2500)&&(Go(f.callbackAnimation),Ie?Ie.progress(1):Go(o,Ee==="reverse"?1:!he,1))):ae&&a&&!xt&&a(f)}if(Ae){var nt=I?ie/I.duration()*(I._caScrollDist||0):ie;_e(nt+(d._isFlipped?1:0)),Ae(nt)}vt&&vt(-ie/I.duration()*(I._caScrollDist||0))}},f.enable=function(N,Z){f.enabled||(f.enabled=!0,ht(S,"resize",qo),fe||ht(S,"scroll",Do),ce&&ht(p,"refreshInit",ce),N!==!1&&(f.progress=i=0,L=Y=h=r()),Z!==!1&&f.refresh())},f.getTween=function(N){return N&&b?b.tween:Ie},f.setPositions=function(N,Z,W,ie){if(I){var we=I.scrollTrigger,he=I.duration(),ve=we.end-we.start;N=we.start+ve*N/he,Z=we.start+ve*Z/he}f.refresh(!1,!1,{start:Ds(N,W&&!!f._startClamp),end:Ds(Z,W&&!!f._endClamp)},ie),f.update()},f.adjustPinSpacing=function(N){if(xe&&N){var Z=xe.indexOf(P.d)+1;xe[Z]=parseFloat(xe[Z])+N+ut,xe[1]=parseFloat(xe[1])+N+ut,Bo(xe)}},f.disable=function(N,Z){if(f.enabled&&(N!==!1&&f.revert(!0,!0),f.enabled=f.isActive=!1,Z||Ie&&Ie.pause(),qe=0,E&&(E.uncache=1),ce&&dt(p,"refreshInit",ce),ke&&(ke.pause(),b.tween&&b.tween.kill()&&(b.tween=0)),!fe)){for(var W=Be.length;W--;)if(Be[W].scroller===S&&Be[W]!==f)return;dt(S,"resize",qo),fe||dt(S,"scroll",Do)}},f.kill=function(N,Z){f.disable(N,Z),Ie&&!Z&&Ie.kill(),w&&delete cs[w];var W=Be.indexOf(f);W>=0&&Be.splice(W,1),W===St&&In>0&&St--,W=0,Be.forEach(function(ie){return ie.scroller===f.scroller&&(W=1)}),W||Et||(f.scroll.rec=0),o&&(o.scrollTrigger=null,N&&o.revert({kill:!1}),Z||o.kill()),z&&[z,$,d,m].forEach(function(ie){return ie.parentNode&&ie.parentNode.removeChild(ie)}),rn===f&&(rn=0),g&&(E&&(E.uncache=1),W=0,Be.forEach(function(ie){return ie.pin===g&&W++}),W||(E.spacer=0)),t.onKill&&t.onKill(f)},Be.push(f),f.enable(!1,!1),Ge&&Ge(f),o&&o.add&&!ue){var Se=f.update;f.update=function(){f.update=Se,Fe.cache++,B||_||f.refresh()},me.delayedCall(.01,f.update),ue=.01,B=_=0}else f.refresh();g&&vi()},p.register=function(t){return Io||(me=t||mr(),gr()&&window.document&&p.enable(),Io=Xo),Io},p.defaults=function(t){if(t)for(var o in t)vn[o]=t[o];return vn},p.disable=function(t,o){Xo=0,Be.forEach(function(a){return a[o?"kill":"disable"](t)}),dt(He,"wheel",Do),dt(et,"scroll",Do),clearInterval(mn),dt(et,"touchcancel",Zt),dt(je,"touchstart",Zt),wn(dt,et,"pointerdown,touchstart,mousedown",Is),wn(dt,et,"pointerup,touchend,mouseup",Rs),Bn.kill(),xn(dt);for(var s=0;s<Fe.length;s+=3)bn(dt,Fe[s],Fe[s+1]),bn(dt,Fe[s],Fe[s+2])},p.enable=function(){if(He=window,et=document,Ht=et.documentElement,je=et.body,me&&(ln=me.utils.toArray,en=me.utils.clamp,as=me.core.context||Zt,Vn=me.core.suppressOverwrites||Zt,hs=He.history.scrollRestoration||"auto",us=He.pageYOffset||0,me.core.globals("ScrollTrigger",p),je)){Xo=1,zo=document.createElement("div"),zo.style.height="100vh",zo.style.position="absolute",Pr(),hi(),st.register(me),p.isTouch=st.isTouch,io=st.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),is=st.isTouch===1,ht(He,"wheel",Do),ds=[He,et,Ht,je],me.matchMedia?(p.matchMedia=function(R){var U=me.matchMedia(),A;for(A in R)U.add(A,R[A]);return U},me.addEventListener("matchMediaInit",function(){return bs()}),me.addEventListener("matchMediaRevert",function(){return Tr()}),me.addEventListener("matchMedia",function(){bo(0,1),Co("matchMedia")}),me.matchMedia().add("(orientation: portrait)",function(){return Qn(),Qn})):console.warn("Requires GSAP 3.11.0 or later"),Qn(),ht(et,"scroll",Do);var t=je.hasAttribute("style"),o=je.style,s=o.borderTopStyle,a=me.core.Animation.prototype,u,w;for(a.revert||Object.defineProperty(a,"revert",{value:function(){return this.time(-.01,!0)}}),o.borderTopStyle="solid",u=to(je),ft.m=Math.round(u.top+ft.sc())||0,At.m=Math.round(u.left+At.sc())||0,s?o.borderTopStyle=s:o.removeProperty("border-top-style"),t||(je.setAttribute("style",""),je.removeAttribute("style")),mn=setInterval(zs,250),me.delayedCall(.5,function(){return yn=0}),ht(et,"touchcancel",Zt),ht(je,"touchstart",Zt),wn(ht,et,"pointerdown,touchstart,mousedown",Is),wn(ht,et,"pointerup,touchend,mouseup",Rs),rs=me.utils.checkPrefix("transform"),Rn.push(rs),Io=wt(),Bn=me.delayedCall(.2,bo).pause(),Ro=[et,"visibilitychange",function(){var R=He.innerWidth,U=He.innerHeight;et.hidden?(Es=R,As=U):(Es!==R||As!==U)&&qo()},et,"DOMContentLoaded",bo,He,"load",bo,He,"resize",qo],xn(ht),Be.forEach(function(R){return R.enable(0,1)}),w=0;w<Fe.length;w+=3)bn(dt,Fe[w],Fe[w+1]),bn(dt,Fe[w],Fe[w+2])}},p.config=function(t){"limitCallbacks"in t&&(qn=!!t.limitCallbacks);var o=t.syncInterval;o&&clearInterval(mn)||(mn=o)&&setInterval(zs,o),"ignoreMobileResize"in t&&(is=p.isTouch===1&&t.ignoreMobileResize),"autoRefreshEvents"in t&&(xn(dt)||xn(ht,t.autoRefreshEvents||"none"),pr=(t.autoRefreshEvents+"").indexOf("resize")===-1)},p.scrollerProxy=function(t,o){var s=It(t),a=Fe.indexOf(s),u=Mo(s);~a&&Fe.splice(a,u?6:2),o&&(u?Kt.unshift(He,o,je,o,Ht,o):Kt.unshift(s,o))},p.clearMatchMedia=function(t){Be.forEach(function(o){return o._ctx&&o._ctx.query===t&&o._ctx.kill(!0,!0)})},p.isInViewport=function(t,o,s){var a=(Bt(t)?It(t):t).getBoundingClientRect(),u=a[s?vo:_o]*o||0;return s?a.right-u>0&&a.left+u<He.innerWidth:a.bottom-u>0&&a.top+u<He.innerHeight},p.positionInViewport=function(t,o,s){Bt(t)&&(t=It(t));var a=t.getBoundingClientRect(),u=a[s?vo:_o],w=o==null?u/2:o in Fn?Fn[o]*u:~o.indexOf("%")?parseFloat(o)*u/100:parseFloat(o)||0;return s?(a.left+w)/He.innerWidth:(a.top+w)/He.innerHeight},p.killAll=function(t){if(Be.slice(0).forEach(function(s){return s.vars.id!=="ScrollSmoother"&&s.kill()}),t!==!0){var o=Po.killAll||[];Po={},o.forEach(function(s){return s()})}},p}();Oe.version="3.12.7";Oe.saveStyles=function(p){return p?ln(p).forEach(function(e){if(e&&e.style){var n=zt.indexOf(e);n>=0&&zt.splice(n,5),zt.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),me.core.getCache(e),as())}}):zt};Oe.revert=function(p,e){return bs(!p,e)};Oe.create=function(p,e){return new Oe(p,e)};Oe.refresh=function(p){return p?qo(!0):(Io||Oe.register())&&bo(!0)};Oe.update=function(p){return++Fe.cache&&no(p===!0?2:0)};Oe.clearScrollMemory=Mr;Oe.maxScroll=function(p,e){return Qt(p,e?At:ft)};Oe.getScrollFunc=function(p,e){return po(It(p),e?At:ft)};Oe.getById=function(p){return cs[p]};Oe.getAll=function(){return Be.filter(function(p){return p.vars.id!=="ScrollSmoother"})};Oe.isScrolling=function(){return!!Xt};Oe.snapDirectional=ws;Oe.addEventListener=function(p,e){var n=Po[p]||(Po[p]=[]);~n.indexOf(e)||n.push(e)};Oe.removeEventListener=function(p,e){var n=Po[p],t=n&&n.indexOf(e);t>=0&&n.splice(t,1)};Oe.batch=function(p,e){var n=[],t={},o=e.interval||.016,s=e.batchMax||1e9,a=function(R,U){var A=[],T=[],g=me.delayedCall(o,function(){U(A,T),A=[],T=[]}).pause();return function(v){A.length||g.restart(!0),A.push(v.trigger),T.push(v),s<=A.length&&g.progress(1)}},u;for(u in e)t[u]=u.substr(0,2)==="on"&&bt(e[u])&&u!=="onRefreshInit"?a(u,e[u]):e[u];return bt(s)&&(s=s(),ht(Oe,"refresh",function(){return s=e.batchMax()})),ln(p).forEach(function(w){var R={};for(u in t)R[u]=t[u];R.trigger=w,n.push(Oe.create(R))}),n};var Us=function(e,n,t,o){return n>o?e(o):n<0&&e(0),t>o?(o-n)/(t-n):t<0?n/(n-t):1},Jn=function p(e,n){n===!0?e.style.removeProperty("touch-action"):e.style.touchAction=n===!0?"auto":n?"pan-"+n+(st.isTouch?" pinch-zoom":""):"none",e===Ht&&p(je,n)},Pn={auto:1,scroll:1},Ci=function(e){var n=e.event,t=e.target,o=e.axis,s=(n.changedTouches?n.changedTouches[0]:n).target,a=s._gsap||me.core.getCache(s),u=wt(),w;if(!a._isScrollT||u-a._isScrollT>2e3){for(;s&&s!==je&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!(Pn[(w=Yt(s)).overflowY]||Pn[w.overflowX]));)s=s.parentNode;a._isScroll=s&&s!==t&&!Mo(s)&&(Pn[(w=Yt(s)).overflowY]||Pn[w.overflowX]),a._isScrollT=u}(a._isScroll||o==="x")&&(n.stopPropagation(),n._gsapAllow=!0)},Sr=function(e,n,t,o){return st.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:n,onWheel:o=o&&Ci,onPress:o,onDrag:o,onScroll:o,onEnable:function(){return t&&ht(et,st.eventTypes[0],Ys,!1,!0)},onDisable:function(){return dt(et,st.eventTypes[0],Ys,!0)}})},Si=/(input|label|select|textarea)/i,Ws,Ys=function(e){var n=Si.test(e.target.tagName);(n||Ws)&&(e._gsapAllow=!0,Ws=n)},Ei=function(e){xo(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var n=e,t=n.normalizeScrollX,o=n.momentum,s=n.allowNestedScroll,a=n.onRelease,u,w,R=It(e.target)||Ht,U=me.core.globals().ScrollSmoother,A=U&&U.get(),T=io&&(e.content&&It(e.content)||A&&e.content!==!1&&!A.smooth()&&A.content()),g=po(R,ft),v=po(R,At),M=1,x=(st.isTouch&&He.visualViewport?He.visualViewport.scale*He.visualViewport.width:He.outerWidth)/He.innerWidth,H=0,Q=bt(o)?function(){return o(u)}:function(){return o||2.8},F,C,X=Sr(R,e.type,!0,s),q=function(){return C=!1},I=Zt,j=Zt,K=function(){w=Qt(R,ft),j=en(io?1:0,w),t&&(I=en(0,Qt(R,At))),F=To},P=function(){T._gsap.y=jo(parseFloat(T._gsap.y)+g.offset)+"px",T.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(T._gsap.y)+", 0, 1)",g.offset=g.cacheID=0},ae=function(){if(C){requestAnimationFrame(q);var O=jo(u.deltaY/2),re=j(g.v-O);if(T&&re!==g.v+g.offset){g.offset=re-g.v;var f=jo((parseFloat(T&&T._gsap.y)||0)-g.offset);T.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+f+", 0, 1)",T._gsap.y=f+"px",g.cacheID=Fe.cache,no()}return!0}g.offset&&P(),C=!0},S,V,fe,le,oe=function(){K(),S.isActive()&&S.vars.scrollY>w&&(g()>w?S.progress(1)&&g(w):S.resetTo("scrollY",w))};return T&&me.set(T,{y:"+=0"}),e.ignoreCheck=function(D){return io&&D.type==="touchmove"&&ae()||M>1.05&&D.type!=="touchstart"||u.isGesturing||D.touches&&D.touches.length>1},e.onPress=function(){C=!1;var D=M;M=jo((He.visualViewport&&He.visualViewport.scale||1)/x),S.pause(),D!==M&&Jn(R,M>1.01?!0:t?!1:"x"),V=v(),fe=g(),K(),F=To},e.onRelease=e.onGestureStart=function(D,O){if(g.offset&&P(),!O)le.restart(!0);else{Fe.cache++;var re=Q(),f,ce;t&&(f=v(),ce=f+re*.05*-D.velocityX/.227,re*=Us(v,f,ce,Qt(R,At)),S.vars.scrollX=I(ce)),f=g(),ce=f+re*.05*-D.velocityY/.227,re*=Us(g,f,ce,Qt(R,ft)),S.vars.scrollY=j(ce),S.invalidate().duration(re).play(.01),(io&&S.vars.scrollY>=w||f>=w-1)&&me.to({},{onUpdate:oe,duration:re})}a&&a(D)},e.onWheel=function(){S._ts&&S.pause(),wt()-H>1e3&&(F=0,H=wt())},e.onChange=function(D,O,re,f,ce){if(To!==F&&K(),O&&t&&v(I(f[2]===O?V+(D.startX-D.x):v()+O-f[1])),re){g.offset&&P();var pe=ce[2]===re,Te=pe?fe+D.startY-D.y:g()+re-ce[1],h=j(Te);pe&&Te!==h&&(fe+=h-Te),g(h)}(re||O)&&no()},e.onEnable=function(){Jn(R,t?!1:"x"),Oe.addEventListener("refresh",oe),ht(He,"resize",oe),g.smooth&&(g.target.style.scrollBehavior="auto",g.smooth=v.smooth=!1),X.enable()},e.onDisable=function(){Jn(R,!0),dt(He,"resize",oe),Oe.removeEventListener("refresh",oe),X.kill()},e.lockAxis=e.lockAxis!==!1,u=new st(e),u.iOS=io,io&&!g()&&g(1),io&&me.ticker.add(Zt),le=u._dc,S=me.to(u,{ease:"power4",paused:!0,inherit:!1,scrollX:t?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:Cr(g,g(),function(){return S.pause()})},onUpdate:no,onComplete:le.vars.onComplete}),u};Oe.sort=function(p){if(bt(p))return Be.sort(p);var e=He.pageYOffset||0;return Oe.getAll().forEach(function(n){return n._sortY=n.trigger?e+n.trigger.getBoundingClientRect().top:n.start+He.innerHeight}),Be.sort(p||function(n,t){return(n.vars.refreshPriority||0)*-1e6+(n.vars.containerAnimation?1e6:n._sortY)-((t.vars.containerAnimation?1e6:t._sortY)+(t.vars.refreshPriority||0)*-1e6)})};Oe.observe=function(p){return new st(p)};Oe.normalizeScroll=function(p){if(typeof p>"u")return Pt;if(p===!0&&Pt)return Pt.enable();if(p===!1){Pt&&Pt.kill(),Pt=p;return}var e=p instanceof st?p:Ei(p);return Pt&&Pt.target===e.target&&Pt.kill(),Mo(e.target)&&(Pt=e),e};Oe.core={_getVelocityProp:ss,_inputObserver:Sr,_scrollers:Fe,_proxies:Kt,bridge:{ss:function(){Xt||Co("scrollStart"),Xt=wt()},ref:function(){return xt}}};mr()&&me.registerPlugin(Oe);var an=function(){var p=0,e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(U){U.preventDefault(),t(++p%e.children.length)},!1);function n(U){return e.appendChild(U.dom),U}function t(U){for(var A=0;A<e.children.length;A++)e.children[A].style.display=A===U?"block":"none";p=U}var o=(performance||Date).now(),s=o,a=0,u=n(new an.Panel("FPS","#0ff","#002")),w=n(new an.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var R=n(new an.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:e,addPanel:n,showPanel:t,begin:function(){o=(performance||Date).now()},end:function(){a++;var U=(performance||Date).now();if(w.update(U-o,200),U>=s+1e3&&(u.update(a*1e3/(U-s),100),s=U,a=0,R)){var A=performance.memory;R.update(A.usedJSHeapSize/1048576,A.jsHeapSizeLimit/1048576)}return U},update:function(){o=this.end()},domElement:e,setMode:t}};an.Panel=function(p,e,n){var t=1/0,o=0,s=Math.round,a=s(window.devicePixelRatio||1),u=80*a,w=48*a,R=3*a,U=2*a,A=3*a,T=15*a,g=74*a,v=30*a,M=document.createElement("canvas");M.width=u,M.height=w,M.style.cssText="width:80px;height:48px";var x=M.getContext("2d");return x.font="bold "+9*a+"px Helvetica,Arial,sans-serif",x.textBaseline="top",x.fillStyle=n,x.fillRect(0,0,u,w),x.fillStyle=e,x.fillText(p,R,U),x.fillRect(A,T,g,v),x.fillStyle=n,x.globalAlpha=.9,x.fillRect(A,T,g,v),{dom:M,update:function(H,Q){t=Math.min(t,H),o=Math.max(o,H),x.fillStyle=n,x.globalAlpha=1,x.fillRect(0,0,u,T),x.fillStyle=e,x.fillText(s(H)+" "+p+" ("+s(t)+"-"+s(o)+")",R,U),x.drawImage(M,A+a,T,g-a,v,A,T,g-a,v),x.fillRect(A+g-a,T,a,v),x.fillStyle=n,x.globalAlpha=.9,x.fillRect(A+g-a,T,a,s((1-H/Q)*v))}}};const Er={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class fn{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Ai=new Fr(-1,1,1,-1,0,1);class ki extends uo{constructor(){super(),this.setAttribute("position",new Zo([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Zo([0,2,0,0,2,0],2))}}const Di=new ki;class Ar{constructor(e){this._mesh=new Ne(Di,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Ai)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class Ii extends fn{constructor(e,n){super(),this.textureID=n!==void 0?n:"tDiffuse",e instanceof wo?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=ts.clone(e.uniforms),this.material=new wo({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Ar(this.material)}render(e,n,t){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=t.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class Xs extends fn{constructor(e,n){super(),this.scene=e,this.camera=n,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,n,t){const o=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let a,u;this.inverse?(a=0,u=1):(a=1,u=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),s.buffers.stencil.setFunc(o.ALWAYS,a,4294967295),s.buffers.stencil.setClear(u),s.buffers.stencil.setLocked(!0),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(o.EQUAL,1,4294967295),s.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),s.buffers.stencil.setLocked(!0)}}class Ri extends fn{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Oi{constructor(e,n){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),n===void 0){const t=e.getSize(new Le);this._width=t.width,this._height=t.height,n=new Sn(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:En}),n.texture.name="EffectComposer.rt1"}else this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Ii(Er),this.copyPass.material.blending=Gr,this.clock=new Ur}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,n){this.passes.splice(n,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const n=this.passes.indexOf(e);n!==-1&&this.passes.splice(n,1)}isLastEnabledPass(e){for(let n=e+1;n<this.passes.length;n++)if(this.passes[n].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const n=this.renderer.getRenderTarget();let t=!1;for(let o=0,s=this.passes.length;o<s;o++){const a=this.passes[o];if(a.enabled!==!1){if(a.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(o),a.render(this.renderer,this.writeBuffer,this.readBuffer,e,t),a.needsSwap){if(t){const u=this.renderer.getContext(),w=this.renderer.state.buffers.stencil;w.setFunc(u.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),w.setFunc(u.EQUAL,1,4294967295)}this.swapBuffers()}Xs!==void 0&&(a instanceof Xs?t=!0:a instanceof Ri&&(t=!1))}}this.renderer.setRenderTarget(n)}reset(e){if(e===void 0){const n=this.renderer.getSize(new Le);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,n){this._width=e,this._height=n;const t=this._width*this._pixelRatio,o=this._height*this._pixelRatio;this.renderTarget1.setSize(t,o),this.renderTarget2.setSize(t,o);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(t,o)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Li extends fn{constructor(e,n,t=null,o=null,s=null){super(),this.scene=e,this.camera=n,this.overrideMaterial=t,this.clearColor=o,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Ct}render(e,n,t){const o=e.autoClear;e.autoClear=!1;let s,a;this.overrideMaterial!==null&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:t),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(s),this.overrideMaterial!==null&&(this.scene.overrideMaterial=a),e.autoClear=o}}const zi={uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Ct(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			float v = luminance( texel.xyz );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class So extends fn{constructor(e,n,t,o){super(),this.strength=n!==void 0?n:1,this.radius=t,this.threshold=o,this.resolution=e!==void 0?new Le(e.x,e.y):new Le(256,256),this.clearColor=new Ct(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new Sn(s,a,{type:En}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let A=0;A<this.nMips;A++){const T=new Sn(s,a,{type:En});T.texture.name="UnrealBloomPass.h"+A,T.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(T);const g=new Sn(s,a,{type:En});g.texture.name="UnrealBloomPass.v"+A,g.texture.generateMipmaps=!1,this.renderTargetsVertical.push(g),s=Math.round(s/2),a=Math.round(a/2)}const u=zi;this.highPassUniforms=ts.clone(u.uniforms),this.highPassUniforms.luminosityThreshold.value=o,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new wo({uniforms:this.highPassUniforms,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}),this.separableBlurMaterials=[];const w=[3,5,7,9,11];s=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);for(let A=0;A<this.nMips;A++)this.separableBlurMaterials.push(this.getSeparableBlurMaterial(w[A])),this.separableBlurMaterials[A].uniforms.invSize.value=new Le(1/s,1/a),s=Math.round(s/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=n,this.compositeMaterial.uniforms.bloomRadius.value=.1;const R=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=R,this.bloomTintColors=[new We(1,1,1),new We(1,1,1),new We(1,1,1),new We(1,1,1),new We(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const U=Er;this.copyUniforms=ts.clone(U.uniforms),this.blendMaterial=new wo({uniforms:this.copyUniforms,vertexShader:U.vertexShader,fragmentShader:U.fragmentShader,blending:$t,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Ct,this.oldClearAlpha=1,this.basic=new rt,this.fsQuad=new Ar(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,n){let t=Math.round(e/2),o=Math.round(n/2);this.renderTargetBright.setSize(t,o);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(t,o),this.renderTargetsVertical[s].setSize(t,o),this.separableBlurMaterials[s].uniforms.invSize.value=new Le(1/t,1/o),t=Math.round(t/2),o=Math.round(o/2)}render(e,n,t,o,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const a=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=t.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=t.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let u=this.renderTargetBright;for(let w=0;w<this.nMips;w++)this.fsQuad.material=this.separableBlurMaterials[w],this.separableBlurMaterials[w].uniforms.colorTexture.value=u.texture,this.separableBlurMaterials[w].uniforms.direction.value=So.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[w]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[w].uniforms.colorTexture.value=this.renderTargetsHorizontal[w].texture,this.separableBlurMaterials[w].uniforms.direction.value=So.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[w]),e.clear(),this.fsQuad.render(e),u=this.renderTargetsVertical[w];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=a}getSeparableBlurMaterial(e){const n=[];for(let t=0;t<e;t++)n.push(.39894*Math.exp(-.5*t*t/(e*e))/e);return new wo({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new Le(.5,.5)},direction:{value:new Le(.5,.5)},gaussianCoefficients:{value:n}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {
					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new wo({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}So.BlurDirectionX=new Le(1,0);So.BlurDirectionY=new Le(0,1);class Ln extends Wr{constructor(e,n={}){const t=n.font;if(t===void 0)super();else{const o=t.generateShapes(e,n.size);n.depth===void 0&&(n.depth=50),n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),super(o,n)}this.type="TextGeometry"}}const Bi=Vr;class Gn extends Ks{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,n,t,o){const s=this,a=new Js(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(u){try{n(s.parse(u))}catch(w){o?o(w):console.error(w),s.manager.itemError(e)}},t,o)}parse(e){const n=this;function t(h,c){if(h.nodeType!==1)return;const i=C(h);let r=!1,b=null;switch(h.nodeName){case"svg":c=v(h,c);break;case"style":s(h);break;case"g":c=v(h,c);break;case"path":c=v(h,c),h.hasAttribute("d")&&(b=o(h));break;case"rect":c=v(h,c),b=w(h);break;case"polygon":c=v(h,c),b=R(h);break;case"polyline":c=v(h,c),b=U(h);break;case"circle":c=v(h,c),b=A(h);break;case"ellipse":c=v(h,c),b=T(h);break;case"line":c=v(h,c),b=g(h);break;case"defs":r=!0;break;case"use":c=v(h,c);const L=(h.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),Y=h.viewportElement.getElementById(L);Y?t(Y,c):console.warn("SVGLoader: 'use node' references non-existent node id: "+L);break}b&&(c.fill!==void 0&&c.fill!=="none"&&b.color.setStyle(c.fill,Bi),q(b,ce),S.push(b),b.userData={node:h,style:c});const E=h.childNodes;for(let y=0;y<E.length;y++){const L=E[y];r&&L.nodeName!=="style"&&L.nodeName!=="defs"||t(L,c)}i&&(fe.pop(),fe.length>0?ce.copy(fe[fe.length-1]):ce.identity())}function o(h){const c=new ro,i=new Le,r=new Le,b=new Le;let E=!0,y=!1;const L=h.getAttribute("d");if(L===""||L==="none")return null;const Y=L.match(/[a-df-z][^a-df-z]*/ig);for(let B=0,_=Y.length;B<_;B++){const z=Y[B],$=z.charAt(0),d=z.slice(1).trim();E===!0&&(y=!0,E=!1);let m;switch($){case"M":m=x(d);for(let l=0,te=m.length;l<te;l+=2)i.x=m[l+0],i.y=m[l+1],r.x=i.x,r.y=i.y,l===0?c.moveTo(i.x,i.y):c.lineTo(i.x,i.y),l===0&&b.copy(i);break;case"H":m=x(d);for(let l=0,te=m.length;l<te;l++)i.x=m[l],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),l===0&&y===!0&&b.copy(i);break;case"V":m=x(d);for(let l=0,te=m.length;l<te;l++)i.y=m[l],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),l===0&&y===!0&&b.copy(i);break;case"L":m=x(d);for(let l=0,te=m.length;l<te;l+=2)i.x=m[l+0],i.y=m[l+1],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),l===0&&y===!0&&b.copy(i);break;case"C":m=x(d);for(let l=0,te=m.length;l<te;l+=6)c.bezierCurveTo(m[l+0],m[l+1],m[l+2],m[l+3],m[l+4],m[l+5]),r.x=m[l+2],r.y=m[l+3],i.x=m[l+4],i.y=m[l+5],l===0&&y===!0&&b.copy(i);break;case"S":m=x(d);for(let l=0,te=m.length;l<te;l+=4)c.bezierCurveTo(M(i.x,r.x),M(i.y,r.y),m[l+0],m[l+1],m[l+2],m[l+3]),r.x=m[l+0],r.y=m[l+1],i.x=m[l+2],i.y=m[l+3],l===0&&y===!0&&b.copy(i);break;case"Q":m=x(d);for(let l=0,te=m.length;l<te;l+=4)c.quadraticCurveTo(m[l+0],m[l+1],m[l+2],m[l+3]),r.x=m[l+0],r.y=m[l+1],i.x=m[l+2],i.y=m[l+3],l===0&&y===!0&&b.copy(i);break;case"T":m=x(d);for(let l=0,te=m.length;l<te;l+=2){const ue=M(i.x,r.x),Ue=M(i.y,r.y);c.quadraticCurveTo(ue,Ue,m[l+0],m[l+1]),r.x=ue,r.y=Ue,i.x=m[l+0],i.y=m[l+1],l===0&&y===!0&&b.copy(i)}break;case"A":m=x(d,[3,4],7);for(let l=0,te=m.length;l<te;l+=7){if(m[l+5]==i.x&&m[l+6]==i.y)continue;const ue=i.clone();i.x=m[l+5],i.y=m[l+6],r.x=i.x,r.y=i.y,a(c,m[l],m[l+1],m[l+2],m[l+3],m[l+4],ue,i),l===0&&y===!0&&b.copy(i)}break;case"m":m=x(d);for(let l=0,te=m.length;l<te;l+=2)i.x+=m[l+0],i.y+=m[l+1],r.x=i.x,r.y=i.y,l===0?c.moveTo(i.x,i.y):c.lineTo(i.x,i.y),l===0&&b.copy(i);break;case"h":m=x(d);for(let l=0,te=m.length;l<te;l++)i.x+=m[l],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),l===0&&y===!0&&b.copy(i);break;case"v":m=x(d);for(let l=0,te=m.length;l<te;l++)i.y+=m[l],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),l===0&&y===!0&&b.copy(i);break;case"l":m=x(d);for(let l=0,te=m.length;l<te;l+=2)i.x+=m[l+0],i.y+=m[l+1],r.x=i.x,r.y=i.y,c.lineTo(i.x,i.y),l===0&&y===!0&&b.copy(i);break;case"c":m=x(d);for(let l=0,te=m.length;l<te;l+=6)c.bezierCurveTo(i.x+m[l+0],i.y+m[l+1],i.x+m[l+2],i.y+m[l+3],i.x+m[l+4],i.y+m[l+5]),r.x=i.x+m[l+2],r.y=i.y+m[l+3],i.x+=m[l+4],i.y+=m[l+5],l===0&&y===!0&&b.copy(i);break;case"s":m=x(d);for(let l=0,te=m.length;l<te;l+=4)c.bezierCurveTo(M(i.x,r.x),M(i.y,r.y),i.x+m[l+0],i.y+m[l+1],i.x+m[l+2],i.y+m[l+3]),r.x=i.x+m[l+0],r.y=i.y+m[l+1],i.x+=m[l+2],i.y+=m[l+3],l===0&&y===!0&&b.copy(i);break;case"q":m=x(d);for(let l=0,te=m.length;l<te;l+=4)c.quadraticCurveTo(i.x+m[l+0],i.y+m[l+1],i.x+m[l+2],i.y+m[l+3]),r.x=i.x+m[l+0],r.y=i.y+m[l+1],i.x+=m[l+2],i.y+=m[l+3],l===0&&y===!0&&b.copy(i);break;case"t":m=x(d);for(let l=0,te=m.length;l<te;l+=2){const ue=M(i.x,r.x),Ue=M(i.y,r.y);c.quadraticCurveTo(ue,Ue,i.x+m[l+0],i.y+m[l+1]),r.x=ue,r.y=Ue,i.x=i.x+m[l+0],i.y=i.y+m[l+1],l===0&&y===!0&&b.copy(i)}break;case"a":m=x(d,[3,4],7);for(let l=0,te=m.length;l<te;l+=7){if(m[l+5]==0&&m[l+6]==0)continue;const ue=i.clone();i.x+=m[l+5],i.y+=m[l+6],r.x=i.x,r.y=i.y,a(c,m[l],m[l+1],m[l+2],m[l+3],m[l+4],ue,i),l===0&&y===!0&&b.copy(i)}break;case"Z":case"z":c.currentPath.autoClose=!0,c.currentPath.curves.length>0&&(i.copy(b),c.currentPath.currentPoint.copy(i),E=!0);break;default:console.warn(z)}y=!1}return c}function s(h){if(!(!h.sheet||!h.sheet.cssRules||!h.sheet.cssRules.length))for(let c=0;c<h.sheet.cssRules.length;c++){const i=h.sheet.cssRules[c];if(i.type!==1)continue;const r=i.selectorText.split(/,/gm).filter(Boolean).map(b=>b.trim());for(let b=0;b<r.length;b++){const E=Object.fromEntries(Object.entries(i.style).filter(([,y])=>y!==""));V[r[b]]=Object.assign(V[r[b]]||{},E)}}}function a(h,c,i,r,b,E,y,L){if(c==0||i==0){h.lineTo(L.x,L.y);return}r=r*Math.PI/180,c=Math.abs(c),i=Math.abs(i);const Y=(y.x-L.x)/2,B=(y.y-L.y)/2,_=Math.cos(r)*Y+Math.sin(r)*B,z=-Math.sin(r)*Y+Math.cos(r)*B;let $=c*c,d=i*i;const m=_*_,l=z*z,te=m/$+l/d;if(te>1){const Ce=Math.sqrt(te);c=Ce*c,i=Ce*i,$=c*c,d=i*i}const ue=$*l+d*m,Ue=($*d-ue)/ue;let Xe=Math.sqrt(Math.max(0,Ue));b===E&&(Xe=-Xe);const G=Xe*c*z/i,ee=-Xe*i*_/c,ye=Math.cos(r)*G-Math.sin(r)*ee+(y.x+L.x)/2,ne=Math.sin(r)*G+Math.cos(r)*ee+(y.y+L.y)/2,ge=u(1,0,(_-G)/c,(z-ee)/i),be=u((_-G)/c,(z-ee)/i,(-_-G)/c,(-z-ee)/i)%(Math.PI*2);h.currentPath.absellipse(ye,ne,c,i,ge,ge+be,E===0,r)}function u(h,c,i,r){const b=h*i+c*r,E=Math.sqrt(h*h+c*c)*Math.sqrt(i*i+r*r);let y=Math.acos(Math.max(-1,Math.min(1,b/E)));return h*r-c*i<0&&(y=-y),y}function w(h){const c=F(h.getAttribute("x")||0),i=F(h.getAttribute("y")||0),r=F(h.getAttribute("rx")||h.getAttribute("ry")||0),b=F(h.getAttribute("ry")||h.getAttribute("rx")||0),E=F(h.getAttribute("width")),y=F(h.getAttribute("height")),L=1-.551915024494,Y=new ro;return Y.moveTo(c+r,i),Y.lineTo(c+E-r,i),(r!==0||b!==0)&&Y.bezierCurveTo(c+E-r*L,i,c+E,i+b*L,c+E,i+b),Y.lineTo(c+E,i+y-b),(r!==0||b!==0)&&Y.bezierCurveTo(c+E,i+y-b*L,c+E-r*L,i+y,c+E-r,i+y),Y.lineTo(c+r,i+y),(r!==0||b!==0)&&Y.bezierCurveTo(c+r*L,i+y,c,i+y-b*L,c,i+y-b),Y.lineTo(c,i+b),(r!==0||b!==0)&&Y.bezierCurveTo(c,i+b*L,c+r*L,i,c+r,i),Y}function R(h){function c(E,y,L){const Y=F(y),B=F(L);b===0?r.moveTo(Y,B):r.lineTo(Y,B),b++}const i=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,r=new ro;let b=0;return h.getAttribute("points").replace(i,c),r.currentPath.autoClose=!0,r}function U(h){function c(E,y,L){const Y=F(y),B=F(L);b===0?r.moveTo(Y,B):r.lineTo(Y,B),b++}const i=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,r=new ro;let b=0;return h.getAttribute("points").replace(i,c),r.currentPath.autoClose=!1,r}function A(h){const c=F(h.getAttribute("cx")||0),i=F(h.getAttribute("cy")||0),r=F(h.getAttribute("r")||0),b=new Wn;b.absarc(c,i,r,0,Math.PI*2);const E=new ro;return E.subPaths.push(b),E}function T(h){const c=F(h.getAttribute("cx")||0),i=F(h.getAttribute("cy")||0),r=F(h.getAttribute("rx")||0),b=F(h.getAttribute("ry")||0),E=new Wn;E.absellipse(c,i,r,b,0,Math.PI*2);const y=new ro;return y.subPaths.push(E),y}function g(h){const c=F(h.getAttribute("x1")||0),i=F(h.getAttribute("y1")||0),r=F(h.getAttribute("x2")||0),b=F(h.getAttribute("y2")||0),E=new ro;return E.moveTo(c,i),E.lineTo(r,b),E.currentPath.autoClose=!1,E}function v(h,c){c=Object.assign({},c);let i={};if(h.hasAttribute("class")){const y=h.getAttribute("class").split(/\s/).filter(Boolean).map(L=>L.trim());for(let L=0;L<y.length;L++)i=Object.assign(i,V["."+y[L]])}h.hasAttribute("id")&&(i=Object.assign(i,V["#"+h.getAttribute("id")]));function r(y,L,Y){Y===void 0&&(Y=function(_){return _.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),_}),h.hasAttribute(y)&&(c[L]=Y(h.getAttribute(y))),i[y]&&(c[L]=Y(i[y])),h.style&&h.style[y]!==""&&(c[L]=Y(h.style[y]))}function b(y){return Math.max(0,Math.min(1,F(y)))}function E(y){return Math.max(0,F(y))}return r("fill","fill"),r("fill-opacity","fillOpacity",b),r("fill-rule","fillRule"),r("opacity","opacity",b),r("stroke","stroke"),r("stroke-opacity","strokeOpacity",b),r("stroke-width","strokeWidth",E),r("stroke-linejoin","strokeLineJoin"),r("stroke-linecap","strokeLineCap"),r("stroke-miterlimit","strokeMiterLimit",E),r("visibility","visibility"),c}function M(h,c){return h-(c-h)}function x(h,c,i){if(typeof h!="string")throw new TypeError("Invalid input: "+typeof h);const r={WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},b=0,E=1,y=2,L=3;let Y=b,B=!0,_="",z="";const $=[];function d(ue,Ue,Xe){const G=new SyntaxError('Unexpected character "'+ue+'" at index '+Ue+".");throw G.partial=Xe,G}function m(){_!==""&&(z===""?$.push(Number(_)):$.push(Number(_)*Math.pow(10,Number(z)))),_="",z=""}let l;const te=h.length;for(let ue=0;ue<te;ue++){if(l=h[ue],Array.isArray(c)&&c.includes($.length%i)&&r.FLAGS.test(l)){Y=E,_=l,m();continue}if(Y===b){if(r.WHITESPACE.test(l))continue;if(r.DIGIT.test(l)||r.SIGN.test(l)){Y=E,_=l;continue}if(r.POINT.test(l)){Y=y,_=l;continue}r.COMMA.test(l)&&(B&&d(l,ue,$),B=!0)}if(Y===E){if(r.DIGIT.test(l)){_+=l;continue}if(r.POINT.test(l)){_+=l,Y=y;continue}if(r.EXP.test(l)){Y=L;continue}r.SIGN.test(l)&&_.length===1&&r.SIGN.test(_[0])&&d(l,ue,$)}if(Y===y){if(r.DIGIT.test(l)){_+=l;continue}if(r.EXP.test(l)){Y=L;continue}r.POINT.test(l)&&_[_.length-1]==="."&&d(l,ue,$)}if(Y===L){if(r.DIGIT.test(l)){z+=l;continue}if(r.SIGN.test(l)){if(z===""){z+=l;continue}z.length===1&&r.SIGN.test(z)&&d(l,ue,$)}}r.WHITESPACE.test(l)?(m(),Y=b,B=!1):r.COMMA.test(l)?(m(),Y=b,B=!0):r.SIGN.test(l)?(m(),Y=E,_=l):r.POINT.test(l)?(m(),Y=y,_=l):d(l,ue,$)}return m(),$}const H=["mm","cm","in","pt","pc","px"],Q={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function F(h){let c="px";if(typeof h=="string"||h instanceof String)for(let r=0,b=H.length;r<b;r++){const E=H[r];if(h.endsWith(E)){c=E,h=h.substring(0,h.length-E.length);break}}let i;return c==="px"&&n.defaultUnit!=="px"?i=Q.in[n.defaultUnit]/n.defaultDPI:(i=Q[c][n.defaultUnit],i<0&&(i=Q[c].in*n.defaultDPI)),i*parseFloat(h)}function C(h){if(!(h.hasAttribute("transform")||h.nodeName==="use"&&(h.hasAttribute("x")||h.hasAttribute("y"))))return null;const c=X(h);return fe.length>0&&c.premultiply(fe[fe.length-1]),ce.copy(c),fe.push(c),c}function X(h){const c=new Ao,i=le;if(h.nodeName==="use"&&(h.hasAttribute("x")||h.hasAttribute("y"))){const r=F(h.getAttribute("x")),b=F(h.getAttribute("y"));c.translate(r,b)}if(h.hasAttribute("transform")){const r=h.getAttribute("transform").split(")");for(let b=r.length-1;b>=0;b--){const E=r[b].trim();if(E==="")continue;const y=E.indexOf("("),L=E.length;if(y>0&&y<L){const Y=E.slice(0,y),B=x(E.slice(y+1));switch(i.identity(),Y){case"translate":if(B.length>=1){const _=B[0];let z=0;B.length>=2&&(z=B[1]),i.translate(_,z)}break;case"rotate":if(B.length>=1){let _=0,z=0,$=0;_=B[0]*Math.PI/180,B.length>=3&&(z=B[1],$=B[2]),oe.makeTranslation(-z,-$),D.makeRotation(_),O.multiplyMatrices(D,oe),oe.makeTranslation(z,$),i.multiplyMatrices(oe,O)}break;case"scale":if(B.length>=1){const _=B[0];let z=_;B.length>=2&&(z=B[1]),i.scale(_,z)}break;case"skewX":B.length===1&&i.set(1,Math.tan(B[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":B.length===1&&i.set(1,0,0,Math.tan(B[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":B.length===6&&i.set(B[0],B[2],B[4],B[1],B[3],B[5],0,0,1);break}}c.premultiply(i)}}return c}function q(h,c){function i(y){f.set(y.x,y.y,1).applyMatrix3(c),y.set(f.x,f.y)}function r(y){const L=y.xRadius,Y=y.yRadius,B=Math.cos(y.aRotation),_=Math.sin(y.aRotation),z=new We(L*B,L*_,0),$=new We(-Y*_,Y*B,0),d=z.applyMatrix3(c),m=$.applyMatrix3(c),l=le.set(d.x,m.x,0,d.y,m.y,0,0,0,1),te=oe.copy(l).invert(),Xe=D.copy(te).transpose().multiply(te).elements,G=ae(Xe[0],Xe[1],Xe[4]),ee=Math.sqrt(G.rt1),ye=Math.sqrt(G.rt2);if(y.xRadius=1/ee,y.yRadius=1/ye,y.aRotation=Math.atan2(G.sn,G.cs),!((y.aEndAngle-y.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const ge=oe.set(ee,0,0,0,ye,0,0,0,1),be=D.set(G.cs,G.sn,0,-G.sn,G.cs,0,0,0,1),Ce=ge.multiply(be).multiply(l),se=xe=>{const{x:_e,y:de}=new We(Math.cos(xe),Math.sin(xe),0).applyMatrix3(Ce);return Math.atan2(de,_e)};y.aStartAngle=se(y.aStartAngle),y.aEndAngle=se(y.aEndAngle),I(c)&&(y.aClockwise=!y.aClockwise)}}function b(y){const L=K(c),Y=P(c);y.xRadius*=L,y.yRadius*=Y;const B=L>Number.EPSILON?Math.atan2(c.elements[1],c.elements[0]):Math.atan2(-c.elements[3],c.elements[4]);y.aRotation+=B,I(c)&&(y.aStartAngle*=-1,y.aEndAngle*=-1,y.aClockwise=!y.aClockwise)}const E=h.subPaths;for(let y=0,L=E.length;y<L;y++){const B=E[y].curves;for(let _=0;_<B.length;_++){const z=B[_];z.isLineCurve?(i(z.v1),i(z.v2)):z.isCubicBezierCurve?(i(z.v0),i(z.v1),i(z.v2),i(z.v3)):z.isQuadraticBezierCurve?(i(z.v0),i(z.v1),i(z.v2)):z.isEllipseCurve&&(re.set(z.aX,z.aY),i(re),z.aX=re.x,z.aY=re.y,j(c)?r(z):b(z))}}}function I(h){const c=h.elements;return c[0]*c[4]-c[1]*c[3]<0}function j(h){const c=h.elements,i=c[0]*c[3]+c[1]*c[4];if(i===0)return!1;const r=K(h),b=P(h);return Math.abs(i/(r*b))>Number.EPSILON}function K(h){const c=h.elements;return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function P(h){const c=h.elements;return Math.sqrt(c[3]*c[3]+c[4]*c[4])}function ae(h,c,i){let r,b,E,y,L;const Y=h+i,B=h-i,_=Math.sqrt(B*B+4*c*c);return Y>0?(r=.5*(Y+_),L=1/r,b=h*L*i-c*L*c):Y<0?b=.5*(Y-_):(r=.5*_,b=-.5*_),B>0?E=B+_:E=B-_,Math.abs(E)>2*Math.abs(c)?(L=-2*c/E,y=1/Math.sqrt(1+L*L),E=L*y):Math.abs(c)===0?(E=1,y=0):(L=-.5*E/c,E=1/Math.sqrt(1+L*L),y=L*E),B>0&&(L=E,E=-y,y=L),{rt1:r,rt2:b,cs:E,sn:y}}const S=[],V={},fe=[],le=new Ao,oe=new Ao,D=new Ao,O=new Ao,re=new Le,f=new We,ce=new Ao,pe=new DOMParser().parseFromString(e,"image/svg+xml");return t(pe.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:S,xml:pe.documentElement}}static createShapes(e){const t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},o={loc:t.ORIGIN,t:0};function s(M,x,H,Q){const F=M.x,C=x.x,X=H.x,q=Q.x,I=M.y,j=x.y,K=H.y,P=Q.y,ae=(q-X)*(I-K)-(P-K)*(F-X),S=(C-F)*(I-K)-(j-I)*(F-X),V=(P-K)*(C-F)-(q-X)*(j-I),fe=ae/V,le=S/V;if(V===0&&ae!==0||fe<=0||fe>=1||le<0||le>1)return null;if(ae===0&&V===0){for(let oe=0;oe<2;oe++)if(a(oe===0?H:Q,M,x),o.loc==t.ORIGIN){const D=oe===0?H:Q;return{x:D.x,y:D.y,t:o.t}}else if(o.loc==t.BETWEEN){const D=+(F+o.t*(C-F)).toPrecision(10),O=+(I+o.t*(j-I)).toPrecision(10);return{x:D,y:O,t:o.t}}return null}else{for(let O=0;O<2;O++)if(a(O===0?H:Q,M,x),o.loc==t.ORIGIN){const re=O===0?H:Q;return{x:re.x,y:re.y,t:o.t}}const oe=+(F+fe*(C-F)).toPrecision(10),D=+(I+fe*(j-I)).toPrecision(10);return{x:oe,y:D,t:fe}}}function a(M,x,H){const Q=H.x-x.x,F=H.y-x.y,C=M.x-x.x,X=M.y-x.y,q=Q*X-C*F;if(M.x===x.x&&M.y===x.y){o.loc=t.ORIGIN,o.t=0;return}if(M.x===H.x&&M.y===H.y){o.loc=t.DESTINATION,o.t=1;return}if(q<-Number.EPSILON){o.loc=t.LEFT;return}if(q>Number.EPSILON){o.loc=t.RIGHT;return}if(Q*C<0||F*X<0){o.loc=t.BEHIND;return}if(Math.sqrt(Q*Q+F*F)<Math.sqrt(C*C+X*X)){o.loc=t.BEYOND;return}let I;Q!==0?I=C/Q:I=X/F,o.loc=t.BETWEEN,o.t=I}function u(M,x){const H=[],Q=[];for(let F=1;F<M.length;F++){const C=M[F-1],X=M[F];for(let q=1;q<x.length;q++){const I=x[q-1],j=x[q],K=s(C,X,I,j);K!==null&&H.find(P=>P.t<=K.t+Number.EPSILON&&P.t>=K.t-Number.EPSILON)===void 0&&(H.push(K),Q.push(new Le(K.x,K.y)))}}return Q}function w(M,x,H){const Q=new Le;x.getCenter(Q);const F=[];return H.forEach(C=>{C.boundingBox.containsPoint(Q)&&u(M,C.points).forEach(q=>{F.push({identifier:C.identifier,isCW:C.isCW,point:q})})}),F.sort((C,X)=>C.point.x-X.point.x),F}function R(M,x,H,Q,F){(F==null||F==="")&&(F="nonzero");const C=new Le;M.boundingBox.getCenter(C);const X=[new Le(H,C.y),new Le(Q,C.y)],q=w(X,M.boundingBox,x);q.sort((S,V)=>S.point.x-V.point.x);const I=[],j=[];q.forEach(S=>{S.identifier===M.identifier?I.push(S):j.push(S)});const K=I[0].point.x,P=[];let ae=0;for(;ae<j.length&&j[ae].point.x<K;)P.length>0&&P[P.length-1]===j[ae].identifier?P.pop():P.push(j[ae].identifier),ae++;if(P.push(M.identifier),F==="evenodd"){const S=P.length%2===0,V=P[P.length-2];return{identifier:M.identifier,isHole:S,for:V}}else if(F==="nonzero"){let S=!0,V=null,fe=null;for(let le=0;le<P.length;le++){const oe=P[le];S?(fe=x[oe].isCW,S=!1,V=oe):fe!==x[oe].isCW&&(fe=x[oe].isCW,S=!0)}return{identifier:M.identifier,isHole:S,for:V}}else console.warn('fill-rule: "'+F+'" is currently not implemented.')}let U=999999999,A=-999999999,T=e.subPaths.map(M=>{const x=M.getPoints();let H=-999999999,Q=999999999,F=-999999999,C=999999999;for(let X=0;X<x.length;X++){const q=x[X];q.y>H&&(H=q.y),q.y<Q&&(Q=q.y),q.x>F&&(F=q.x),q.x<C&&(C=q.x)}return A<=F&&(A=F+1),U>=C&&(U=C-1),{curves:M.curves,points:x,isCW:Xr.isClockWise(x),identifier:-1,boundingBox:new Yr(new Le(C,Q),new Le(F,H))}});T=T.filter(M=>M.points.length>1);for(let M=0;M<T.length;M++)T[M].identifier=M;const g=T.map(M=>R(M,T,U,A,e.userData?e.userData.style.fillRule:void 0)),v=[];return T.forEach(M=>{if(!g[M.identifier].isHole){const H=new jr;H.curves=M.curves,g.filter(F=>F.isHole&&F.for===M.identifier).forEach(F=>{const C=T[F.identifier],X=new Wn;X.curves=C.curves,H.holes.push(X)}),v.push(H)}}),v}static getStrokeStyle(e,n,t,o,s){return e=e!==void 0?e:1,n=n!==void 0?n:"#000",t=t!==void 0?t:"miter",o=o!==void 0?o:"butt",s=s!==void 0?s:4,{strokeColor:n,strokeWidth:e,strokeLineJoin:t,strokeLineCap:o,strokeMiterLimit:s}}static pointsToStroke(e,n,t,o){const s=[],a=[],u=[];if(Gn.pointsToStrokeWithBuffers(e,n,t,o,s,a,u)===0)return null;const w=new uo;return w.setAttribute("position",new Zo(s,3)),w.setAttribute("normal",new Zo(a,3)),w.setAttribute("uv",new Zo(u,2)),w}static pointsToStrokeWithBuffers(e,n,t,o,s,a,u,w){const R=new Le,U=new Le,A=new Le,T=new Le,g=new Le,v=new Le,M=new Le,x=new Le,H=new Le,Q=new Le,F=new Le,C=new Le,X=new Le,q=new Le,I=new Le,j=new Le,K=new Le;t=t!==void 0?t:12,o=o!==void 0?o:.001,w=w!==void 0?w:0,e=B(e);const P=e.length;if(P<2)return 0;const ae=e[0].equals(e[P-1]);let S,V=e[0],fe;const le=n.strokeWidth/2,oe=1/(P-1);let D=0,O,re,f,ce,pe=!1,Te=0,h=w*3,c=w*2;i(e[0],e[1],R).multiplyScalar(le),x.copy(e[0]).sub(R),H.copy(e[0]).add(R),Q.copy(x),F.copy(H);for(let _=1;_<P;_++){S=e[_],_===P-1?ae?fe=e[1]:fe=void 0:fe=e[_+1];const z=R;if(i(V,S,z),A.copy(z).multiplyScalar(le),C.copy(S).sub(A),X.copy(S).add(A),O=D+oe,re=!1,fe!==void 0){i(S,fe,U),A.copy(U).multiplyScalar(le),q.copy(S).sub(A),I.copy(S).add(A),f=!0,A.subVectors(fe,V),z.dot(A)<0&&(f=!1),_===1&&(pe=f),A.subVectors(fe,S),A.normalize();const $=Math.abs(z.dot(A));if($>Number.EPSILON){const d=le/$;A.multiplyScalar(-d),T.subVectors(S,V),g.copy(T).setLength(d).add(A),j.copy(g).negate();const m=g.length(),l=T.length();T.divideScalar(l),v.subVectors(fe,S);const te=v.length();switch(v.divideScalar(te),T.dot(j)<l&&v.dot(j)<te&&(re=!0),K.copy(g).add(S),j.add(S),ce=!1,re?f?(I.copy(j),X.copy(j)):(q.copy(j),C.copy(j)):E(),n.strokeLineJoin){case"bevel":y(f,re,O);break;case"round":L(f,re),f?b(S,C,q,O,0):b(S,I,X,O,1);break;case"miter":case"miter-clip":default:const ue=le*n.strokeMiterLimit/m;if(ue<1)if(n.strokeLineJoin!=="miter-clip"){y(f,re,O);break}else L(f,re),f?(v.subVectors(K,C).multiplyScalar(ue).add(C),M.subVectors(K,q).multiplyScalar(ue).add(q),r(C,O,0),r(v,O,0),r(S,O,.5),r(S,O,.5),r(v,O,0),r(M,O,0),r(S,O,.5),r(M,O,0),r(q,O,0)):(v.subVectors(K,X).multiplyScalar(ue).add(X),M.subVectors(K,I).multiplyScalar(ue).add(I),r(X,O,1),r(v,O,1),r(S,O,.5),r(S,O,.5),r(v,O,1),r(M,O,1),r(S,O,.5),r(M,O,1),r(I,O,1));else re?(f?(r(H,D,1),r(x,D,0),r(K,O,0),r(H,D,1),r(K,O,0),r(j,O,1)):(r(H,D,1),r(x,D,0),r(K,O,1),r(x,D,0),r(j,O,0),r(K,O,1)),f?q.copy(K):I.copy(K)):f?(r(C,O,0),r(K,O,0),r(S,O,.5),r(S,O,.5),r(K,O,0),r(q,O,0)):(r(X,O,1),r(K,O,1),r(S,O,.5),r(S,O,.5),r(K,O,1),r(I,O,1)),ce=!0;break}}else E()}else E();!ae&&_===P-1&&Y(e[0],Q,F,f,!0,D),D=O,V=S,x.copy(q),H.copy(I)}if(!ae)Y(S,C,X,f,!1,O);else if(re&&s){let _=K,z=j;pe!==f&&(_=j,z=K),f?(ce||pe)&&(z.toArray(s,0*3),z.toArray(s,3*3),ce&&_.toArray(s,1*3)):(ce||!pe)&&(z.toArray(s,1*3),z.toArray(s,3*3),ce&&_.toArray(s,0*3))}return Te;function i(_,z,$){return $.subVectors(z,_),$.set(-$.y,$.x).normalize()}function r(_,z,$){s&&(s[h]=_.x,s[h+1]=_.y,s[h+2]=0,a&&(a[h]=0,a[h+1]=0,a[h+2]=1),h+=3,u&&(u[c]=z,u[c+1]=$,c+=2)),Te+=3}function b(_,z,$,d,m){R.copy(z).sub(_).normalize(),U.copy($).sub(_).normalize();let l=Math.PI;const te=R.dot(U);Math.abs(te)<1&&(l=Math.abs(Math.acos(te))),l/=t,A.copy(z);for(let ue=0,Ue=t-1;ue<Ue;ue++)T.copy(A).rotateAround(_,l),r(A,d,m),r(T,d,m),r(_,d,.5),A.copy(T);r(T,d,m),r($,d,m),r(_,d,.5)}function E(){r(H,D,1),r(x,D,0),r(C,O,0),r(H,D,1),r(C,O,0),r(X,O,1)}function y(_,z,$){z?_?(r(H,D,1),r(x,D,0),r(C,O,0),r(H,D,1),r(C,O,0),r(j,O,1),r(C,$,0),r(q,$,0),r(j,$,.5)):(r(H,D,1),r(x,D,0),r(X,O,1),r(x,D,0),r(j,O,0),r(X,O,1),r(X,$,1),r(j,$,0),r(I,$,1)):_?(r(C,$,0),r(q,$,0),r(S,$,.5)):(r(X,$,1),r(I,$,0),r(S,$,.5))}function L(_,z){z&&(_?(r(H,D,1),r(x,D,0),r(C,O,0),r(H,D,1),r(C,O,0),r(j,O,1),r(C,D,0),r(S,O,.5),r(j,O,1),r(S,O,.5),r(q,D,0),r(j,O,1)):(r(H,D,1),r(x,D,0),r(X,O,1),r(x,D,0),r(j,O,0),r(X,O,1),r(X,D,1),r(j,O,0),r(S,O,.5),r(S,O,.5),r(j,O,0),r(I,D,1)))}function Y(_,z,$,d,m,l){switch(n.strokeLineCap){case"round":m?b(_,$,z,l,.5):b(_,z,$,l,.5);break;case"square":if(m)R.subVectors(z,_),U.set(R.y,-R.x),A.addVectors(R,U).add(_),T.subVectors(U,R).add(_),d?(A.toArray(s,1*3),T.toArray(s,0*3),T.toArray(s,3*3)):(A.toArray(s,1*3),u[3*2+1]===1?T.toArray(s,3*3):A.toArray(s,3*3),T.toArray(s,0*3));else{R.subVectors($,_),U.set(R.y,-R.x),A.addVectors(R,U).add(_),T.subVectors(U,R).add(_);const te=s.length;d?(A.toArray(s,te-1*3),T.toArray(s,te-2*3),T.toArray(s,te-4*3)):(T.toArray(s,te-2*3),A.toArray(s,te-1*3),T.toArray(s,te-4*3))}break}}function B(_){let z=!1;for(let d=1,m=_.length-1;d<m;d++)if(_[d].distanceTo(_[d+1])<o){z=!0;break}if(!z)return _;const $=[];$.push(_[0]);for(let d=1,m=_.length-1;d<m;d++)_[d].distanceTo(_[d+1])>=o&&$.push(_[d]);return $.push(_[_.length-1]),$}}}function Ni(p,e,n,t){const{CUBE_SIZE:o,FIRST_CUBE_Z:s}=n,a=8,u=24,w=.075,R=200;let U,A=[],T=[],g=[],v=[];const M=(C,X,q,I)=>{const j=new No(C,C,C),K=new $o(j),P=[new Rt({color:16711680,transparent:!0,opacity:I.opacity,blending:$t}),new Rt({color:65280,transparent:!0,opacity:I.opacity,blending:$t}),new Rt({color:255,transparent:!0,opacity:I.opacity,blending:$t}),new Rt({color:65535,transparent:!0,opacity:I.opacity,blending:$t}),new Rt({color:16711935,transparent:!0,opacity:I.opacity,blending:$t}),new Rt({color:16776960,transparent:!0,opacity:I.opacity,blending:$t})],ae=new Nt,S=K.getAttribute("position").array,V=[];for(let oe=0;oe<S.length/3;oe+=2)V.push(oe,oe+1);const fe=Array(6).fill(null).map(()=>new uo),le=Array(6).fill(null).map(()=>[]);for(let oe=0;oe<V.length/2;oe++){const D=oe%6;le[D].push(V[oe*2],V[oe*2+1])}return fe.forEach((oe,D)=>{oe.setIndex(le[D]),oe.setAttribute("position",K.getAttribute("position"));const O=new pt(oe,P[D]);ae.add(O)}),ae.position.z=X,ae.rotation.z=q,ae};if((()=>{const q=.9/(u-1);for(let V=0;V<u;V++)T[V]=new Rt({transparent:!0,opacity:1-V*q});if(U=new Nt,!U){console.error("introGroup failed to initialize");return}for(let V=0;V<u;V++){const fe=o-V*a,le=M(fe,0,0,T[V]),oe=le.children.map(D=>D.material);v.push(oe.map(D=>({material:D,originalColor:D.color.clone()}))),U.add(le)}U.position.z=s,p.add(U),A.push(U),g=T.map(V=>V.opacity);const I=ze.timeline({repeat:-1});I.to(U.rotation,{x:Ve.degToRad(360),duration:12,ease:"none"},0),I.to(U.rotation,{y:Ve.degToRad(360),duration:10,ease:"none"},0),I.to(U.rotation,{z:Ve.degToRad(360),duration:14,ease:"none"},0);let j=-1,K=0;const P=w*1e3,ae=u*P,S=V=>{const fe=V%ae/P,le=Math.floor(fe)%u;j!==-1&&V-K>=P&&(v[j].forEach(O=>{O.material.opacity=g[j],O.material.color.copy(O.originalColor)}),j=-1),j===-1&&le!==j&&(j=le,K=V,v[j].forEach(D=>{D.material.opacity=1,D.material.color.set(1,1,1)})),requestAnimationFrame(S)};requestAnimationFrame(S)})(),e.value){const C=H(e.value);p.add(C)}else console.warn('Font not available; "SCROLL TO CONTINUE" message skipped.');return{introCubes:A};function H(C){const X=new Nt,q=Q(C);q.position.set(0,-36,0),X.add(q),F(j=>{X.add(j),ze.fromTo(q.material,{opacity:.3},{opacity:1,duration:3,ease:"linear",repeat:-1,yoyo:!0});const K=j.children.find(P=>P instanceof Ne&&P!==j.children[0]);if(K){const P=K.position.y;ze.to(K.position,{y:P+3,duration:1,ease:"easeOut",onComplete:()=>{K.position.y=P},repeat:-1})}}),X.position.x=0,X.position.y=-240;const I=s-u*a;return X.position.z=I+R,X}function Q(C){const X=new Ln("SCROLL TO CONTINUE",{font:C,size:8,depth:0,curveSegments:12,bevelEnabled:!1});X.computeBoundingBox(),X.center();const q=new rt({color:16777215,transparent:!0,opacity:1});return new Ne(X,q)}function F(C){new Gn().load("/3D/mouse.svg",q=>{const I=q.paths;let j=null,K=null,P=new Nt;if(I.forEach((ae,S)=>{Gn.createShapes(ae).forEach(fe=>{const le=new qr(fe);le.computeBoundingBox();const oe=new rt({color:16777215,transparent:!0,opacity:1,side:Ut}),D=new Ne(le,oe);D.scale.set(.05,.05,1),S===0?j=D:S===1&&(K=D)})}),j&&K){P.add(j),P.add(K);const S=(j.geometry.boundingBox.max.x-j.geometry.boundingBox.min.x)*j.scale.x/2;P.position.x=-S,P.rotation.x=Math.PI,C(P)}})}}function Hi(p,e,n,t,o,s,a,u){const w=un(),R=er(),{CUBE_SIZE:U,CUBE_SPACING:A,FIRST_CUBE_Z:T}=e,g=T-(n.length+1)*A,v=65535,M=16711935,x=Ve.degToRad(15),H=1e3,Q=.5,F=65280,C=80,X=1,q=15,I=.1,j="ENTER TO LEARN MORE",K=R.isMobile?1:.5,P=40,ae=.125,S=100,V=8,fe=R.isMobile?1.5:2,le=R.isMobile?2:3.5,oe=1;let D=[];D.length=0;let O=!1,re=!1,f=new Zr,ce=new Le,pe=null,Te=null,h=null,c=!1,i=null;const r=new Map,b=new Map,E=new Map,y=(G,ee,ye,ne,ge,be,Ce)=>{const se=new Nt;se.name="group",se.position.z=ye,se.rotation.z=ne,se.userData.isActive=!1,se.userData.cubeIndex=Ce;const xe=new No(ee,ee,ee),_e=new $o(xe),de=new Rt({color:new Ct(v),transparent:!0,opacity:0}),Ae=new pt(_e,de);Ae.geometry.computeBoundingSphere(),se.add(Ae);let Ze="right";const Re=ee/2,at=()=>{const ke=w.isMobile?2:1,qe=25*ke,tt=40*ke,vt=new Ps(tt,75),Ge=new $o(vt),jt=new Rt({color:new Ct(v),transparent:!0,opacity:0,visible:!0}),k=new pt(Ge,jt);k.name="portal",k.userData.isPortal=!0,k.userData.isAnimating=!1,k.geometry.computeBoundingSphere();const J=80*ke,Se=new so(J,J),N=new rt({visible:!1,side:Ut}),Z=new Ne(Se,N);Z.userData.isPortalHitbox=!0,Z.userData.portal=k,Z.geometry.computeBoundingSphere();const W=new Nt,ie=X*ke,we=q*ke,he=new so(ie,we),ve=(qe+tt)/2;for(let Qe=0;Qe<C;Qe++){const Lt=new rt({color:new Ct(M),transparent:!0,opacity:0,visible:!1,side:Ut}),Ke=new Ne(he,Lt),Ye=Qe/C*Math.PI*2;Ke.position.set(Math.cos(Ye)*ve,Math.sin(Ye)*ve,0),Ke.rotation.z=Ye+Math.PI/2,Ke.userData.baseOpacity=.01,Ke.userData.index=Qe,Ke.geometry.computeBoundingSphere(),W.add(Ke)}k.userData.pulsesGroup=W;const De=2*ke,Pe=25;for(let Qe=1;Qe<Pe;Qe++){const Lt=new Ps(tt,75),Ke=new $o(Lt),Ye=Ve.lerp(.125,.1,Qe/(Pe-1)),_t=new Rt({color:new Ct(v),transparent:!0,opacity:0}),kt=new pt(Ke,_t);kt.userData.isPortal=!0,kt.userData.maxOpacity=Ye,kt.position.z=-Qe*De,kt.geometry.computeBoundingSphere(),k.add(kt)}k.userData.maxOpacity=.125;let Me=null;if(u.value){const Qe=3*ke,Lt=new Ln(j,{font:u.value,size:Qe,depth:0,curveSegments:12,bevelEnabled:!1});Lt.computeBoundingBox(),Lt.center();const Ke=new rt({color:16777215,transparent:!0,opacity:0,side:Ut}),Ye=new Ne(Lt,Ke);Ye.visible=!1,Ye.userData.isVisible=!1,Ye.userData.isExploreText=!0,Ye.userData.skipTextMeshes=!0;const _t=-45*ke;Ye.position.set(0,_t,0),Ye.name="textMesh",k.add(Ye),k.userData.exploreText=Ye;const kt=Lt.boundingBox,pn=(kt.max.x-kt.min.x+10)*ke,ho=(kt.max.y-kt.min.y+10)*ke,Gt=new so(pn,ho),go=new rt({transparent:!0,opacity:0,side:Ut,visible:!1});Me=new Ne(Gt,go),Me.position.set(0,_t,0),Me.userData.isExploreTextHitbox=!0,Me.userData.portal=k,Me.geometry.computeBoundingSphere(),Me.name="textHitbox",k.add(Me),k.userData.exploreTextHitbox=Me;const Eo=5,Jt=new Ln(G.title,{font:u.value,size:Eo,depth:0,curveSegments:12,bevelEnabled:!1});Jt.computeBoundingBox(),Jt.center();const kr=new rt({color:16777215,transparent:!0,opacity:0,side:Ut}),mo=new Ne(Jt,kr);mo.visible=!1,mo.userData.isVisible=!1,mo.userData.isTitleText=!0,mo.userData.skipTextMeshes=!0;const Dr=w.isMobile?w.orientation==="portrait"?100:106:60;mo.position.set(0,Dr,0),k.add(mo),k.userData.titleText=mo}else console.warn("Font not loaded yet; 'EXPLORE' text skipped for this portal.");const Ee=new Nt;Ee.name="closeGroup",Ee.position.set(w.isMobile?tt-10:tt,tt,2);const $e=new so(12,R.isMobile?1:.5),Je=new rt({color:16777215,transparent:!0,opacity:0,side:Ut}),yt=new Ne($e,Je);yt.rotation.z=Math.PI/4;const Ot=new Ne($e,Je);Ot.rotation.z=-Math.PI/4,Ee.add(yt,Ot);const lt=new so(15*ke,15*ke),ct=new rt({side:Ut,visible:!1}),nt=new Ne(lt,ct);switch(nt.userData.isCloseHitbox=!0,nt.geometry.computeBoundingSphere(),nt.renderOrder=2,Ee.add(nt),Ze){case"left":k.position.set(-Re,0,0),k.rotation.y=Math.PI/2,Z.position.set(-Re,0,0),Z.rotation.y=Math.PI/2,ne>=Ve.degToRad(120)&&(k.rotation.z=Math.PI),W.children.forEach(Qe=>Qe.position.x+=I);break;case"top":k.position.set(0,-Re,0),k.rotation.x=-Math.PI/2,k.rotation.z=-Math.PI/2,Z.position.set(0,-Re,0),Z.rotation.x=Math.PI/2,ne>=Ve.degToRad(100)&&ne>=Ve.degToRad(180)&&(k.rotation.z=Math.PI/2),W.children.forEach(Qe=>Qe.position.y+=I);break;case"right":k.position.set(Re,0,0),k.rotation.y=-Math.PI/2,Z.position.set(Re,0,0),Z.rotation.y=-Math.PI/2,ne>=Ve.degToRad(120)&&(k.rotation.z=Math.PI),W.children.forEach(Qe=>Qe.position.x+=I);break;case"bottom":k.position.set(0,Re,0),k.rotation.x=Math.PI/2,k.rotation.z=-Math.PI/2,Z.position.set(0,Re,0),Z.rotation.x=Math.PI/2,W.children.forEach(Qe=>Qe.position.y+=I);break}k.add(Ee),k.userData.closeButton=Ee,Ee.updateMatrixWorld(!0),k.add(W),se.add(k),se.add(Z),se.userData.closeButton=Ee,k.updateMatrixWorld(!0),W.updateMatrixWorld(!0),Ee.updateMatrixWorld(!0),r.set(se,[]),b.set(se,0),E.set(se,0)},Ie=ke=>{(ke instanceof pt||ke instanceof Ne)&&ke.geometry&&ke.geometry.computeBoundingSphere(),se.add(ke)};if(ge&&s.showKeyarts){switch(["left","top","right","bottom"].includes(be)?be:"left"){case"left":Ze="right";break;case"top":Ze="bottom";break;case"right":Ze="left";break;case"bottom":Ze="top";break}const qe=a.get(ge);if(qe){const tt=new so(ee-1,ee-1),vt=new rt({map:qe,transparent:!0,opacity:0,blending:$t,side:Ut}),Ge=new Ne(tt,vt);switch(Ge.userData.isLoaded=!0,be){case"left":Ge.position.set(-Re,0,0),ne>=Ve.degToRad(120)?(Ge.rotation.y=Math.PI/2,Ge.rotation.z=-Math.PI):Ge.rotation.y=Math.PI/2;break;case"top":Ge.position.set(0,-Re,0),Ge.rotation.x=-Math.PI/2,Ge.rotation.z=-Math.PI/2;break;case"right":Ge.position.set(Re,0,0),ne>=Ve.degToRad(120)?(Ge.rotation.y=-Math.PI/2,Ge.rotation.z=-Math.PI):Ge.rotation.y=-Math.PI/2;break;case"bottom":Ge.position.set(0,Re,0),ne>=Ve.degToRad(180)?ne>=Ve.degToRad(220)?(Ge.rotation.x=Math.PI/2,Ge.rotation.z=Math.PI/2):(Ge.rotation.x=-Math.PI/2,Ge.rotation.z=Math.PI/2):(Ge.rotation.x=Math.PI/2,Ge.rotation.z=-Math.PI/2);break}Ge.geometry.computeBoundingSphere(),Ie(Ge),at()}else console.warn(`Keyart texture not preloaded for ${G.title}: ${ge}`),at()}else at();se.userData.portalLocation=Ze;{const ke=(J,Se,N,Z)=>{const W=new so(ee-1,ee-1),ie={map:J,transparent:!0,opacity:0,blending:$t,side:Ut,depthWrite:!1};Z&&(ie.color=Z);const we=new rt(ie),he=new Ne(W,we);he.position.copy(Se),N.x&&(he.rotation.x=N.x),N.y&&(he.rotation.y=N.y),he.userData.isGridPlane=!0,he.geometry.computeBoundingSphere(),Ie(he)},qe=a.get(t),tt=a.get(o),vt=["left","top","right","bottom"],jt=[ge&&s.showKeyarts?be||"left":null,Ze].filter(Boolean),k=vt.filter(J=>!jt.includes(J));if(qe)switch(ke(qe,new We(0,0,-ee/2-1),{y:0}),ke(qe,new We(0,0,ee/2+1),{y:0},new Ct(16744448)),k[0]){case"left":ke(qe,new We(-Re,0,0),{y:-Math.PI/2},new Ct(255));break;case"top":ke(qe,new We(0,Re,0),{x:Math.PI/2},new Ct(255));break;case"right":ke(qe,new We(Re,0,0),{y:Math.PI/2},new Ct(255));break;case"bottom":ke(qe,new We(0,-Re,0),{x:-Math.PI/2},new Ct(255));break}else console.warn(`Grid texture not preloaded: ${t}`);if(tt)switch(k[1]){case"left":ke(tt,new We(-Re,0,0),{y:-Math.PI/2});break;case"top":ke(tt,new We(0,Re,0),{x:Math.PI/2});break;case"right":ke(tt,new We(Re,0,0),{y:Math.PI/2});break;case"bottom":ke(tt,new We(0,-Re,0),{x:-Math.PI/2});break}else console.warn(`Grid texture not preloaded: ${o}`)}se.children.forEach(ke=>{ke.updateMatrixWorld(!0),ke instanceof Nt&&ke.children.forEach(qe=>{qe.updateMatrixWorld(!0)})}),se.updateMatrixWorld(!0);const mt=new tr().setFromObject(se),ot=new or;return mt.getBoundingSphere(ot),se.boundingSphere=ot,se},L=new $r,Y=(G,ee,ye,ne,ge)=>{if(!u.value){console.warn("Font not available; skipping text creation for:",G);const mt=new uo,ot=new rt({visible:!1});return new Ne(mt,ot)}const be=new Ln(G,{font:u.value,size:ge,depth:0,curveSegments:12,bevelEnabled:!1});be.computeBoundingBox(),be.center();const Ce=new rt({color:16777215,transparent:!0,opacity:0,side:Ut}),se=new Ne(be,Ce);se.position.set(ee,ye,ne);const xe=be.boundingBox,_e=xe.max.x-xe.min.x,de=xe.max.y-xe.min.y,Ae=_e+8,Ze=de+4,Re=new so(Ae,Ze),at=new rt({color:0,transparent:!0,opacity:0,side:Ut}),Ie=new Ne(Re,at);return Ie.position.set(ee,ye,ne-1),p.add(Ie),p.add(se),se.userData.backgroundPlane=Ie,se},B=()=>{const G=Array.isArray(n)?n:[];Array.isArray(n)||console.warn("useProjectCubes: projects is not an array, defaulting to empty array",n);let ee=0;G.forEach((ye,ne)=>{const ge=T-(ne+1)*A,be=(ne+1)*x,Ce=y(ye,U,ge,be,ye.keyart,ye.keyartLocation,ee);p.add(Ce),D.push(Ce),ee++,Y(ye.title,0,ye.size-15,T+90-(ne+1)*A,ye.size)})},_=()=>O?Promise.resolve({projectCubes:D,updateCubeColors:l,maxZ:g}):(B(),O=!0,Promise.resolve({projectCubes:D,updateCubeColors:l,maxZ:g})),z=G=>{if(G.userData.isAnimating)return;G.userData.isAnimating=!0;const ee=G.userData.pulsesGroup;if(!ee){console.warn("Pulses group not found in portal.userData");return}const ye=ee.children,ne=ye.length,ge=ze.timeline({repeat:-1,defaults:{ease:"none"}}),be={value:0};ge.to(be,{value:1,duration:1.5,onUpdate:()=>{ye.forEach(se=>{const xe=se.material;if(xe.visible){const _e=(se.userData.index/ne+be.value)%1,Ae=(Math.sin(_e*Math.PI*2)+1)/2;xe.opacity=.01+(1-.01)*Math.pow(Ae,4)}})}}),G.userData.animationTimeline=ge},$=G=>{if(!G.userData.isAnimating)return;G.userData.isAnimating=!1;const ee=G.userData.pulsesGroup;if(!ee){console.warn("Pulses group not found in portal.userData");return}G.userData.animationTimeline&&(G.userData.animationTimeline.kill(),delete G.userData.animationTimeline),ee.children.forEach(ye=>{const ne=ye.material;ne.opacity=0})},d=(G,ee)=>{let ye;const ne=(E.get(G)||0)+1;E.set(G,ne),ne%V===0?ye=new Qr(fe,le,12,1):ye=new No(K,K,K);const ge=new rt({color:16777215,transparent:!0,opacity:0}),be=new Ne(ye,ge);be.position.set(0,0,0);const Ce=ee.position.clone(),se=Ce.clone().normalize(),xe=Ce.length()+S;if(ne%V===0){const de=be.position.clone().add(se);be.lookAt(de),be.rotateX(Math.PI/2)}G.add(be),ze.to(ge,{opacity:.5,duration:oe,ease:"power2.in",overwrite:"auto"});const _e=r.get(G)||[];_e.push({mesh:be,direction:se,distanceTraveled:0,totalDistance:xe}),r.set(G,_e)},m=G=>{(r.get(G)||[]).forEach(ye=>{G.remove(ye.mesh),ye.mesh.geometry.dispose(),ye.mesh.material.dispose()}),r.set(G,[])},l=G=>{L.setFromProjectionMatrix(G.projectionMatrix.clone().multiply(G.matrixWorldInverse));const ee=G.position.z;let ye=[];p.traverse(ne=>{var ge;return ne instanceof Ne&&((ge=ne.geometry)==null?void 0:ge.type)==="TextGeometry"&&!ne.userData.skipTextMeshes&&ye.push(ne)}),re||(re=!0),D.forEach((ne,ge)=>{const be=ne.boundingSphere;if(be){const _e=be.clone();if(_e.radius*=1.5,!L.intersectsSphere(_e))return}else console.warn(`Cube ${ge} has no boundingSphere`);const Ce=ne.position.z,se=Math.abs(ee-Ce);let xe=0;se<=H&&(xe=1-se/H),ne.userData.isActive=xe>=Q,ne.children.forEach(_e=>{if(_e instanceof pt&&!_e.userData.isPortal&&!_e.userData.isPortalHitbox){const de=_e.material;if(se<=H){const Ae=Ve.lerp((v>>16&255)/255,(M>>16&255)/255,xe),Ze=Ve.lerp((v>>8&255)/255,(M>>8&255)/255,xe),Re=Ve.lerp((v&255)/255,(M&255)/255,xe);de.color.set(Ae,Ze,Re),de.opacity=Math.min(1,xe*2)}else de.opacity=0}else if(_e instanceof pt&&_e.userData.isPortal){if(_e.children.forEach(de=>{if(de instanceof Ne&&de.userData.isExploreText){const Ae=de.material;if(de===_e.userData.titleText&&c)return;if(se<=H){const Ze=1-se/H;Ae.opacity=Math.min(1,Ze*2),de.visible=!0}else Ae.opacity=0,de.visible=!1}}),re){const de=_e.userData.pulsesGroup;xe>.1?de&&de.children.forEach(Ae=>{Ae instanceof Ne&&(Ae.material.visible=!0,!_e.userData.animationStarted&&s.showPortalPulses&&(z(_e),_e.userData.animationStarted=!0))}):xe<=.1&&_e.userData.animationStarted&&(de&&de.children.forEach(Ae=>{Ae instanceof Ne&&(Ae.material.visible=!1)}),$(_e),delete _e.userData.animationStarted)}}else if(_e instanceof Ne&&!_e.userData.isPortalHitbox&&!_e.userData.isCloseHitbox){const de=_e.material;if(_e.userData.isLoaded||_e.userData.isGridPlane)if(se<=H){const Ae=1-se/H;de.opacity=Math.min(.8,Ae*2),_e.visible=!0}else de.opacity=0,_e.visible=!1}})}),ye.forEach(ne=>{if(!L.intersectsObject(ne))return;const ge=ne.material,be=ne.userData.backgroundPlane,Ce=be==null?void 0:be.material,se=ne.position.z,xe=Math.abs(ee-se+120);if(c){ge.opacity=0,Ce&&(Ce.opacity=0);return}if(xe<=H){const _e=1-xe/H,de=Math.min(1,_e*2);ge.opacity=de,Ce&&(Ce.opacity=de*.8)}else ge.opacity=0,Ce&&(Ce.opacity=0)})},te=(G,ee)=>{const ye=performance.now()/1e3,ne=G.position.z;D.forEach(ge=>{const be=ge.position.z;if(Math.abs(ne-be+90)<=H&&!c){const se=b.get(ge)||0;if(ye-se>=ae){const de=ge.children.find(Ae=>Ae instanceof pt&&Ae.userData.isPortal);de&&(d(ge,de),b.set(ge,ye))}const _e=(r.get(ge)||[]).filter(de=>{if(de.distanceTraveled+=P*ee,de.mesh.position.copy(de.direction.clone().multiplyScalar(de.distanceTraveled)),(de.totalDistance-de.distanceTraveled)/P<=oe&&!de.isFadingOut){de.isFadingOut=!0;const Re=de.mesh.material;ze.to(Re,{opacity:0,duration:oe,ease:"power2.out",overwrite:"auto"})}return de.distanceTraveled>=de.totalDistance?(ge.remove(de.mesh),de.mesh.geometry.dispose(),de.mesh.material.dispose(),!1):!0});r.set(ge,_e)}else m(ge)})},ue=G=>{const ee=[G,...G.children.filter(ge=>ge instanceof pt&&ge.userData.isPortal)],ye=2,ne=.1;ee.forEach((ge,be)=>{const Ce=ge.material;Ce.opacity=ge.userData.maxOpacity;const se=ze.timeline({repeat:-1,delay:be*ne});se.to(Ce,{opacity:0,duration:ye/2,ease:"power2.inOut"}).to(Ce,{opacity:ge.userData.maxOpacity,duration:ye/2,ease:"power2.inOut"}),ge.userData.marqueeTimeline=se})},Ue=G=>{const ee=[G,...G.children.filter(ye=>ye instanceof pt&&ye.userData.isPortal)];ee.forEach(ye=>{ye.userData.marqueeTimeline&&(ye.userData.marqueeTimeline.kill(),delete ye.userData.marqueeTimeline)}),G.userData.ringExpandTimeline&&(G.userData.ringExpandTimeline.kill(),delete G.userData.ringExpandTimeline),ee.forEach((ye,ne)=>{const ge=ye.material;ze.killTweensOf(ye.position),ze.killTweensOf(ge),ye.position.z=-ne*2,ge.opacity=0})};return{getInitializedData:_,updateCubeColors:l,setupInteractivity:(G,ee,ye,ne,ge)=>{i=ne;let be=null,Ce=null,se=null,xe=!1,_e=!1,de=!1,Ae=!1,Ze=[],Re=!1;p.traverse(k=>{var J;k instanceof Ne&&((J=k.geometry)==null?void 0:J.type)==="TextGeometry"&&!k.userData.skipTextMeshes&&Ze.push(k)});const at=k=>{c&&(be=k.touches[0].clientY,Ce=Ce??window.scrollY,xe=!0)},Ie=k=>{if(!c||!se||!be||Ae)return;const Se=k.touches[0].clientY-be;w.isMobile&&Se<-50&&!_e&&(k.cancelable&&k.preventDefault(),ke(),be=null)},mt=k=>{be=null,xe=!1,de=!0,ze.delayedCall(.5,()=>{de=!1})},ot=k=>{if(xe||_e||de||Ae){k.preventDefault(),k.stopPropagation(),Ce!==null&&(window.scrollTo(0,Ce),ze.to(window,{scrollTo:{y:Ce},duration:0}));return}if(!c||!se||!Te||!h)return;if(w.isMobile){k.preventDefault(),k.stopPropagation();return}let J=0;if(k instanceof WheelEvent?J=k.deltaY:J=window.scrollY-(Ce||0),k.preventDefault(),k.stopPropagation(),J>0){window.scrollTo(0,Ce);return}J<0&&ke()},ke=()=>{const k=se,J=h?h.clone():new We(0,0,g),Se=(Te==null?void 0:Te.z)??G.position.z,N=k==null?void 0:k.parent,Z=k?D.indexOf(N):-1;if(Ae=!0,k){Ue(k);const we=k.userData.titleText;if(we){const he=we.material;ze.to(he,{opacity:0,duration:.5,ease:"power2.out",onComplete:()=>{we.visible=!1}})}if(k.userData.closeButton){const he=k.userData.closeButton,ve=he.children.filter(De=>De instanceof Ne&&!De.userData.isCloseHitbox).map(De=>De.material);ve.length>0&&ze.to(ve,{opacity:0,duration:.5,ease:"power2.out",onComplete:()=>{he.visible=!1}})}}ze.to(G.position,{x:(Te==null?void 0:Te.x)??G.position.x,y:(Te==null?void 0:Te.y)??G.position.y,z:Se,duration:2,ease:"power3.inOut",overwrite:"auto",onStart:()=>{const we=Ze[Z];if(Z!==-1&&we){const he=we.material,ve=we.userData.backgroundPlane,De=Math.abs(G.position.z-we.position.z+120),Pe=De<=H?Math.min(1,(1-De/H)*2):0;ze.to(he,{opacity:Pe,duration:.5,ease:"power2.in"}),ve&&ze.to(ve.material,{opacity:Pe*.8,duration:.5,ease:"power2.in"})}},onUpdate:()=>{const we=ie.progress,he=Ve.lerp(W.x,J.x,we),ve=Ve.lerp(W.y,J.y,we),De=Ve.lerp(W.z,J.z,we);G.lookAt(he,ve,De),G.updateMatrixWorld(!0)},onComplete:()=>{G.lookAt(J),c=!1,se=null,document.body.classList.remove("no-scrollbar"),w.isMobile&&(document.body.style.overflow=""),i&&i(!1),Ce=null,Te=null,h=null,G.userData.lockedLookAt=null,Ae=!1,D.forEach(we=>{Math.abs(G.position.z-we.position.z+90)<=H&&b.set(we,0)})}});const W=G.userData.lockedLookAt?G.userData.lockedLookAt.clone():G.getWorldDirection(new We).multiplyScalar(1e3).add(G.position),ie={progress:0};ze.to(ie,{progress:1,duration:2,ease:"power3.inOut",overwrite:"auto"})},qe=(k,J=!0)=>{const Se=[k,...k.children.filter(W=>W instanceof pt&&W.userData.isPortal)],N=J?25:2,Z=ze.timeline({onComplete:()=>{J&&Se[0]===k&&ue(k)}});Se.forEach((W,ie)=>{let we=-ie*N;(k.position.y>0&&k.rotation.x===-Math.PI/2||k.position.y<0&&k.rotation.x===Math.PI/2)&&(we=ie*N);const he=J?W.userData.maxOpacity:0;Z.to(W.position,{z:we,duration:1,ease:"power3.out",delay:.5},0),Z.to(W.material,{opacity:he,duration:1,ease:"power3.out",delay:.5},0)}),k.userData.ringExpandTimeline=Z},tt=k=>{ce.x=k.clientX/window.innerWidth*2-1,ce.y=-(k.clientY/window.innerHeight)*2+1,f.setFromCamera(ce,G),G.userData.lockedLookAt&&(G.lookAt(G.userData.lockedLookAt),G.updateMatrixWorld(!0)),D.forEach(N=>{N.userData.lockedPosition&&(N.position.equals(N.userData.lockedPosition)||N.position.copy(N.userData.lockedPosition)),N.updateMatrixWorld(!0),N.children.forEach(Z=>Z.updateMatrixWorld(!0))});const J=D.flatMap(N=>{const Z=[];return!c&&N.userData.isActive&&N.children.forEach(W=>{W instanceof Ne&&(W.userData.isPortalHitbox||W.userData.isExploreTextHitbox)&&Z.push(W)}),c&&se&&N===se.parent&&N.children.forEach(W=>{if(W instanceof Ne&&W.userData.isPortalHitbox&&Z.push(W),W instanceof pt&&W.userData.isPortal){const ie=W;ie.children.forEach(we=>{we instanceof Ne&&we.userData.isExploreTextHitbox&&Z.push(we),we instanceof Nt&&we===ie.userData.closeButton&&we.children.forEach(he=>{he instanceof Ne&&he.userData.isCloseHitbox&&Z.push(he)})})}}),Z}),Se=f.intersectObjects(J);if(Se.length>0){const N=Se[0].object;if(N.userData.isPortalHitbox||N.userData.isExploreTextHitbox){const Z=N.userData.portal;pe!==Z&&(pe&&[pe,...pe.children.filter(we=>we instanceof pt&&we.userData.isPortal)].forEach(we=>{const he=we.material;ze.to(he.color,{r:(v>>16&255)/255,g:(v>>8&255)/255,b:(v&255)/255,duration:.5})}),pe=Z,[pe,...pe.children.filter(ie=>ie instanceof pt&&ie.userData.isPortal)].forEach(ie=>{const we=ie.material;ze.to(we.color,{r:(F>>16&255)/255,g:(F>>8&255)/255,b:(F&255)/255,duration:.5})})),ee.style.cursor="pointer"}else if(N.userData.isCloseHitbox&&c){if(!Re){Re=!0;const Z=N.parent;ze.to(Z.rotation,{z:Math.PI/2,duration:.3,ease:"power2.inOut"})}ee.style.cursor="pointer"}}else{if(pe&&([pe,...pe.children.filter(Z=>Z instanceof pt&&Z.userData.isPortal)].forEach(Z=>{const W=Z.material;ze.to(W.color,{r:(v>>16&255)/255,g:(v>>8&255)/255,b:(v&255)/255,duration:.5})}),pe=null),c&&se&&Re){const N=se.userData.closeButton;N&&(Re=!1,ze.to(N.rotation,{z:0,duration:.3,ease:"power2.inOut"}))}ee.style.cursor="auto"}},vt=k=>{if(Ae)return;ce.x=k.clientX/window.innerWidth*2-1,ce.y=-(k.clientY/window.innerHeight)*2+1,f.setFromCamera(ce,G);const J=D.flatMap(ve=>{const De=[];return c&&se&&ve===se.parent&&ve.children.forEach(Pe=>{if(Pe instanceof pt&&Pe.userData.isPortal){const Me=Pe;Me.children.forEach(Ee=>{Ee instanceof Nt&&Ee===Me.userData.closeButton&&Ee.children.forEach($e=>{$e instanceof Ne&&$e.userData.isCloseHitbox&&De.push($e)})})}}),De}),Se=D.flatMap(ve=>{const De=[];return!c&&ve.userData.isActive&&ve.children.forEach(Pe=>{Pe instanceof Ne&&(Pe.userData.isPortalHitbox||Pe.userData.isExploreTextHitbox)&&De.push(Pe)}),c&&se&&ve===se.parent&&ve.children.forEach(Pe=>{Pe instanceof Ne&&Pe.userData.isPortalHitbox&&De.push(Pe),Pe instanceof pt&&Pe.userData.isPortal&&Pe.children.forEach(Me=>{Me instanceof Ne&&Me.userData.isExploreTextHitbox&&De.push(Me)})}),De});let N=f.intersectObjects(J);for(const ve of N)if(ve.object.userData.isCloseHitbox){ke();return}if(N=f.intersectObjects(Se),N.length===0)return;const W=N[0].object.userData.portal,ie=W.parent,we=D.indexOf(ie),he=n[we];if(c&&W===se){let ve=new We;const De=e.CUBE_SIZE/2;W.position.x===De?ve.set(-1,0,0):W.position.x===-De?ve.set(1,0,0):W.position.y===De?ve.set(0,-1,0):W.position.y===-De&&ve.set(0,1,0),ve.applyQuaternion(ie.getWorldQuaternion(new Kr)).normalize();const Me=G.position.clone().clone().add(ve.clone().multiplyScalar(-675)),Ee=ve.clone().multiplyScalar(-1e3),$e=Me.clone().add(Ee);Ae=!0,ze.to(G.position,{x:Me.x,y:Me.y,z:Me.z,duration:1,ease:"power2.in",onUpdate:()=>G.lookAt($e),onStart:()=>{ze.to(ye.domElement,{opacity:0,duration:1,ease:"power2.in",overwrite:"auto"})},onComplete:()=>{he!=null&&he.slug&&(R.setScrollPosition(window.scrollY),Ir.visit(route("project.show",{project:he.slug}),{preserveScroll:!1})),Ae=!1}})}else if(!c){Te||(Te=G.position.clone(),h=new We(0,0,g)),i&&ne(!0,Te,h);const ve=W.getWorldPosition(new We);_e=!0,Ae=!0,Ce=window.scrollY,ze.to(G.position,{x:0,y:0,z:ie.getWorldPosition(new We).z,duration:2,ease:"power3.out",overwrite:"all",onStart:()=>{c=!0,se=W,document.body.classList.add("no-scrollbar"),w.isMobile&&(document.body.style.overflow="hidden"),ie.userData.lockedPosition=ie.position.clone(),m(ie);const De=Ze[we];if(De){const Me=De.material,Ee=De.userData.backgroundPlane;ze.to(Me,{opacity:0,duration:.5,ease:"power2.out"}),Ee&&ze.to(Ee.material,{opacity:0,duration:.5,ease:"power2.out"})}const Pe=W.userData.titleText;if(Pe){Pe.visible=!0;const Me=Pe.material;ze.to(Me,{opacity:1,duration:1,ease:"power2.in",delay:.5})}if(W.userData.closeButton){const Me=W.userData.closeButton;Me.visible=!0;const Ee=Me.children.filter($e=>$e instanceof Ne&&!$e.userData.isCloseHitbox).map($e=>$e.material);Ee.length>0&&ze.to(Ee,{opacity:1,duration:.5,ease:"power2.in",delay:.5})}},onComplete:()=>{qe(W,!0),_e=!1,Ae=!1,G.userData.lockedLookAt=ve.clone()}}),ze.to({},{duration:2,ease:"power2.out",overwrite:"all",onUpdate:function(){const De=this.progress(),Pe=G.getWorldDirection(new We).multiplyScalar(1e3).add(G.position),Me=Ve.lerp(Pe.x,ve.x,De),Ee=Ve.lerp(Pe.y,ve.y,De),$e=Ve.lerp(Pe.z,ve.z,De);G.lookAt(Me,Ee,$e)},onComplete:()=>{G.lookAt(ve.x,ve.y,ve.z),G.updateMatrixWorld(!0)}})}};ee.addEventListener("mousemove",tt),ee.addEventListener("click",vt),ee.addEventListener("touchstart",at,{passive:!1}),ee.addEventListener("touchmove",Ie,{passive:!1}),ee.addEventListener("touchend",mt,{passive:!0}),window.addEventListener("wheel",ot,{passive:!1}),window.addEventListener("scroll",ot,{passive:!1});const Ge=()=>{r.forEach((k,J)=>{k.forEach(Se=>{J.remove(Se.mesh),Se.mesh.geometry.dispose(),Se.mesh.material.dispose()})}),r.clear(),b.clear(),E.clear()},jt=()=>{ee.removeEventListener("mousemove",tt),ee.removeEventListener("click",vt),ee.removeEventListener("touchstart",at),ee.removeEventListener("touchmove",Ie),ee.removeEventListener("touchend",mt),window.removeEventListener("wheel",ot),window.removeEventListener("scroll",ot),se&&Ue(se),w.isMobile&&(document.body.style.overflow="")};return()=>{jt(),Ge()}},updateClickHereParticles:te}}function Fi(p,e,n,t){const o=un(),s=100,a=100,u=300,w=3355443,R=o.isMobile?24:32,U=-600,A=-500,T=1e3,g=o.isMobile?5:10,v=.05,M=1,x=o.isMobile?6:4,H=o.isMobile?4:6,Q=100,F=-450,C=60,X=n-T,q=Math.abs(A-X),I=Math.ceil(q/s),j=()=>{const f=new Nt;let ce=null,pe=null;const Te=[],h=[],c=[],i=[],r=[];{const b=new No(s,s,s),E=new $o(b),y=R*I,L=new Jr;L.copy(E),L.instanceCount=y;const Y=new Rt({color:w,transparent:!0,fog:!0,vertexColors:!0}),B=new Float32Array(y*3),_=new Float32Array(y*3),z=new Float32Array(y*3),$=R*s,d=-$/2+s/2,m=A;for(let xe=0;xe<R;xe++){const _e=K(xe);for(let de=0;de<I;de++){const Ae=xe*I+de,Ze=d+xe*s,Re=m-de*s,at=Ve.randFloat(a,u),Ie=at/s,mt=U+at/2;B[Ae*3]=Ze,B[Ae*3+1]=mt,B[Ae*3+2]=Re,_[Ae*3]=1,_[Ae*3+1]=Ie,_[Ae*3+2]=1,z[Ae*3]=_e,z[Ae*3+1]=_e,z[Ae*3+2]=_e}}L.setAttribute("instancePosition",new Yn(B,3)),L.setAttribute("instanceScale",new Yn(_,3)),L.setAttribute("color",new Yn(z,3)),Y.onBeforeCompile=xe=>{xe.vertexShader=`
                    attribute vec3 instancePosition;
                    attribute vec3 instanceScale;
                    ${xe.vertexShader}
                `.replace("#include <begin_vertex>",`#include <begin_vertex>
                    transformed *= instanceScale;
                    transformed += instancePosition;`)},ce=new pt(L,Y);const l=-$/2,te=$/2,ue=U,Ue=U+u,Xe=X,G=A;L.boundingBox=new tr(new We(l,ue,Xe),new We(te,Ue,G));const ee=(l+te)/2,ye=(ue+Ue)/2,ne=(Xe+G)/2,ge=te-l,be=Ue-ue,Ce=G-Xe,se=Math.sqrt(ge*ge+be*be+Ce*Ce)/2;L.boundingSphere=new or(new We(ee,ye,ne),se),f.add(ce)}{pe=new Nt;const b=R*s/(H-1),E=-(R*s)/2;for(let L=0;L<H;L++){let B=E+L*b,_=A;const z=[new We(B,F,_)];let $=0;for(;_>X;){const d=_===A?Ve.randFloat(300,800):Math.min(Ve.randFloat(300,800),Math.abs(_-X));if(_-=d,z.push(new We(B,F,_)),$+=d,_<=X){z[z.length-1].z=X;break}const m=Math.random()<.5?-1:1,l=Ve.randFloat(100,300);B+=m*l,z.push(new We(B,F,_)),$+=l}h.push({points:z,totalLength:$})}const y=new No(x,x,x);for(let L=0;L<H;L++){const Y=h[L],B=Y.totalLength,_=B/C;for(let z=0;z<C;z++){const $=new rt({color:16711680,fog:!0}),d=new Ne(y,$),m=z*_;let l=m;for(let te=0;te<Y.points.length-1;te++){const ue=Y.points[te],Ue=Y.points[te+1],Xe=ue.distanceTo(Ue);if(l<=Xe){const G=l/Xe;d.position.lerpVectors(ue,Ue,G);break}l-=Xe}Te.push(d),c.push(m),i.push(L),r.push(1),pe.add(d)}for(let z=0;z<C;z++){const $=new rt({color:16777215,fog:!0}),d=new Ne(y,$),m=B-(z*_+_/2);let l=B-m;const te=[...Y.points].reverse();for(let ue=0;ue<te.length-1;ue++){const Ue=te[ue],Xe=te[ue+1],G=Ue.distanceTo(Xe);if(l<=G){const ee=l/G;d.position.lerpVectors(Ue,Xe,ee);break}l-=G}Te.push(d),c.push(m),i.push(L),r.push(-1),pe.add(d)}}e.add(pe)}return e.add(f),{cityGroup:f,instancedLines:ce,particleGroup:pe,particles:Te,paths:h,particleDistances:c,particlePaths:i,particleDirections:r}},K=f=>{if(f<g){const ce=(M-v)/(g-1);return v+f*ce}else if(f>=R-g){const ce=R-1-f,pe=(M-v)/(g-1);return v+ce*pe}return M},{cityGroup:P,instancedLines:ae,particleGroup:S,particles:V,paths:fe,particleDistances:le,particlePaths:oe,particleDirections:D}=j();return{cityGroup:P,buildingLines:ae?[ae]:[],updateParticles:f=>{const ce=Q*f;for(let pe=0;pe<V.length;pe++){const Te=D[pe],h=oe[pe],c=fe[h],i=c.totalLength;le[pe]+=ce*Te,Te===1?(le[pe]=le[pe]%i,le[pe]<0&&(le[pe]+=i)):le[pe]=(le[pe]+i)%i;const r=le[pe],b=Te===1?c.points:[...c.points].reverse();let E=Te===1?r:i-r;for(let y=0;y<b.length-1;y++){const L=b[y],Y=b[y+1],B=L.distanceTo(Y);if(E<=B){const _=E/B;V[pe].position.lerpVectors(L,Y,_);break}E-=B}}},dispose:()=>{ae&&(P.remove(ae),ae.geometry.dispose(),ae.material.dispose()),S&&(e.remove(S),S.children.forEach(f=>{f.geometry.dispose(),f.material.dispose()})),e.remove(P)}}}ze.registerPlugin(Oe);function Gi(p,e,n,t,o,s,a={},u,w){const R=un(),{CUBE_SPACING:U,FIRST_CUBE_Z:A}=s,T=(t==null?void 0:t.length)||0,g=A-(T+1)*U;let v=!1,M=!1;const x=R.isMobile?(Math.abs(g)+(T-1)*U)*.7:Math.abs(g)+(T-1)*U;let H=ze.timeline();Oe.config({ignoreMobileResize:!0});{let C=0;const X=16;H=ze.timeline({scrollTrigger:{trigger:n.value,start:"top top",end:`+=${x}`,scrub:a.scrub,pin:!0,onUpdate:q=>{const I=performance.now();if(I-C>=X){if(!v){const j=q.progress,K=Ve.lerp(0,g,j);e.position.set(0,0,K),e.lookAt(0,0,g)}o(e),C=I}w&&w.update()},onRefresh:()=>{e.updateProjectionMatrix()}}}),H.fromTo(e.position,{z:0},{z:g,duration:1,ease:"none"},0)}return{setReverting:C=>{v=C},timeline:H,isScrollTriggerActive:()=>M}}function Ui(p,e,n){const t=un(),o=t.isMobile?25:20,s=t.isMobile?1e3:2e3,a=4e3,u=-1e3,w=n-1e3,R=1e3,U=n,A=150,T=-500,g=n,v=new uo,M=new Float32Array(s*3),x=new Float32Array(s),H=new Float32Array(s);let Q=0;for(;Q<s;){const I=(Math.random()-.5)*a,j=(Math.random()-.5)*a,K=u+Math.random()*(w-u),P=K>U&&Math.abs(I)<R&&Math.abs(j)<R,ae=Math.abs(I)<A&&Math.abs(j)<A&&K>g&&K<T;if(!P&&!ae){const S=Q*3;M[S]=I,M[S+1]=j,M[S+2]=K;const V=.1+Math.random()*(.7-.1);x[Q]=V,H[Q]=V,Q++}}v.setAttribute("position",new Cs(M,3)),v.setAttribute("opacity",new Cs(H,1));const F=new wo({uniforms:{color:{value:new Ct(1,1,1)},size:{value:o}},vertexShader:`
            attribute float opacity;
            varying float vOpacity;
            uniform float size;
            void main() {
                vOpacity = opacity;
                vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
                gl_PointSize = size * (300.0 / -mvPosition.z); // Size attenuation
                gl_Position = projectionMatrix * mvPosition;
            }
        `,fragmentShader:`
            uniform vec3 color;
            varying float vOpacity;
            void main() {
                float dist = distance(gl_PointCoord, vec2(0.5, 0.5)) * 2.0;
                float alpha = vOpacity * (1.0 - dist);
                if (alpha <= 0.0) discard;
                gl_FragColor = vec4(color, alpha);
            }
        `,transparent:!0,fog:!1,depthWrite:!1}),C=new ei(v,F);p.add(C);const X=v.attributes.opacity;for(let I=0;I<s;I++)ze.to({opacity:x[I]},{opacity:.05,duration:1+Math.random(),yoyo:!0,repeat:-1,ease:"sine.inOut",delay:Math.random()*2,onUpdate:function(){H[I]=this.targets()[0].opacity,X.needsUpdate=!0}});return{dispose:()=>{ze.killTweensOf(H),p.remove(C),v.dispose(),F.dispose()}}}function Wi(p,e){const t=e-1500,o=100,s=2,a=64,u=1e3,w=a*3,R=[4,4.5,5],U=6;let A,T,g,v,M,x;const H=[],Q=[[],[],[]],F=[[],[],[]],C=[[],[],[]];let X=[0,0,0];const q=()=>{const P=0-t,ae=[];for(let re=0;re<o;re++){const f=re/(o-1),ce=0-f*P,pe=f*5*2*Math.PI,Te=90*(.8+.2*Math.sin(pe*2)),h=new We(Te*Math.cos(pe),Te*Math.sin(pe),ce);(isNaN(h.x)||isNaN(h.y)||isNaN(h.z))&&console.error("NaN in chaserPath points",{t:f,z:ce,projectMaxZ:e}),ae.push(h)}A=new Xn(ae);const S=new uo().setFromPoints(A.getPoints(200));v=new jn(S,new Rt({color:16711935,linewidth:2,visible:!1})),p.add(v);const V=[];for(let re=0;re<o;re++){const f=re/(o-1),ce=0-f*P,pe=f*3*2*Math.PI,Te=60*(.8+.2*Math.sin(pe*4)),h=new We(Te*Math.cos(pe),Te*Math.sin(pe),ce);(isNaN(h.x)||isNaN(h.y)||isNaN(h.z))&&console.error("NaN in chaserPath2 points",{t:f,z:ce,projectMaxZ:e}),V.push(h)}T=new Xn(V);const fe=new uo().setFromPoints(T.getPoints(200));M=new jn(fe,new Rt({color:65535,linewidth:2,visible:!1})),p.add(M);const le=[];for(let re=0;re<o;re++){const f=re/(o-1),ce=0-f*P,pe=f*7*2*Math.PI,Te=100,h=90,c=.1*Math.sin(pe),i=new We(Te*(1+c)*Math.cos(pe),h*(1-c)*Math.sin(pe),ce);(isNaN(i.x)||isNaN(i.y)||isNaN(i.z))&&console.error("NaN in chaserPath3 points",{t:f,z:ce,projectMaxZ:e}),le.push(i)}g=new Xn(le);const oe=new uo().setFromPoints(g.getPoints(200));x=new jn(oe,new Rt({color:16776960,linewidth:2,visible:!1})),p.add(x);const D=[16711680,65280,255],O=new No(s,s,s);O.attributes.color&&delete O.attributes.color;for(let re=0;re<3;re++){const f=new Nt;f.opacity=1,f.renderOrder=1,H[re]=f,p.add(f);for(let ce=0;ce<w;ce++){const pe=new rt({color:D[re],transparent:!0,opacity:0,blending:ti,fog:!0,depthWrite:!1}),Te=new Ne(O,pe);Te.renderOrder=1,Te.visible=!1,f.add(Te),Q[re][ce]=Te,F[re][ce]=0,C[re][ce]=!1}}},I=P=>{const ae=[A,T,g][P],S=ae.getLength(),V=C[P].filter(le=>le).length;if(w-V>=a){let le=0;for(let oe=0;oe<a;oe++){const D=C[P].findIndex(h=>!h);if(D===-1){console.warn(`No available chasers for path ${P}, emitted ${le}/${a}`);break}const O=le/(a-1),re=.05+(1-.05)*Math.pow(O,3),f=new rt({color:[16711680,65280,255][P],transparent:!0,opacity:re,blending:$t,fog:!0,depthWrite:!1});Q[P][D].material=f,Q[P][D].visible=!0;const ce=le*U;F[P][D]=ce,C[P][D]=!0;const pe=ce/S,Te=ae.getPointAt(pe);Q[P][D].position.copy(Te),le++}}},j=P=>{const ae=performance.now()/1e3,S=[A,T,g];for(let V=0;V<3;V++){ae-X[V]>=R[V]&&(I(V),X[V]=ae);const fe=S[V],le=fe.getLength(),oe=u*P;for(let D=0;D<w;D++)if(C[V][D]){F[V][D]+=oe;const O=F[V][D]/le;if(O>=1)Q[V][D].visible=!1,C[V][D]=!1,F[V][D]=0;else{const re=fe.getPointAt(O);Q[V][D].position.copy(re)}}}};return q(),{chaserPath:A,chaserPath2:T,chaserPath3:g,updateChasers:j,dispose:()=>{p.remove(v),p.remove(M),p.remove(x),v.geometry.dispose(),v.material.dispose(),M.geometry.dispose(),M.material.dispose(),x.geometry.dispose(),x.material.dispose(),H.forEach(P=>{P.children.forEach(ae=>{ae.geometry.dispose(),ae.material.dispose()}),p.remove(P)})}}}class Yi extends Ks{constructor(e){super(e)}load(e,n,t,o){const s=this,a=new Js(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(u){const w=s.parse(JSON.parse(u));n&&n(w)},t,o)}parse(e){return new Xi(e)}}class Xi{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,n=100){const t=[],o=ji(e,n,this.data);for(let s=0,a=o.length;s<a;s++)t.push(...o[s].toShapes());return t}}function ji(p,e,n){const t=Array.from(p),o=e/n.resolution,s=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*o,a=[];let u=0,w=0;for(let R=0;R<t.length;R++){const U=t[R];if(U===`
`)u=0,w-=s;else{const A=Vi(U,o,u,w,n);u+=A.offsetX,a.push(A.path)}}return a}function Vi(p,e,n,t,o){const s=o.glyphs[p]||o.glyphs["?"];if(!s){console.error('THREE.Font: character "'+p+'" does not exists in font family '+o.familyName+".");return}const a=new ro;let u,w,R,U,A,T,g,v;if(s.o){const M=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let x=0,H=M.length;x<H;)switch(M[x++]){case"m":u=M[x++]*e+n,w=M[x++]*e+t,a.moveTo(u,w);break;case"l":u=M[x++]*e+n,w=M[x++]*e+t,a.lineTo(u,w);break;case"q":R=M[x++]*e+n,U=M[x++]*e+t,A=M[x++]*e+n,T=M[x++]*e+t,a.quadraticCurveTo(A,T,R,U);break;case"b":R=M[x++]*e+n,U=M[x++]*e+t,A=M[x++]*e+n,T=M[x++]*e+t,g=M[x++]*e+n,v=M[x++]*e+t,a.bezierCurveTo(A,T,g,v,R,U);break}}return{offsetX:s.ha*e,path:a}}function qi(p="/fonts/Poppins_Regular.json"){const e=eo(null),n=eo(0),t=eo(!1),o=()=>new Promise((a,u)=>{new Yi().load(p,R=>{e.value=R,n.value=100,t.value=!0,a(R)},R=>{R.lengthComputable&&(n.value=R.loaded/R.total*100)},R=>{n.value=100,t.value=!0,u(R)})});return{font:e,loadingProgress:n,isLoaded:t,initialize:()=>o()}}const Zi={class:"preloader"},$i={class:"progress-label"},Qi=ps({__name:"Preloader",props:{progress:{}},setup(p){return(e,n)=>(qt(),ao("div",Zi,[Dt("div",$i,Zs(Math.round(e.progress))+"%",1)]))}}),Ki=nr(Qi,[["__scopeId","data-v-e5eadefa"]]),js=250,Cn=500,Uo=-500,es=-520,Vs=-720,qs=4e3,Ji=ps({__name:"HallwayEngine",props:{projects:{},projectGridFile:{},projectGridFile2:{},initialSlug:{}},setup(p){ze.registerPlugin(Oe);const e=p,n=er();n.projects=e.projects;const t=un(),o={showChasers:!0,showStarfield:!0,showCars:!0,showBuildings:!0,showPortalPulses:!0,showKeyarts:!0,showProjectGrids:!0,showProjectTitles:!0,showIntroCubes:!0,showScrollTrigger:!0,showStats:!0},s=eo(null),a=eo(null),u=eo(!1),w=eo(0),R=eo(!1),U=eo(!0),A=new Map;let T,g,v,M,x,H,Q,F=null,C=null,X=null,q=null,I=null,j=[],K=null,P=null,ae=0,S=null,V,fe=null,le=null,oe=null;const D=qi("/fonts/Poppins_Regular.json"),O=()=>{const h=s.value?s.value.getBoundingClientRect().width:window.innerWidth,c=window.innerHeight,i=t.isMobile?.75:1,r=t.isMobile?Math.min(window.devicePixelRatio,1.5):window.devicePixelRatio;v.setSize(h*i,c*i),v.setPixelRatio(r),M.setSize(h*i,c*i),g.aspect=h/c,g.updateProjectionMatrix(),v.domElement.style.width=`${h}px`,v.domElement.style.height=`${c}px`},re=h=>A.has(h)?Promise.resolve(A.get(h)):new Promise((c,i)=>{new ai().load(h,b=>{b.encoding=void 0,A.set(h,b),c(b)},void 0,b=>i(b))}),f=async()=>{T=new oi,T.background=new Ct(0),T.fog=new ni(0,700,qs),g=new si(t.isMobile?t.orientation==="landscape"?90:120:75,window.innerWidth/window.innerHeight,1,qs+6e3),g.position.set(0,0,0),g.lookAt(0,0,1e3),v=new ri({antialias:!0}),t.isMobile?v.setPixelRatio(Math.min(window.devicePixelRatio,1.5)):v.setPixelRatio(window.devicePixelRatio),v.toneMapping=ii,v.toneMappingExposure=1,v.outputEncoding=void 0,M=new Oi(v);const h=new Li(T,g);if(M.addPass(h),t.isMobile?x=new So(new Le(window.innerWidth,window.innerHeight),1,.1,0):x=new So(new Le(window.innerWidth,window.innerHeight),1.6,.2,0),x.renderToScreen=!0,M.addPass(x),s.value)s.value.appendChild(v.domElement),v.domElement.style.opacity="0";else return;H=new an,H.dom.style.position="fixed",H.dom.style.top="0px",H.dom.style.left="0px",H.dom.style.zIndex="1000",document.body.appendChild(H.dom);const i=e.projects.filter(E=>E.keyart).length+2+1;let r=0;const b=()=>{r++;const E=r/i*100,y=D.loadingProgress.value;w.value=(E+y/i)/(1+1/i),r===i&&D.isLoaded.value&&(u.value=!0)};await D.initialize().then(()=>{b()}).catch(E=>{console.error("Font initialization failed:",E),b()}),await re(e.projectGridFile).then(()=>b()).catch(()=>b()),await re(e.projectGridFile2).then(()=>b()).catch(()=>b());for(const E of e.projects)E.keyart?await re(E.keyart).then(()=>b()).catch(()=>b()):b();S=Hi(T,{CUBE_SIZE:js,CUBE_SPACING:Cn,FIRST_CUBE_Z:Uo},e.projects,e.projectGridFile,e.projectGridFile2,o,A,D.font);try{if(await S.getInitializedData().then(({maxZ:E,updateCubeColors:y,projectCubes:L})=>{if(V=E,V===void 0||isNaN(V))throw new Error("Invalid maxZ from projectCubesInstance");const{introCubes:Y}=Ni(T,D.font,{CUBE_SIZE:js,FIRST_CUBE_Z:Uo},o);j=[...Y,...L],K=y}),o.showCars){const{cityGroup:E,updateParticles:y,dispose:L}=Fi(T,T,V,o);Q=y,I=L}if(o.showStarfield){const{dispose:E}=Ui(T,g,V);F=E}if(o.showChasers){const{dispose:E,updateChasers:y}=Wi(T,V);X=E,q=y}O()}catch(E){console.error("Error initializing project cubes:",E),V=Uo-(e.projects.length+1)*Cn}},ce=(h=0)=>{if(P=requestAnimationFrame(ce),v&&M){const c=(h-ae)/1e3;ae=h,Q(c),q&&q(c),S!=null&&S.updateClickHereParticles&&S.updateClickHereParticles(g,c);const i=4e3,r=1e3,b=Math.abs(g.position.z-V);g.far=Math.max(i+r,b),g.updateProjectionMatrix();const E=Vs-es;let y=0;g.position.z>=es?y=0:g.position.z<=Vs?y=1:y=(g.position.z-es)/E,t.isMobile?x.strength=Ve.lerp(1.3,0,y):x.strength=Ve.lerp(1.6,.125,y),M.render()}H.update()},pe=()=>{console.log("handleResize()"),O(),Oe.refresh()},Te=()=>{if(t.isMobile){const h=t.orientation;console.log("Resize: orientation",h,"lastOrientation",le),h!==le&&(le=h,oe&&clearTimeout(oe),oe=setTimeout(()=>{pe(),oe=null},500))}else pe()};return Rr(()=>{f().then(()=>{if(u.value){P=requestAnimationFrame(ce);let h=null;const c=S.getInitializedData().then(({projectCubes:r})=>{r.forEach(E=>{E.userData.isActive=!0});const b=Uo-(e.projects.length-1)*Cn;if(g.position.set(0,0,5e3),g.lookAt(0,0,b),g.updateProjectionMatrix(),K(g),M.render(),Oe.getAll().forEach(E=>E.kill()),j.length&&K){const E=Gi(T,g,a,j,K,{CUBE_SPACING:Cn,FIRST_CUBE_Z:Uo},{scrub:t.isMobile?.5:1},o,H);h=E.setReverting,fe=E.isScrollTriggerActive}v&&C===null&&(C=S.setupInteractivity(g,v.domElement,v,E=>{h&&h(E)},fe)),window.scrollTo({top:0,behavior:"auto"})}),i=()=>{c.then(()=>{U.value=!1,g.position.set(0,0,5e3),g.updateProjectionMatrix(),ze.to(v.domElement,{opacity:1,duration:.5,ease:"power4.out"});const r={z:5e3};ze.to(r,{z:0,duration:2,ease:"power4.out",onUpdate:()=>{g.position.z=r.z,g.updateProjectionMatrix()},onComplete:()=>{g.position.z=0,R.value=!0}})})};ze.delayedCall(.5,i)}}).catch(h=>{console.error("Initialization failed:",h)}),window.addEventListener("resize",Te)}),Or(()=>{P!==null&&cancelAnimationFrame(P),C&&C(),window.removeEventListener("resize",Te),Oe.getAll().forEach(h=>h.kill()),v.dispose(),M.dispose(),T.clear(),document.body.removeChild(H.dom),F&&F(),X&&X(),I&&I()}),(h,c)=>(qt(),ao("section",{ref_key:"wrapper",ref:a,class:"wrapper"},[Wo(zr,{name:"fade"},{default:$s(()=>[U.value?(qt(),Qs(Ki,{key:0,progress:w.value},null,8,["progress"])):Lr("",!0)]),_:1}),Dt("div",{ref_key:"tunnelWrapper",ref:s,class:"tunnel-wrapper"},null,512)],512))}}),ea=nr(Ji,[["__scopeId","data-v-27fd232e"]]),ta={class:"relative bg-gray-50 text-black/50 dark:bg-black dark:text-white/50"},oa={class:"absolute z-10 flex flex-col items-center justify-center top-32 left-1/2 transform -translate-x-1/2"},na={class:"overflow-hidden"},sa={class:"mt-16 px-4 md:px-16"},ra={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},ia=["innerHTML"],aa={class:"flex justify-center items-center gap-8 text-xs text-white/60 uppercase mt-12"},pa=ps({__name:"Welcome",props:{projects:{},projectGridFile:{},projectGridFile2:{},archived:{}},setup(p){const e=p,n=vs(()=>[...e.archived].sort((s,a)=>s.title.localeCompare(a.title))),t=vs(()=>Object.values(dn.Enums.Classification)),o=s=>{switch(s){case dn.Enums.Classification.ENTERTAINMENT:return"fill-red-400";case dn.Enums.Classification.ECOMMERCE:return"fill-green-500";case dn.Enums.Classification.OTHER:return"fill-white";default:return"fill-white-500"}};return(s,a)=>(qt(),Qs(ui,null,{default:$s(()=>[Wo(Br(Nr),{title:"Welcome"}),Dt("div",ta,[Dt("nav",oa,[Wo(li)]),Dt("div",na,[Wo(ea,{projects:s.projects,"project-grid-file":s.projectGridFile,"project-grid-file2":s.projectGridFile2},null,8,["projects","project-grid-file","project-grid-file2"])]),Dt("div",sa,[a[2]||(a[2]=Dt("h2",{class:"mb-4 text-white"},"OTHER WEB PROJECTS",-1)),Dt("ul",ra,[(qt(!0),ao(_s,null,Ts(n.value,(u,w)=>(qt(),ao("li",{class:"text-xs text-white/60 flex items-center gap-2",key:w},[(qt(),ao("svg",{class:Ms(["size-1.5 md:size-[.375vw] 3xl:size-[.375rem]",o(u.classification)]),viewBox:"0 0 6 6","aria-hidden":"true"},a[0]||(a[0]=[Dt("circle",{cx:"3",cy:"3",r:"3"},null,-1)]),2)),Dt("span",{innerHTML:u.title},null,8,ia)]))),128))]),Dt("ul",aa,[(qt(!0),ao(_s,null,Ts(t.value,u=>(qt(),ao("li",{class:"flex items-center gap-2",key:u},[(qt(),ao("svg",{class:Ms(["size-3",o(u)]),viewBox:"0 0 6 6","aria-hidden":"true"},a[1]||(a[1]=[Dt("circle",{cx:"3",cy:"3",r:"3"},null,-1)]),2)),Hr(" "+Zs(u),1)]))),128))])]),a[3]||(a[3]=Dt("div",{class:"flex justify-center items-center"},null,-1)),a[4]||(a[4]=Dt("div",{class:"flex justify-center items-center"},null,-1)),Wo(ci)])]),_:1}))}});export{pa as default};
